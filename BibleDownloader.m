function h_fig=BibleDownloader
%Opens a GUI that allows the download of several Bible translations.
%(See below for disclaimer/legal statement)
%
% By default this only supports translations that are public domain. Some
% translations that are not public domain (or CC-by-nc-nd) can be
% downloaded as well. See the disclaimer section for a description how
% enable those.
%
% Currently supported languages for this GUI:
% - English
% - Dutch
% (You can e-mail me translations if you would like me to add them)
%
% Available Bible translations:
%	English:
% ASV:     American Standard Version
% KJV:     King James Version
% NASB:    New American Standard Bible
% WEB:     World English Bible
%	French:
% LS1910:  Luis Segond (1910)
%	Spanish:
% RV1602:  Reina Valera (1602)
%	Dutch:
% BB:      de Basisbijbel
% BGT:     de Bijbel in Gewone Taal
% GNB:     Groot Nieuws Bijbel
% HB:      Het Boek
% HSV:     de Herziene Statenvertaling
% NB:      de Naardense Bijbel
% NBG51:   de Nieuwe Vertaling (1951)
% NBV:     de Nieuwe Bijbelvertaling
% NWv2004: de Nieuwe-Wereldvertaling (2004)
% NWv2017: de Nieuwe Wereldvertaling (2017)
% SV1637:  de Statenvertaling (1637, original version)
% SV1750:  de Statenvertaling (1750)
% SV73:    de Statenvertaling (1973, revision by the GBS)
% SV77:    de Statenvertaling (1977, revisie by the NBG)
% WV75:    de Willibrordvertaling
%
% ---- Disclaimer: ----
% Under Dutch law, downloading a copy of a copyright protected work is
% allowed if you are a natural person (i.e. a human, and not acting for
% a corporation) and the copy is for personal (home) use only, under the
% condition that you already own an otherwise legally acquired copy. Adding
% the file mentioned below to the main folder means you have read this
% disclaimer, agree to it, and assume full legal responsibility for the use
% of this script and the files it generates.
% WARNING: The law of your jurisdiction might be different. It may prohibit
% the use of this script or set different requirements.
%
% You mus agree to these requirements by creating a file with this name (in
% the same folder as this function):
% 'I hereby declare I will only use this script if and only if it is legal
% for me to do so.txt'
%
% ------------------------ .bible FILE DEFINITION ------------------------
% The .bible file is a UTF-8 plain text files containing a header and body
%    separated by ~~~~. The end-of-line character(s) can be any of the
%    following: CRLF, LFCR, LF or CR.
% The header starts with an opening curly bracket on one line, then
%    ["field": "content",] (without the square brackets) on the following
%    lines (one field per line). After the meta-data fields, the header
%    ends with a closing curly bracket on one line. The ~~~~ separator is
%    required to be on a single line, otherwise new lines are not required.
%       Required fields: "long name","short name","sheet name"
%       Preferred additional fields: "license","comment","language"
%       long name  - The full name of the translation.
%       short name - The abreviated name.
%       sheet name - The abreviated name without spaces or special
%                    characters, compatible for use as sheet name in Excel.
%       license    - The copyright information, detailing the copyright
%                    holder in as much detail as necesarry, stating the
%                    CreativeCommons information, or noting the translation
%                    is public domain.
%       comment    - General comment field, can be used to store a link
%                    that provides a citation for the license information.
%       language   - Contains the ISO 639-1 Code, followed by a space, a
%                    dash, a space and the native name of the language. If
%                    the language name contains non-latin characters
%                    (char>255), the English name should be used. For
%                    reference the Wikipedia page List_of_ISO_639-1_codes
%                    can be used:
%                    https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes
% The body contains one verse on each line.
% The verse number is enclosed in curly brackets and is in
%    BookChapterVerse.0 format (Book is 2 digits, Chapter is and Verse are
%    both 3 digits, all numbers are padded with zeros). To properly align
%    verses across Bible translations, sometimes  the decimal is
%    incremented, or the verse number is set to 0. The allignment (assuming
%    a collation to a table without skipping cells) does not mean that all
%    verses on each row will have the same **verse number**, but that each
%    row will have the same **textual content**.
% The verse content is enclosed in curly brackets as well. Instead of the
%    verse content, this can also be a special token. Valid tokens are
%    %prev%, %next% and %empty%.
%    %prev% means the verse should be merged with the previous verse,
%    %next% means with the next verse, and
%    %empty% means this translation doesn't have a text for this verse,
%    while other translations do.
% ------------------------------------------------------------------------
%
% Compatibility:
% Matlab: should work on all releases (tested on R2018a, R2012b and R6.5)
% Octave: tested on 4.2.1
% OS:     written on Windows 10 (64bit), Octave tested on a virtual (32bit)
%         Ubuntu 16.04 LTS, should work for Mac
%
% Version: 1.2.1
% Date:    2018-05-01
% Author:  H.J. Wisselink
% Email=  'h_j_wisselink*alumnus_utwente_nl';
% Real_email = regexprep(Email,{'*','_'},{'@','.'})

% Update notes v1.1:
% -added GNB
% -fixed issue with Mal 4
% -resolved a few small bugs
% Update notes v1.1.1:
% -resolved code typos

% Update notes v1.2:
% -added NASB
% -restructured submission and added additional/alpha functions
% -fixed bug with WBM syntax
% -removed footnote contents from bible.com versions
% Update notes v1.2.1:
% -edited metadata and descriptions
% -fixed small bugs in reading html files

isOctave = exist('OCTAVE_VERSION', 'builtin') ~= 0;
v=version;v=str2double(v(1:3));
%Enable checks with the version without having to think about Octave:
if isOctave,v=v+100;end
if v<7
    clc
    %for some reason this warning keeps popping up in ML6.5
    warning off MATLAB:m_warning_end_without_block
end
if exist('debug_on.txt','file')
    dict=get_dictionary(1);%will select English
else
    dict=get_dictionary;%will show a pop-up asking the language
end

if isOctave && ~ismac && isunix %Octave on Linux
    %It seems like all non-ASCII chars result in question mark boxes. There
    %shouldn't be any reason why this is the case, but on Octave 4.0.0 and
    %Octave 4.2.1, writing >128 chars failed.
    %(tested on a 32 bit Ubuntu 16.04 (LTS) in VirtualBox)
    msgbox(dict.ASCII_only.msg,dict.ASCII_only.title,'warn');
    %Otherwise, there is no difference in output whatsoever between Matlab
    %R2017b, Matlab R2012b or Octave 4.2.1 on Windows and Octave 4.0.0 or
    %Octave 4.2.1 on Ubuntu.
end

%Get the path to the working directory
%Find out the function stack
try
    ST = dbstack('-completenames');
catch
    ST=dbstack;%ML6.5
    ST(1).file=ST(1).name;
end
%Find the file separators ('\' on Windows, '/' on Unix)
filesep_positions=strfind(ST(1).file,filesep);
%Copy the path up to the last filesep to select the folder
place=ST(1).file(1:(filesep_positions(end)-1));

public_domain=true;joel3_bible=true;mal4_bible=true;
%(some bibles have entered public domain)
%(some bibles have 3 chapters for Joel, others 4)
%(some bibles have 4 chapters for Malachi, others 3)
stringlist={...
    'ASV'    , public_domain, joel3_bible, mal4_bible;...
    'BB'     ,~public_domain, joel3_bible, mal4_bible;...
    'BGT'    ,~public_domain,~joel3_bible,~mal4_bible;...
    'GNB'    ,~public_domain, joel3_bible, mal4_bible;...
    'HB'     ,~public_domain, joel3_bible, mal4_bible;...
    'HSV'    ,~public_domain, joel3_bible, mal4_bible;...
    'KJV'    , public_domain, joel3_bible, mal4_bible;...
    'LS1910' , public_domain, joel3_bible, mal4_bible;...
    'NASB'   ,~public_domain, joel3_bible, mal4_bible;...
    'NB2014' ,~public_domain,~joel3_bible,~mal4_bible;...
    'NBG51'  ,~public_domain, joel3_bible, mal4_bible;...
    'NBV2017',~public_domain,~joel3_bible,~mal4_bible;...
    'NWv2004',~public_domain, joel3_bible, mal4_bible;...
    'NWv2017',~public_domain, joel3_bible, mal4_bible;...
    'RV1602' , public_domain, joel3_bible, mal4_bible;...
    'SV73'   ,~public_domain, joel3_bible, mal4_bible;...
    'SV77'   ,~public_domain, joel3_bible,~mal4_bible;...
    'SV1637' , public_domain, joel3_bible,~mal4_bible;...
    'SV1750' , public_domain, joel3_bible, mal4_bible;...
    'VULG'   , public_domain, joel3_bible, mal4_bible;...
    'WEB'    , public_domain, joel3_bible, mal4_bible;...
    'WV75'   ,~public_domain,~joel3_bible,~mal4_bible;...
    dict.Process_All,false,false,true;...
    'bible.com',false,false,true};
public_domain=double(cell2mat(stringlist(:,2)));
joel3_bible=cell2mat(stringlist(:,3));
mal4_bible=cell2mat(stringlist(:,4));
stringlist=stringlist(:,1);
public_domain(ismember(stringlist,dict.Process_All))=-1;
public_domain(ismember(stringlist,'bible.com'))=-2;


%The Vulgata on bible.com is not (yet) complete. Once it is, the date
%should be updated in the get_html function. Please notify me when it is,
%so I can provide an update so everybody can use the same capture date,
%which offers the chance to hard-code the solutions to any issues.
%For now, it is removed from the list.
%(a support ticket has been opened with bible.com)
vulgata=ismember(stringlist,'VULG');
stringlist(vulgata)=[];
public_domain(vulgata)=[];
joel3_bible(vulgata)=[];
mal4_bible(vulgata)=[];


%Legal notice:
%If you want to download the other bibles included in the list, you need to
%be aware that it might not be legal for you to do so and you take the full
%responsibility for using this script.
base_filename=['I hereby declare I will only use this',...
    ' script if and only if it is legal for me to do so.txt'];
allow_all_filename=[place filesep base_filename];
if ~exist(allow_all_filename,'file') && ...
        ~exist(strrep(allow_all_filename,' ','_'),'file')
    %Disclaimer:
    %Under Dutch law, downloading a copy of a copyright protected work is
    %allowed if you are a natural person (i.e. a human, and not acting for
    %a corporation) and the copy is for personal (home) use only, under the
    %condition that you already own an otherwise legally acquired copy.
    %Adding this file to the main folder means you have read this
    %disclaimer, agree to it, and assume full legal responsibility for the
    %use of this script and the files it generates.
    %The law of your jurisdiction be different. It may prohibit the use of
    %this script or set different requirements.
    stringlist(~public_domain)=[];
    joel3_bible(~public_domain)=[];
    mal4_bible(~public_domain)=[];
    public_domain(~public_domain)=[];
end

%wrap around to add to readme text pop-up
allow_all_filename={[place filesep strrep(base_filename,' ','_')]};
charlim=50;
while length(allow_all_filename{end})>charlim
    allow_all_filename{end+1}=allow_all_filename{end}(charlim:end);%#ok
    allow_all_filename{end-1}(charlim:end)=[];
end


%These should be all complete public domain translations that are available
%on bible.com. All 1586 translation codes were checked. The URLs this is
%based on follows this pattern: http://www.bible.com/nl/versions/_code_
%which was captured to the Wayback Machine.
%Unicode support for controls and texts varies a lot between different
%releases. For that reason, some names have been changed or have been
%Latinized to allow only 1-255 chars.
bible.com.codelist=[7;25;42;44;45;49;51;54;57;58;60;61;62;64;78;80;81;...
    94;96;121;131;132;161;166;177;186;188;309;318;321;526;819;820;821;...
    904;1204;1207;1209];
bible.com.FullName={'Bibla Shqip';'Navarro-Labourdin Basque';...
    'Catholic Public Domain Version';'Bible Kralicka 1613';...
    '(Biblija na cerkovnoslavjanskom jazyke, CSLAV)';'Danske Bibel 1871';...
    'Lutherbibel 1912';'Diodati Bible';'Elberfelder 1905';'Elberfelder 1871';...
    'Finnish 1776';'Finnish 1938';'Martin 1744';'Bible Darby en francais';...
    'Giovanni Diodati Bibbia';'Italian Riveduta 1927';...
    'Colloquial Japanese (1955)';'Maori Bible';'Malagasy Bible';...
    'Det Norsk Bibelselskap 1930';'Ostervald';'Biblia Gdanska';...
    'Karl XII 1873';'Svenska 1917';'Ang Biblia';...
    '(Biblija v per. Ivana Ogienka, UBIO), 1962';...
    '(Biblija v per. P.Kulisa ta I.Puljuja, UKRK), 1905';...
    'Eesti Piibel';'Latviesu Jauna Deriba';'Lietuviska Biblija';...
    'Hungarian Bible by Lajos Csia';'Hindi Holy Bible';...
    'Hindi Holy Bible';'Young''s Literal Translation of the Holy Bible';...
    'Hebrew Westminster Leningrad Codex';...
    'World English Bible British Edition';...
    'World Messianic Bible British Edition';'World Messianic Bible'};
bible.com.joel3_bible=true(size(bible.com.FullName));
bible.com.language={'sq - Shqip';'eu - Euskara';'en - English';...
    'cs - Czech';'ru - Russian';'da - Dansk';'de - Deutsch';...
    'it - Italiano';'de - Deutsch';'de - Deutsch';'fi - suomi';...
    'fi - suomi';'fr - Français';'fr - Français';'it - Italiano';...
    'it - Italiano';'ja - Japanese';'mi - Maori';'mg - fiteny malagasy';...
    'nb - Norsk Bokmål';'fr - Français';'pl - Polish';'sv - Svenska';...
    'sv - Svenska';'tl - Wikang Tagalog';'uk - Ukrainian';...
    'uk - Ukrainian';'et - Eesti';'lv - Latvian';'lt - Lithuanian';...
    'hu - Magyar';'hi - Hindi';'hi - Hindi (Roman script)';...
    'en - English';'en - English';'en - English';'en - English'};
bible.com.ShortName={'ALBB';'BHNT';'CPDV';'CSBKR';'CSLAV';'DA1871';...
    'DELUT';'DO885';'ELB';'ELB71';'FI1776';'FINPR';'FMAR';'FRDBY';'IGD';...
    'ITRIV';'JA1955';'MAOR';'MG1865';'NORSK';'OST';'PBG';'SK73';'SVEN';...
    'TLAB';'UBIO';'UKRK';'EEP';'LJD';'LTB';'CSIA';'HHBD';'HHBR';'YLT98';...
    'WEBBE';'WMBBE';'WMB'};
if v>=7.2 %syntax introduced in R2006a
    %evade syntax checker of ML6.5 by using eval
    Fcn=eval('@(n,c) sprintf(''%d - %s'',c,n)');
    biblecom_options=cellfun(Fcn,...
        bible.com.FullName,...
        num2cell(bible.com.codelist),...
        'UniformOutput',false);
else
    %no cellfun, use loop
    biblecom_options=cell(1,numel(bible.com.codelist));
    for n=1:numel(biblecom_options)
        m=bible.com.FullName{n};c=bible.com.codelist(n);
        biblecom_options{n}=sprintf('%d - %s',c,m);
    end
end
%{
%These bible.com IDs are for translations by the Wycliffe foundation. This
%list was auto-generated by downloading the Dutch about page
%(bible.com/nl/versions/#). The Dutch page was chosen to more easily
%automatically read the contents of the page. Most translations have a
%license similar or equivalent to the Creative Commons License
%Attribution-Noncommercial-No Derivative Works 3.0 (CC-by-nc-nd 3.0). As
%this script is compliant with that license (barring processing errors),
%these can be integrated.
%Some translations are incomplete: some are only new testament, some
%include Psalms as well, but none have Joel chapter 4.
Wycliffe=[3;4;76;213;216;217;219;225;226;227;229;230;231;235;236;237;239;...
    240;241;243;247;249;250;252;254;255;257;258;259;260;265;266;267;268;...
    270;271;272;276;279;283;284;288;290;291;304;308;323;331;333;336;337;...
    342;343;354;358;364;366;379;381;383;388;408;409;412;424;426;427;428;...
    429;434;435;437;438;439;440;441;451;457;459;461;462;468;474;475;484;...
    485;486;499;505;506;510;511;512;514;517;519;520;521;523;524;530;531;...
    533;534;535;536;537;538;540;541;544;565;567;568;569;570;571;572;573;...
    576;577;578;581;583;584;586;587;588;590;595;596;597;600;603;608;609;...
    610;611;612;613;616;619;623;625;628;629;630;631;632;633;645;646;647;...
    648;649;650;652;653;654;655;657;658;659;660;661;662;663;664;667;669;...
    670;673;679;680;681;682;684;686;687;689;690;691;692;698;703;705;707;...
    710;711;712;713;718;720;721;723;724;725;726;727;728;729;730;731;732;...
    734;735;736;737;738;739;740;741;742;743;744;745;746;747;748;749;750;...
    751;752;754;755;756;757;764;765;766;767;768;769;770;771;772;773;774;...
    775;776;777;779;780;781;783;784;785;786;787;788;789;793;795;796;797;...
    799;824;826;828;829;830;831;832;833;834;836;837;838;842;843;844;845;...
    846;847;848;849;850;851;852;854;857;858;861;864;865;866;867;902;922;...
    925;927;928;932;936;949;951;952;958;959;960;963;964;965;967;970;974;...
    975;976;979;980;981;982;985;986;988;989;991;993;994;999;1001;1002;...
    1003;1006;1007;1009;1011;1015;1019;1020;1025;1026;1028;1036;1037;...
    1045;1055;1056;1057;1061;1066;1067;1069;1073;1074;1075;1081;1084;...
    1085;1086;1087;1088;1089;1090;1091;1092;1093;1100;1101;1102;1103;...
    1108;1114;1115;1116;1121;1126;1129;1131;1143;1146;1153;1154;1157;...
    1158;1173;1174;1175;1176;1189;1230;1241;1243;1248;1249;1282];
%}
h_fig=start_GUI(dict,biblecom_options,place,joel3_bible,mal4_bible,...
    public_domain,stringlist,allow_all_filename,bible,isOctave);

end
function h_fig=start_GUI(dict,biblecom_options,place,joel3_bible,mal4_bible,...
    public_domain,stringlist,allow_all_filename,bible,isOctave)
h_fig = figure(...
    'Units','Characters',...
    'Visible','off',...
    'Color',[0.94 0.94 0.94],...
    'IntegerHandle','off',...
    'MenuBar','none',...
    'Name',dict.menuBarLabel,...
    'NumberTitle','off',...
    'Tag','figure1',...
    ...'Resize','off',...
    'HandleVisibility','callback');
pos=get(h_fig,'Position');set(h_fig,'Position',[pos(1:2) 116 30.9230769230769]);

n_done=0;total_elements=length(stringlist)+11;
h_waitbar=waitbar(n_done/total_elements,dict.startFunction);
pause(0.0001);drawnow;

a=ceil(sqrt(length(stringlist)));
%cap number of cols to 5:
a=min([a 5]);
b=ceil(length(stringlist)/a);
gridpattern=reshape(1:(a*b),[b a])';
for nBible=1:length(stringlist)%add in all bible buttons in a loop
    [col,row]=find(gridpattern==nBible);
    edges=[7.6 75 26.5 8.5];
    pos=[0 0 0 0];
    pos(1)=(row-0.9)/b*(edges(2)-edges(1))+edges(1);
    pos(3)=(0.9-0.1)*(edges(2)-edges(1))/b;
    pos(2)=(col-0.9)/a*(edges(4)-edges(3))+edges(3);
    pos(4)=abs((0.9-0.1)*(edges(4)-edges(3))/a);
    
    if public_domain(nBible)==1
        col=[0 1 0];
    elseif public_domain(nBible)==-1
        col=[1 1 0];
    elseif public_domain(nBible)==-2
        col=[1 1 0];
        pos1=pos;pos1(4)=pos1(4)/2;
        pos2=pos;pos2(4)=pos2(4)/2;pos2(2)=pos2(2)+pos1(4);
        
        h=uicontrol(...
            'Parent',h_fig,...
            'FontUnits','points',...
            'Units','characters',...
            'String',biblecom_options,...
            'Style','popupmenu',...
            'Position',pos1,...
            'Children',[],...
            'tag','biblecomUntestedDropdown');
        set(h,'Units','Normalized')
        
        h=uicontrol(...
            'Parent',h_fig,...
            'FontUnits','points',...
            'Units','characters',...
            'String',stringlist{nBible},...
            'Style','pushbutton',...
            'Position',pos2,...
            'Callback',@button_Callback,...
            'BackgroundColor',col,...
            'Children',[],...
            'tag','biblecomUntested');
        set(h,'Units','Normalized')
        
        n_done=n_done+1;
        waitbar(n_done/total_elements,h_waitbar);
        pause(0.0001);drawnow;
        continue
    else
        %standard grey
        col=[0.94118 0.94118 0.94118];
    end
    h=uicontrol(...
        'Parent',h_fig,...
        'FontUnits','points',...
        'Units','characters',...
        'String',stringlist{nBible},...
        'Style','pushbutton',...
        'Position',pos,...
        'Callback',@button_Callback,...
        'BackgroundColor',col,...
        'Children',[],...
        'tag',stringlist{nBible});
    set(h,'Units','Normalized')
    
    n_done=n_done+1;
    waitbar(n_done/total_elements,h_waitbar);
    pause(0.0001);drawnow;
end

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.explanation,...
    'Style','pushbutton',...
    'Position',[80 26.14 28.2 2.88],...
    'Callback',@Explain_Callback,...
    'Children',[],...
    'Tag','Explain');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;
h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.bibles,...
    'Style','pushbutton',...
    'Position',[80 23.14 28.2 2.88],...
    'Callback',@bible_list_msgbox_Callback,...
    'Children',[],...
    'Tag','bible_list_msgbox');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'HorizontalAlignment','left',...
    'String',' ',...
    'Style','edit',...
    'Position',[3.8 9.15384615384616 108.2 1.69230769230769],...
    'BackgroundColor',[1 1 1],...
    'Children',[],...
    'Tag','edit1',...
    'FontName','FixedWidth');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'HorizontalAlignment','left',...
    'String',' ',...
    'Style','edit',...
    'Position',[3.8 6.07692307692308 108.2 1.69230769230769],...
    'BackgroundColor',[1 1 1],...
    'Children',[],...
    'Tag','edit2',...
    'FontName','FixedWidth');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'HorizontalAlignment','left',...
    'String',dict.currentDirectory,...
    'Style','text',...
    'Position',[3.6 1.46153846153846 80.2 3.23076923076923],...
    'BackgroundColor',[1 1 1],...
    'Children',[],...
    'Tag','text4');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.changeDirectory,...
    'Style','pushbutton',...
    'Position',[87.6 1.30769230769231 20.2 3.38461538461539],...
    'Callback',@Change_folder_Callback,...
    'Children',[],...
    'Tag','Change_folder');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.readMeFirst,...
    'Style','pushbutton',...
    'Position',[80 20.14 28.2 2.88],...
    'Callback',@read_first_Callback,...
    'Children',[],...
    'Tag','read_first');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.downloadOnly,...
    'Style','radiobutton',...
    'Position',[83.8 18.2307692307692 24.2 1.76923076923077],...
    'Callback',@radiobutton_download_Callback,...
    'Children',[],...
    'Tag','radiobutton_download');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.fullProcess,...
    'Style','radiobutton',...
    'Position',[83.8 15.1538461538462 24.2 1.76923076923077],...
    'Callback',@radiobutton_process_Callback,...
    'Children',[],...
    'Tag','radiobutton_process');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

h=uicontrol(...
    'Parent',h_fig,...
    'FontUnits','points',...
    'Units','characters',...
    'String',dict.cancel,...
    'Style','togglebutton',...
    'Position',[83.6 12.1538461538462 24.4 1.69230769230769],...
    'Callback',@cancel_Callback,...
    'Children',[],...
    'Tag','togglebutton1',...
    'Visible','off');
set(h,'Units','Normalized')

n_done=n_done+1;
waitbar(n_done/total_elements,h_waitbar);
pause(0.0001);drawnow;

%Set all objects as a field of a struct (generating the guidata handles)
handles=struct(get(h_fig,'tag'),h_fig);
list_of_handles=get(h_fig,'Children');
for n=1:length(list_of_handles)
    handles.(get(list_of_handles(n),'tag'))=list_of_handles(n);
end
handles.bible=bible;
guidata(h_fig,handles)
set(handles.radiobutton_download,'Value',1);
set(handles.radiobutton_process,'Value',0);
delete(h_waitbar)

handles.place=place;
set(handles.text4,'String',[dict.currentDirectory ' ' place])
handles.stat_field1=handles.edit1;
handles.stat_field2=handles.edit2;
handles.joel3_bible=joel3_bible;
handles.mal4_bible=mal4_bible;
handles.public_domain=public_domain;
handles.stringlist=stringlist;
handles.dict=dict;
handles.allow_all_filename=allow_all_filename;
% Update handles structure
guidata(h_fig, handles);

set(h_fig,'Visible','on')

if isOctave
    %uiwait
end
end
function dict=get_dictionary(varargin)
% Return the dictionary for a user-selected language.
%
% Currently supported languages:
% - English
% - Dutch
%
% You can e-mail me translations if you would like me to add them.

isOctave = exist('OCTAVE_VERSION', 'builtin') ~= 0;
languages={'English (en - English)','Dutch (nl - Nederlands)'};

if nargin==1
    language=varargin{1};
else
    [language,numberOfInputs] = listdlg('PromptString','Select language:',...
        'SelectionMode','single','ListString',languages);
    if numberOfInputs==0,language=1;end
end

%Force direction (for easy viewing during debugging)
temp=cell(length(languages),1);

temp{1}='Starting function ... ';
temp{2}='Programma starten ...';
dict.startFunction=temp{language};
temp{1}='Bible Downloader';
temp{2}='Bijbeldownloader';
dict.menuBarLabel=temp{language};
temp{1}='Process_All';%has to be a valid field name
temp{2}='Verwerk_Alles';%has to be a valid field name
dict.Process_All=temp{language};
temp{1}='explanation';
temp{2}='uitleg';
dict.explanation=temp{language};
temp{1}='list of Bibles';
temp{2}='Bijbellijst';
dict.bibles=temp{language};
temp{1}='Current directory:';
temp{2}='Huidige werkmap:';
dict.currentDirectory=temp{language};
temp{1}='change directory';
temp{2}='werkmap wijzigen';
dict.changeDirectory=temp{language};
temp{1}='READ ME FIRST';
temp{2}='LEES MIJ EERST';
dict.readMeFirst=temp{language};
temp{1}='Download only';
temp{2}='Alleen downloaden';
dict.downloadOnly=temp{language};
temp{1}='Full process';
temp{2}='Volledig verwerken';
dict.fullProcess=temp{language};
temp{1}='cancel';
temp{2}='annuleren';
dict.cancel=temp{language};
temp{1}='Process complete in %d:%02.0f';
temp{2}='Proces afgerond in %d:%02.0f';
dict.processComplete=temp{language};
temp{1}='An error occurred: "%s"';
temp{2}='Er is een fout opgetreden: "%s"';
dict.anErrorOccurred=temp{language};
temp{1}='Errors may exist in the output file. Last error was: %s';
temp{2}=['Er zouden fouten kunnen zitten in het outputbestand. ',...
    'De laatste fout was: %s'];
dict.possibleErrorInOutput1=temp{language};%used in warning, no max length
temp{1}='.bible file likely contains errors. Check file manually';
temp{2}='.bible bevat waarschijnlijk fouten. Check resultaat handmatig.';
dict.possibleErrorInOutput2=temp{language};
temp{1}='%s (%04.1f%% done, estimated time of completion: %s)';
temp{2}='%s (%04.1f%% klaar, verwachte tijd van afronden: %s)';
dict.ETA_book=temp{language};
if isOctave
    temp{1}='%s %d (%04.1f%% done, estimated time of completion: %s)';
    temp{2}='%s %d (%04.1f%% klaar, verwachte tijd van afronden: %s)';
else
    temp{1}='%s % 3d (%04.1f%% done, estimated time of completion: %s)';
    temp{2}='%s % 3d (%04.1f%% klaar, verwachte tijd van afronden: %s)';
end
dict.ETA_chapter=temp{language};
temp{1}={...
    'With this program you can download several different translations.',...
    '','The first step is to download a html file for each chapter. This ',...
    'process can take up to 2 to 3 hours. This process will resume when',...
    'it is restarted, unlike the second step.','',...
    'The second step is converting the html files to a .bible file.',...
    'The HTML files will be downloaded to a subfolder of the folder',...
    'marked as current folder in the GUI.','',...
    'With the radio buttons you can switch between only downloading the',...
    'HTML files, and also converting to a .bible file.',...
    ''};
temp{2}={...
    'Met dit programma is het mogelijk om verscheidene vertalingen te',...
    'downloaden. Dit gebeurt in twee stappen.','',...
    'De eerste stap is het downloaden van een html-bestand voor ieder',...
    'hoofdstuk. Omdat dit proces erg lang kan duren (tot 2 a 3 uur per',...
    'Bijbel), kan dit onderbroken en later hervat worden.','',...
    'De tweede stap is het omzetting van de html-bestanden naar een .bible.',...
    'Dit proces kan niet onderbroken en later hervat worden.',...
    'De html-bestanden zullen worden gedownload naar',...
    '[HuidigeWerkmap/HTMLs/BijbelAfkorting]. De .bible bestanden worden',...
    'opgeslagen in de huidige werkmap.',...
    ' ',...
    'Het downloaden van de html-bestanden kan worden gestart door de knop',...
    '''' dict.downloadOnly ''' te selecteren en daarna een vertaling te selecteren.',...
    'De knop ''' dict.fullProcess ''' zet de html om naar een .bible bestand.',''};
dict.Explain_Callback=temp{language};
temp{1}={'The green buttons are for translations that are public domain.',...
    ''};
temp{2}={'De groene knoppen zijn vertalingen waar geen copyright op rust.',...
    ''};
dict.bible_list_msgbox_Callback__part1=temp{language};
temp{1}={'ASV: American Standard Version, English',...
    'BB: de Basisbijbel, Dutch',...
    'BGT: de Bijbel in Gewone Taal, Dutch',...
    'GNB: Groot Nieuws Bijbel, Dutch',...
    'HB: Het Boek, Dutch',...
    'HSV: de Herziene Statenvertaling, Dutch',...
    'KJV: King James Version, English',...
    'LS1910: Luis Segond (1910), French',...
    'NB: de Naardense Bijbel, Dutch',...
    'NBG51: de Nieuwe Vertaling (1951), Dutch',...
    'NBV: de Nieuwe Bijbelvertaling, Dutch',...
    'NWv2004: de Nieuwe-Wereldvertaling (2004), Dutch',...
    'NWv2017: de Nieuwe Wereldvertaling (2017), Dutch',...
    'RV1602: Reina Valera (1602), Spanish',...
    'SV1637: de Statenvertaling (1637, original version), Dutch',...
    'SV1750: de Statenvertaling (1750), Dutch',...
    'SV73: de Statenvertaling (1973, revision by the GBS), Dutch',...
    'SV77: de Statenvertaling (1977, revisie by the NBG), Dutch',...
    'WEB: World English Bible, English',...
    'WV75: de Willibrordvertaling, Dutch',' ',...
    '(the SV1637 en SV77 are downloaded together)'};
temp{2}={'ASV: American Standard Version, Engels',...
    'BB: de Basisbijbel',...
    'BGT: de Bijbel in Gewone Taal',...
    'GNB: Groot Nieuws Bijbel',...
    'HB: Het Boek',...
    'HSV: de Herziene Statenvertaling',...
    'KJV: King James Version, Engels',...
    'LS1910: Luis Segond (1910), Frans',...
    'NB: de Naardense Bijbel',...
    'NBG51: de Nieuwe Vertaling (1951)',...
    'NBV: de Nieuwe Bijbelvertaling',...
    'NWv2004: de Nieuwe-Wereldvertaling (2004)',...
    'NWv2017: de Nieuwe Wereldvertaling (2017)',...
    'RV1602: Reina Valera (1602), Spaans',...
    'SV1637: de Statenvertaling (1637, originele versie)',...
    'SV1750: de Statenvertaling (1750)',...
    'SV73: de Statenvertaling (1973, revisie door de GBS)',...
    'SV77: de Statenvertaling (1977, revisie door het NBG)',...
    'WEB: World English Bible, Engels',...
    'WV75: de Willibrordvertaling',' ',...
    '(de SV1637 en SV77 worden gezamenlijk gedownload)'};
dict.bible_list_msgbox_Callback__part2a=temp{language};
temp{1}={'ASV: American Standard Version, English',...
    'KJV: King James Version, English',...
    'LS1910: Luis Segond (1910), French',...
    'RV1602: Reina Valera (1602), Spanish',...
    'SV1637: de Statenvertaling (1637, original version), Dutch',...
    'SV1750: de Statenvertaling (1750), Dutch',...
    'WEB: World English Bible, English'};
temp{2}={'ASV: American Standard Version, Engels',...
    'KJV: King James Version, Engels',...
    'LS1910: Luis Segond (1910), Frans',...
    'RV1602: Reina Valera (1602), Spaans',...
    'SV1637: de Statenvertaling (1637, originele versie)',...
    'SV1750: de Statenvertaling (1750)',...
    'WEB: World English Bible, Engels'};
dict.bible_list_msgbox_Callback__part2b=temp{language};
temp{1}={'',...
    'The bible.com translations under the drop-down menu are untested,',...
    'so the chance on errors is quite large.'};
temp{2}={'','De vertalingen van bible.com zijn publiek domein,',...
    'maar ze zijn niet getest, dus de kans op fouten is groot.'};
dict.bible_list_msgbox_Callback__part3=temp{language};
temp{1}='Help text';
temp{2}='Helptekst';
dict.helptext=temp{language};


temp{1}={'IMPORTANT:',...
    'Under Dutch law, downloading a copy of a copyright protected work is',...
    'allowed if you are a natural person (i.e. a human, and not acting for',...
    'a corporation) and the copy is for personal (home) use only, under the',...
    'condition that you already own an otherwise legally acquired copy.',...
    'This copy does not have to be digital. You can create a file in',...
    '''' dict.currentDirectory ''' with a specific name (see below) to enable the',...
    'downloading of non-public domain translations. Adding this file to the',...
    'main folder means you have read this disclaimer and assume full legal',...
    'responsibility for the use of this script and the files it generates.',...
    ' ',...
    'The law of your jurisdiction be different. It may prohibit the use of',...
    'this script or set different requirements.',...
    ' ',...
    'All bibles in this program are protected works, with the exception of',...
    'translations with a green button and the bibles in the drop-down menu',...
    'from bible.com, which are public domain.',...
    ' ',...
    'This program is provided as is, without any warranty whatsoever.',...
    'Despite thorough testing and damage being unlikely, all use is the',...
    'sole responsibility of the user.',...
    '',...
    'file name:'};
temp{2}={'BELANGRIJK:',...
    ' ',...
    'Het is onder het Nederlandse auteursrecht toegestaan om een kopie te',...
    'maken van een werk waar auteursrecht op rust. Hiervoor gelden onder',...
    'meer als voorwaarden dat de gebruiker een natuurlijke persoon is, dat',...
    'het gaat om een thuiskopie voor eigen gebruik, en dat de gebruiker al',...
    'een exemplaar in bezit heeft. Dit hoeft niet een digitaal exemplaar',...
    'te zijn.',...
    '',...
    'De vertalingen die publiek domein zijn, hebben een groene knop. Voor',...
    'deze vertalingen gelden de bovenstaande beperkingen dus in principe',...
    'niet. Ook de vertalingen van bible.com zijn publiek domein.',...
    '',...
    'Om de knoppen voor de beschermde ook beschikbaar te maken, kun je een',...
    'bestand met een specifieke naam in ''' dict.currentDirectory '''',...
    'aan te maken (zie hieronder). Door dit bestand toe te voegen,',...
    'verklaart de gebruiker dat hij de gestelde voorwaarden die de wet',...
    'stelt begrijpt en volledige juridische verantwoordelijkheid op zich',...
    'neemt voor het gebruik van dit script.',...
    '',...
    'Door het gebruiken van dit programma gaat de gebruiker',...
    'er mee akkoord dat, ondanks uitgebreid testen, de werkzaamheid van het',...
    'programma op geen enkele manier gegarandeerd is. Hoewel schade zeer',...
    'onwaarschijnlijk is, is ieder risico van gebruik voor rekening van de',...
    'gebruiker, en niet voor de maker.',...
    '',...
    'bestandsnaam:'};
dict.read_first_Callback=temp{language};
temp{1}='Download of %s HTMLs started';
temp{2}='Download van %s HTMLs begonnen';
dict.startedDownload=temp{language};
temp{1}='Conversion of %s to .bible started';
temp{2}='Conversie van %s naar .bible begonnen';
dict.startedConversion=temp{language};
temp{1}='Download of %s HTMLs interrupted successfully';
temp{2}='Download van %s HTMLs succesvol onderbroken';
dict.interruptedDownload=temp{language};
temp{1}='Conversion of %s to .bible interrupted successfully';
temp{2}='Conversie van %s naar .bible succesvol onderbroken';
dict.interruptedConversion=temp{language};
temp{1}='Download of %s HTMLs completed';
temp{2}='Download van %s HTMLs afgerond';
dict.finishedDownload=temp{language};
temp{1}='Applying corrections to verse numbers...';
temp{2}='Correcties op versnummers toepassen...';
dict.startedCorrection=temp{language};
temp{1}='Download of SV1637 and SV77 started';
temp{2}='Download van SV1637 en SV77 begonnen';
dict.SV1637_77_started=temp{language};
temp{1}='Download of SV1637 and SV77 interrupted successfully';
temp{2}='Download van SV1637 en SV77 succesvol onderbroken';
dict.SV1637_77_interrupted=temp{language};
temp{1}='%04.1f%% done, estimated time of completion: %s';
temp{2}='%04.1f%% klaar, verwachte tijd van afronden: %s';
dict.SV1637_77_ETA=temp{language};
temp{1}='Download of SV1637 and SV77 HTMLs completed';
temp{2}='Download van SV1637 en SV77 HTMLs afgerond';
dict.SV1637_77_download_complete=temp{language};
temp{1}={'Special characters might not work. Only these will always work:',...
    char(32:64),char(65:90),char(91:126),'',...
    'The other characters may appear as boxes or question-marks.'};
temp{2}={'Speciale tekens werken mogelijk niet.',...
    'Deze tekens moeten altijd werken:',...
    char(32:64),char(65:90),char(91:126),'',...
    'De andere tekens worden mogelijk weergegeven ',...
    'als vierkantjes of vraagtekens.'};
dict.ASCII_only.msg=temp{language};
temp{1}='non-ASCII UTF-8 support warning';
temp{2}='non-ASCII UTF-8 support warning';
dict.ASCII_only.title=temp{language};
temp={...
    'Genesis','Genesis';...
    'Exodus','Exodus';...
    'Leviticus','Leviticus';...
    'Numbers','Numeri';...
    'Deuteronomy','Deuteronomium';...
    'Joshua','Jozua';...
    'Judges','Rechters';...
    'Ruth','Ruth';...
    '1 Samuel','1 Samuel';...
    '2 Samuel','2 Samuel';...
    '1 Kings','1 Koningen';...
    '2 Kings','2 Koningen';...
    '1 Chronicles','1 Kronieken';...
    '2 Chronicles','2 Kronieken';...
    'Ezra','Ezra';...
    'Nehemiah','Nehemia';...
    'Ester','Esther';...
    'Job','Job';...
    'Psalm','Psalmen';...
    'Proverbs','Spreuken';...
    'Ecclesiastes','Prediker';...
    'Song,of,Songs','Hooglied';...
    'Isaiah','Jesaja';...
    'Jeremiah','Jeremia';...
    'Lamentations','Klaagliederen';...
    'Ezekiel','Ezechiel';...
    'Daniel','Daniel';...
    'Hosea','Hosea';...
    'Joel','Joel';...
    'Amos','Amos';...
    'Obadiah','Obadja';...
    'Jonah','Jona';...
    'Micah','Micha';...
    'Nahum','Nahum';...
    'Habakuk','Habakuk';...
    'Zephaniah','Sefanja';...
    'Haggai','Haggai';...
    'Zechariah','Zacharia';...
    'Malachi','Maleachi';...
    'Matthew','Matteus';...
    'Mark','Marcus';...
    'Luke','Lucas';...
    'John','Johannes';...
    'Acts','Handelingen';...
    'Romans','Romeinen';...
    '1 Corinthians','1 Korintiers';...
    '2 Corinthians','2 Korintiers';...
    'Galatians','Galaten';...
    'Ephesians','Efeziers';...
    'Philippians','Filippenzen';...
    'Colossians','Kolossenzen';...
    '1 Thessalonians','1 Tessalonicenzen';...
    '2 Thessalonians','2 Tessalonicenzen';...
    '1 Timothy','1 Timoteus';...
    '2 Timothy','2 Timoteus';...
    'Titus','Titus';...
    'Philemon','Filemon';...
    'Hebrews','Hebreeen';...
    'James','Jakobus';...
    '1 Peter','1 Petrus';...
    '2 Peter','2 Petrus';...
    '1 John','1 Johannes';...
    '2 John','2 Johannes';...
    '3 John','3 Johannes';...
    'Jude','Judas';...
    'Revelation','Openbaring'};
dict.books=temp(:,language);
end
function cancel_Callback(hObject, ignore_var, ignore_var2)%#ok ~ ML6.5
set(hObject,'Value',1)
end
function ME=button_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
%Download or process a translation, based on the button and the radio
handles=guidata(hObject);
dict=handles.dict;

%set the color of the currently active button to blue
set(hObject,'BackgroundColor',[0 0.6 1])

%With one button, all other buttons can get clicked:
if strcmp(get(hObject,'String'),dict.Process_All)
    %t=tic;%output for tic introduced in R2008b
    t=now;
    for n=1:length(handles.stringlist)
        if strcmp(handles.stringlist{n},dict.Process_All),continue,end
        if strcmp(handles.stringlist{n},'bible.com'),continue,end
        ME=button_Callback(handles.(handles.stringlist{n}));
    end
    t=(now-t)*(24*60*60);
    %t=toc(t);
    s=mod(t,60);m=floor(t/60);
    set(handles.stat_field1,'String',...
        sprintf(dict.processComplete,m,s))
    if isempty(ME)
        set(handles.stat_field2,'String',' ')
    else
        set(handles.stat_field2,'String',...
            sprintf(dict.anErrorOccurred,ME.message))
    end
    %reset color of this button to yellow
    set(hObject,'BackgroundColor',[1 1 0])
    return
end

%try to get the selected bible
%(this is untested and might result in an error half-way)
is_untested=strcmp(get(hObject,'String'),'bible.com');
if is_untested
    pos=get(handles.biblecom_untested,'Value');
    prefix=handles.bible.com.ShortName{pos};
else
    prefix=get(hObject,'String');
end

%clear the status fields
set(handles.stat_field1,'String',' ')
set(handles.stat_field2,'String',' ')

isOctave = exist('OCTAVE_VERSION', 'builtin') ~= 0;
PlatformVersion=version;PlatformVersion=str2double(PlatformVersion(1:3));
isOld= ((isOctave*4)+PlatformVersion)<9;%before Octave 5.0 or Matlab 2016a
disp_per_chapter=false || isOld;
switch prefix
    case {'SV1637','SV77'}
        prefix2='SV1637_77';
    otherwise
        prefix2=prefix;
end
htmlpath=[handles.place filesep 'HTMLs' filesep prefix2 filesep];
%load the books and chapter count
list={'GENESIS' '50';'EXODUS' '40';'LEVITICUS' '27';'NUMERI' '36';...
    'DEUTERONOMIUM' '34';'JOZUA' '24';'RECHTERS' '21';'RUTH' '4';...
    '1SAMUEL' '31';'2SAMUEL' '24';'1KONINGEN' '22';'2KONINGEN' '25';...
    '1KRONIEKEN' '29';'2KRONIEKEN' '36';'EZRA' '10';'NEHEMIA' '13';...
    'ESTHER' '10';'JOB' '42';'PSALMEN' '150';'SPREUKEN' '31';...
    'PREDIKER' '12';'HOOGLIED' '8';'JESAJA' '66';'JEREMIA' '52';...
    'KLAAGLIEDEREN' '5';'EZECHIEL' '48';'DANIEL' '12';'HOSEA' '14';...
    'JOEL' '4';'AMOS' '9';'OBADJA' '1';'JONA' '4';'MICHA' '7';...
    'NAHUM' '3';'HABAKUK' '3';'SEFANJA' '3';'HAGGAI' '2';...
    'ZACHARIA' '14';'MALEACHI' '3';'MATTEUS' '28';'MARCUS' '16';...
    'LUCAS' '24';'JOHANNES' '21';'HANDELINGEN' '28';'ROMEINEN' '16';...
    '1KORINTIERS' '16';'2KORINTIERS' '13';'GALATEN' '6';'EFEZIERS' '6';...
    'FILIPPENZEN' '4';'KOLOSSENZEN' '4';'1TESSALONICENZEN' '5';...
    '2TESSALONICENZEN' '3';'1TIMOTEUS' '6';'2TIMOTEUS' '4';'TITUS' '3';...
    'FILEMON' '1';'HEBREEEN' '13';'JAKOBUS' '5';'1PETRUS' '5';...
    '2PETRUS' '3';'1JOHANNES' '5';'2JOHANNES' '1';'3JOHANNES' '1';...
    'JUDAS' '1';'OPENBARING' '22'};
hoofdstukken=list(:,2);
if is_untested || handles.joel3_bible(ismember(handles.stringlist,prefix))
    hoofdstukken{29}='3';%Joel
    chapter_total=1188;%valid for Joel 3 bibles
else
    chapter_total=1189;%valid for Joel 4 bibles
end
if is_untested || handles.mal4_bible(ismember(handles.stringlist,prefix))
    hoofdstukken{39}='4';%Malachi
    chapter_total=chapter_total+1;%valid for Malachi 4 bibles
end
if isOctave
    boek=list(:,1);%used in file name
    padded_boek=dict.books;
else
    boek=list(:,1);%used in file name
    padded_boek=pad_cell(dict.books);
end
if is_untested
    license='Public domain';
    comment=['http://web.archive.org/web/2/',...
        'https://www.bible.com/versions/' ...
        num2str(handles.bible.com.codelist(pos))];
    FullName=handles.bible.com.FullName{pos};
    language=handles.bible.com.language{pos};
end
Copyright=['Copyright ' char(169) ' '];
switch prefix
    case 'ASV'
        license='Public domain';
        comment=['http://web.archive.org/web/201710/',...
            'https://www.bible.com/versions/12'];
        FullName='American Standard Version';
        language='en - English';
    case 'BB'
        license=[Copyright 'stichting Basisbijbel'];
        comment='See menu on website';
        FullName='Basisbijbel';
        language='nl - Nederlands';
    case 'BGT'
        FullName='Bijbel in Gewone Taal';
        license=[Copyright 'Nederlands Bijbelgenootschap 2014'];
        comment='';
        language='nl - Nederlands';
    case 'GNB'
        FullName='Groot Nieuws Bijbel';
        license=[Copyright 'Nederlands Bijbelgenootschap/Katholieke Bijbelstichting 1983/1996'];
        comment='version from 1996';
        language='nl - Nederlands';
    case 'HB'
        FullName='Het Boek';
        license=[Copyright '1979, 1988, 2007 by Biblica, Inc.' char(174)];
        comment=['https://web.archive.org/web/20161007171731/',...
            'https://www.bible.com/nl/versions/75'];
        language='nl - Nederlands';
    case 'HSV'
        FullName='Herziene Statenvertaling (druk 2016)';
        license=[Copyright '2010/2016 Stichting HSV'];
        comment=['https://web.archive.org/web/20170806081313/',...
            'https://herzienestatenvertaling.nl/',...
            'verantwoording-bij-de-gewijzigde-druk/'];
        language='nl - Nederlands';
    case 'KJV'
        FullName='King James version';
        license='Public domain (royal prerogative in UK)';
        comment=['http://web.archive.org/web/201709/',...
            'https://www.bible.com/versions/1'];
        language='en - English';
    case 'LS1910'
        FullName='Louis Segond 1910';
        license='Public domain';
        comment=['http://web.archive.org/web/201709/',...
            'https://www.bible.com/versions/93'];
        language=['fr - Fran' char(231) 'ais'];
    case 'NASB'
        license=[Copyright '1995 by The Lockman Foundation.'];
        comment=['http://web.archive.org/web/201404/',...
            'https://www.bible.com/versions/100'];
        FullName='New American Standard Bible';
        language='en - English';
    case 'NB2014'
        FullName='Naardense Bijbel (2014)';
        license=[Copyright 'Skandalon 2014 - 2017'];
        comment='http://www.naardensebijbel.nl/';
        language='nl - Nederlands';
    case 'NBG51'
        FullName='Nieuwe Vertaling (1951, NBG)';
        license=[Copyright 'Nederlands Bijbelgenootschap 1951'];
        comment=['https://web.archive.org/web/20161007172532/',...
            'https://www.bible.com/nl/versions/328'];
        language='nl - Nederlands';
    case 'NBV2017'
        FullName='Nieuwe Bijbelvertaling (2004, revisies tot 2017/09)';
        license=[Copyright 'Nederlands Bijbelgenootschap 2004/2007'];
        comment='https://www.debijbel.nl/info/gebruiksvoorwaarden';
        language='nl - Nederlands';
    case 'NWv2004'
        FullName='Nieuwe-Wereldvertaling (revisie 2004)';
        license=[Copyright ...
            '2004 Watch Tower Bible and Tract Society of Pennsylvania.'];
        comment='';
        language='nl - Nederlands';
    case 'NWv2017'
        FullName='Nieuwe Wereldvertaling (revisie 2017)';
        license=[Copyright ...
            '2017 Watch Tower Bible and Tract Society of Pennsylvania.'];
        comment='';
        language='nl - Nederlands';
    case 'RV1602'
        FullName='Reina-Valera (antigua, 1602)';
        license='Public domain';
        comment=['http://web.archive.org/web/201709/',...
            'https://www.bible.com/versions/147'];
        language=['es - Espa' char(241) 'ol'];
    case 'SV73'
        FullName='Statenvertaling (1973, GBS)';
        license=[Copyright 'Gereformeerde Bijbelstichting'];
        comment='';
        language='nl - Nederlands';
    case 'SV77'
        FullName='Statenvertaling (1977, NBG)';
        license=[Copyright 'Nederlands Bijbelgenootschap'];
        comment='';
        language='nl - Nederlands';
    case 'SV1637'
        FullName='Statenvertaling (1637)';
        license='Public domain';
        comment='';
        language='nl - Nederlands';
    case 'SV1750'
        license='Public domain';
        comment=['http://web.archive.org/web/201710/',...
            'https://www.bible.com/versions/165'];
        FullName='Statenvertaling (1750)';
        language='nl - Nederlands';
    case 'VULG'
        FullName='Vulgata latina';
        license='Public domain';
        comment=['http://web.archive.org/web/201710/',...
            'https://www.bible.com/versions/823'];
        language='la - Latin';
    case 'WV75'
        FullName='Willibrordvertaling (1975)';
        license=[Copyright '1975, KBS Boxtel / Uitg Emmaus Brugge'];
        comment='';
        language='nl - Nederlands';
    case 'WEB'
        FullName='World English Bible';
        license='Public domain';
        comment=['http://web.archive.org/web/201709/',...
            'https://www.bible.com/versions/206'];
        language='en - English';
end
if get(handles.radiobutton_download,'Value')
    %Download (get .html)
    set(handles.togglebutton1,'Value',0)
    set(handles.togglebutton1,'Visible','on')
    if is_untested
        missing_files=get_html(handles,htmlpath,boek,padded_boek,...
            hoofdstukken,chapter_total,FullName,prefix,handles.bible);
    else
        missing_files=get_html(handles,htmlpath,boek,padded_boek,...
            hoofdstukken,chapter_total,FullName,prefix);
    end
    ME=[];
    if missing_files~=0
        ME=struct('message','download of HTMLs failed');
    end
    %reset color
    if handles.public_domain(ismember(handles.stringlist,prefix))==1
        col=[0 1 0];
    elseif is_untested
        col=[1 1 0];
    else
        %standard grey
        col=[0.94118 0.94118 0.94118];
    end
    set(hObject,'BackgroundColor',col)
    set(handles.togglebutton1,'Visible','off')
else
    %Process (get .bible)
    set(handles.togglebutton1,'Value',0)
    set(handles.togglebutton1,'Visible','on')
    
    fid_db=fopen([handles.place filesep prefix '.bible'],'wb');
    write_string(fid_db,sprintf('{\n'));
    write_string(fid_db,sprintf('"long name": "%s",\n',FullName));
    write_string(fid_db,sprintf('"short name": "%s",\n',prefix));
    write_string(fid_db,sprintf('"sheet name": "%s",\n',prefix));
    write_string(fid_db,sprintf('"license": "%s",\n',license));
    write_string(fid_db,sprintf('"comment": "%s"\n',comment));
    write_string(fid_db,sprintf('"language": "%s"\n',language));
    write_string(fid_db,sprintf('}\n'));
    write_string(fid_db,sprintf('~~~~\n'));
    counter=0;
    %t=tic;%output for tic introduced in R2008b
    t=now;
    for boeknr=1:66
        if ~disp_per_chapter
            %t2=toc(t);
            t2=(now-t)*(24*60*60);
            f=counter/chapter_total;
            t_r=round((t2-f*t2)/f);
            if isinf(t_r) || f==0
                ETA='##:##:##';
            else
                try
                    ETA=datestr(addtodate(now,t_r,'second'),'HH:MM:SS');
                catch
                    %ML6.5 addtodate was probably added in ML7.0
                    ETA=datestr(now+(t_r/(24*60*60)),'HH:MM:SS');
                end
            end
            disp_status(sprintf(dict.ETA_book,...
                padded_boek{boeknr},100*f,ETA),handles.stat_field1)
        end
        for hoofdstuk=1:round(str2double(hoofdstukken{boeknr}))
            if get(handles.togglebutton1,'Value')
                disp_status(sprintf(dict.interruptedConversion,FullName),...
                    handles.stat_field2)
                disp_per_chapter=true;
                continue
            end
            counter=counter+1;
            if disp_per_chapter
                %output for tic introduced in R2008b
                %t2=toc(t);
                t2=(now-t)*(24*60*60);
                f=counter/chapter_total;
                t_r=round((t2-f*t2)/f);
                if isinf(t_r) || f==0
                    ETA='##:##';
                else
                    try
                        ETA=datestr(addtodate(now,t_r,'second'),'HH:MM');
                    catch
                        %ML6.5 addtodate was probably added in ML7.0
                        ETA=datestr(now+(t_r/(24*60*60)),'HH:MM');
                    end
                end
                disp_status(sprintf(dict.ETA_chapter,padded_boek{boeknr},...
                    hoofdstuk,100*counter/chapter_total,ETA),handles.stat_field1)
            end
            filename=[htmlpath prefix2 '_' boek{boeknr} num2str(hoofdstuk) '.html'];
            if ~exist(filename,'file')
                if is_untested
                    missing_files=get_html(handles,htmlpath,boek,padded_boek,...
                        hoofdstukken,chapter_total,FullName,prefix,handles.bible);
                else
                    missing_files=get_html(handles,htmlpath,boek,padded_boek,...
                        hoofdstukken,chapter_total,FullName,prefix);
                end
            end
            data=read_html_file(filename,isOctave);
            
            switch prefix
                case 'BB'
                    ME=parse_file_BB...
                        (data,fid_db,boek,boeknr,hoofdstuk);
                case {'BGT','NBV2017'}
                    data=loadjson(data);
                    ME=parse_file_debijbelnl...
                        (data,fid_db,isOctave,boek,boeknr,hoofdstuk);
                case 'GNB'
                    ME=parse_file_GNB(data,fid_db,boeknr,hoofdstuk);
                case {'ASV','HB','KJV','LS1910','NASB','NBG51','RV1602',...
                        'SV1750','VULG','WEB'}
                    ME=parse_file_biblecom...
                        (data,fid_db,isOctave,boeknr,hoofdstuk);
                case 'HSV'
                    ME=parse_file_HSV...
                        (data,fid_db,isOctave,boek,boeknr,hoofdstuk);
                case 'NB2014'
                    idx=strfind(data,'<div class="pagination">');
                    if ~isempty(idx)
                        idx2=strfind(data,'<!-- #content -->');
                        data2=data(idx:(idx2-1));
                        idx3=strfind(data2,'/page/')+6;
                        pagelist=zeros(size(idx3));
                        for n=1:length(idx3)
                            pagelist(n)=str2double(data2(idx3(n)));
                        end
                        pagelist=1:max(pagelist);
                    else
                        pagelist=1;
                    end
                    for page=pagelist
                        if page~=1
                            filename=[htmlpath prefix '_' boek{boeknr} ...
                                num2str(hoofdstuk) char(64+page) '.html'];
                            if ~exist(filename,'file')
                                missing_files=get_html(handles,htmlpath,boek,padded_boek,...
                                    hoofdstukken,chapter_total,FullName,prefix);
                            end
                            data=read_html_file(filename,isOctave);
                        end
                        ME=parse_file_NB2014...
                            (data,fid_db,isOctave,boek,boeknr,hoofdstuk);
                    end
                case {'NWv2004','NWv2017'}
                    ME=parse_file_NWv...
                        (data,fid_db,isOctave,boek,boeknr,hoofdstuk,prefix);
                case 'SV73'
                    ME=parse_file_SV73...
                        (data,fid_db,isOctave,boek,boeknr,hoofdstuk);
                case {'SV1637','SV77'}
                    pattern='<table class="versionHeader" width="100%">';
                    idx=strfind(data,pattern);
                    data=data(idx(1):end);
                    pattern='<script language="javascript" type="text/javascript">';
                    idx=strfind(data,pattern);
                    data=data(1:(idx(end)-1));
                    pattern='<div id="transcrview2" class="transcrview"';
                    idx=strfind(data,pattern);
                    if strcmp(prefix,'SV1637')
                        data=data(1:(idx(end)-1));
                    else
                        data=data(idx(end):end);
                    end
                    ME=parse_file_SV1637_77...
                        (data,fid_db,isOctave,boek,boeknr);
                case 'WV75'
                    ME=parse_file_WV75...
                        (data,fid_db,boek,boeknr,hoofdstuk);
            end
            
            if ~isempty(ME)
                ME2=ME;
            elseif exist('missing_files','var') && missing_files~=0
                ME=struct('message','download of HTMLs failed');
                ME2=ME;
            end
        end
    end
    fclose(fid_db);
    if exist('ME2','var')
        warning(dict.possibleErrorInOutput1,ME2.message)
        disp_status(dict.possibleErrorInOutput2,handles.stat_field2)
    elseif get(handles.togglebutton1,'Value')
        %Canceled, don't disp a new status.
        disp_status('canceled',handles.stat_field2)
    else
        disp_status(handles.dict.startedCorrection,handles.stat_field1)
        get_correct_bible_file(handles,prefix);
        %output for tic introduced in R2008b
        toc_t=(now-t)*(24*60*60);
        disp_status(sprintf(dict.processComplete,...
            floor(toc_t/60),mod(toc_t,60)),handles.stat_field1)
        disp_status(' ',handles.stat_field2)
    end
    %reset color
    if handles.public_domain(ismember(handles.stringlist,prefix))==1
        col=[0 1 0];
    else
        %standard grey
        col=[0.94118 0.94118 0.94118];
    end
    set(hObject,'BackgroundColor',col)
    set(handles.togglebutton1,'Visible','off')
end
end
function Explain_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
handles=guidata(hObject);
msgbox(handles.dict.Explain_Callback,...
    handles.dict.helptext)
end
function bible_list_msgbox_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
handles=guidata(hObject);
if any(~handles.public_domain)
    translation_list=...
        [handles.dict.bible_list_msgbox_Callback__part1,...
        handles.dict.bible_list_msgbox_Callback__part2a,...
        handles.dict.bible_list_msgbox_Callback__part3];
else
    translation_list=...
        [handles.dict.bible_list_msgbox_Callback__part1,...
        handles.dict.bible_list_msgbox_Callback__part2b,...
        handles.dict.bible_list_msgbox_Callback__part3];
end
msgbox(translation_list,handles.dict.helptext)
end
function Change_folder_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
handles=guidata(hObject);
%Change current folder
place=uigetdir(handles.place);
if place==0,return,end%getdir canceled
if ~strcmp(place(end),filesep),place=[place filesep];end
handles.place=place;
set(handles.text4,'String',[handles.dict.currentDirectory ' ' place])

% Update handles structure
guidata(hObject, handles);
end
function read_first_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
handles=guidata(hObject);
msgbox([handles.dict.read_first_Callback handles.allow_all_filename],handles.dict.helptext)
end
function radiobutton_download_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
handles=guidata(hObject);
set(handles.radiobutton_download,'Value',1);
set(handles.radiobutton_process,'Value',0);
end
function radiobutton_process_Callback(hObject, ignore_var2, ignore_var3)%#ok ~ ML6.5
handles=guidata(hObject);
set(handles.radiobutton_download,'Value',0);
set(handles.radiobutton_process,'Value',1);
end
function disp_status(str,text_field_handle)
%This function was mainly used to enable easy switching between GUI and
%non-GUI mode during debugging.
if ~exist('text_field_handle','var') ...
        || text_field_handle==1 %enable dummy GUI mode
    strrep(str,'%','%%');
    fprintf('%s\n',str);
else
    %crop the displayed text
    units=get(text_field_handle,'Units');
    set(text_field_handle,'Units','characters');
    pos=get(text_field_handle,'Position');
    set(text_field_handle,'Units',units);
    cutoff=round(0.7*pos(3));
    %This factor (0.7) is different for Octave, but depends on the text, as
    %the fixed-width font is not used.
    if length(str)>cutoff,str((cutoff+1):end)='';end
    set(text_field_handle,'String',str);
    drawnow;
end
end
function get_correct_bible_file(handles,prefix)
if ~exist('prefix','var')
    prefix=handles.prefix;
end
filename=[handles.place filesep prefix '.bible'];
isOctave = exist('OCTAVE_VERSION', 'builtin') ~= 0;
set(handles.stat_field2,'String','Reading .bible file')
v=version;v=str2double(v(1:3));
%%--read current .bible file--%%
if ~isOctave && v>=7.2 %support for encoding added in R2006a
    fid=fopen(filename,'rt','n','UTF-8');
    data=textscan(fid,'%s','Delimiter','\n');
    fclose(fid);
    tmp=data{1};
else
    data = cell(0);
    fid = fopen (filename, 'r');
    i=0;
    while i==0 || ischar(data{i})
        i=i+1;
        data{i} = fgetl (fid);
    end
    fclose (fid);
    data = data(1:end-1);  % No EOL
    tmp=data;
end
%ismember can result in a memory error in ML6.5
%pos=find(ismember(tmp,'~~~~'));
pos=0;
while pos==0 || ~strcmp(tmp{pos},'~~~~')
    pos=pos+1;
end
header=tmp(1:pos);
tmp=tmp((pos+1):end);
bibles=cell(1,2);
bibles{1}=zeros(size(tmp));
bibles{2}=tmp;
for nVers=1:length(bibles{2})
    bibles{1}(nVers)=str2double(bibles{2}{nVers}([2:9 11]));
    bibles{2}{nVers}=bibles{2}{nVers}(15:(end-1));
end

%%--get changelist for this bible--%%
set(handles.stat_field2,'String','Applying changes')
[prevlist,nextlist,emptylist,summary,deletelist]=...
    get_correct_bible_file_helper(prefix);
if isempty(summary)
    summary=cell(0,2);
end
if ~isempty(prevlist)
    a=prevlist;
    b=repmat({'%prev%'},size(a'));
    summary(end+(1:size(b,1)),2)=b;
    summary(end+(1:size(b,1))-size(b,1),1)=num2cell(a);
end
if ~isempty(nextlist)
    a=nextlist;
    b=repmat({'%next%'},size(a'));
    summary(end+(1:size(b,1)),2)=b;
    summary(end+(1:size(b,1))-size(b,1),1)=num2cell(a);
end
if ~isempty(emptylist)
    a=emptylist;
    b=repmat({'%empty%'},size(a'));
    summary(end+(1:size(b,1)),2)=b;
    summary(end+(1:size(b,1))-size(b,1),1)=num2cell(a);
end

%%--delete verses that should be deleted--%%
for n=1:length(deletelist)
    idx=find(deletelist(n)==bibles{1});
    bibles{1}(idx)=[];
    bibles{2}(idx)=[];
end

%%--replace with correct version--%%
for n=1:size(summary,1)
    idx=find(summary{n,1}==bibles{1});
    if ~isempty(idx)
        %replace verse
        bibles{2}{idx}=summary{n,2};
    else
        %insert verse
        bibles{1}(end+1)=summary{n,1};
        bibles{2}{end+1}=summary{n,2};
        %sort
        [bibles{1},order]=sort(bibles{1});
        bibles{2}=bibles{2}(order);
    end
end

%%--write corrected .bible file--%%
set(handles.stat_field2,'String','Writing correction to file')
disp('Writing correction to file')
fid_db=fopen(filename,'wb');
for n=1:length(header)
    write_string(fid_db,sprintf('%s\n',header{n}))
end
for n=1:length(bibles{2})
    p=100*n/length(bibles{2});
    set(handles.stat_field2,'String',...
        sprintf('Writing correction to file (%02.0f%%)',p))
    str=sprintf('{%010.1f} {%s}\n',bibles{1}(n)/10,bibles{2}{n});
    write_string(fid_db,str)
end
fclose(fid_db);
if ispc && (isOctave || v<7.2)
    %support for encoding added in R2006a
    %The legacy/Octave method of writing out means that on Windows the
    %.bible file is encoded with ANSI, while all other methods will result
    %in a file encoded in UTF8. A vbs script can be used to convert this.
    %This next code block will write the vbs script to the current
    %directory (if missing), and run the conversion.
    if ~exist([handles.place filesep 'ANSItoUTF8.vbs'],'file')
        file_content={'Option Explicit',...
            '',...
            'Private Const adReadAll = -1',...
            'Private Const adSaveCreateOverWrite = 2',...
            'Private Const adTypeBinary = 1',...
            'Private Const adTypeText = 2',...
            'Private Const adWriteChar = 0',...
            '',...
            'Private Sub ANSItoUTF8(ByVal ANSIFName, ByVal UTF8FName)',...
            '  Dim strText',...
            '',...
            '  With CreateObject("ADODB.Stream")',...
            '    .Open',...
            '    .Type = adTypeBinary',...
            '    .LoadFromFile ANSIFName',...
            '    .Type = adTypeText',...
            '    .Charset = "iso-8859-1"',...
            '    strText = .ReadText(adReadAll)',...
            '    .Position = 0',...
            '    .SetEOS',...
            '    .Charset = "utf-8"',...
            '    .WriteText strText, adWriteChar',...
            '    .SaveToFile UTF8FName, adSaveCreateOverWrite',...
            '    .Close',...
            '  End With',...
            'End Sub',...
            '',...
            'ANSItoUTF8 WScript.Arguments(0), WScript.Arguments(1)'};
        fname=[pwd filesep 'ANSItoUTF8.vbs'];
        fid=fopen(fname,'wt');
        for n=1:length(file_content)
            fwrite(fid,[file_content{n} '\n']);
        end
        fclose(fid);
    end
    system(['"' handles.place filesep 'ANSItoUTF8.vbs" "' filename '" "' filename '"']);
end
end
function [prevlist,nextlist,emptylist,summary,deletelist]=...
    get_correct_bible_file_helper(prefix)
%This is not a full list, as for some translations some %prev% markings can
%be inferred from the html files.
prevlist.ASV=   [30160350 90200430 90230281 110220431 130120041 ...
    160080000 190530080 191330040 370020011 410090510 410100530 430010381 ...
    450070260 640010150];
prevlist.SV1750=[30160350 70050320 90200430 90230281 110220431 130120041 ...
    160080000 190230011 190530080 191330040 370020011 410090510 ...
    410100530 430010381 450070260 640010150];
nextlist.ASV=[40250190 660120180];
nextlist.SV1750=[40250190 660120180];
emptylist.ASV=[70050320 190230000 190970130 191130100 191140090 191270060 ...
    190540000 190540001 450140240:10:450140260];
emptylist.SV1750=[190970130 191130100 191140090 191270060 ...
    390040010:10:390040060 450140240:10:450140260];

prevlist.BB=[30160350 90220220 130120041 260460240 370020021 410090510 ...
    410100530 430010520 440190410 470130121 190130070 190230011 190530080 ...
    191330040 200010020 440010210];
prevlist.BGT=[30160350 70050320 90230281 160080021 230630191 370020011 ...
    410090510 410100530 430010381 440190410 450070260 470130121 190130070 ...
    190230011 190530080 191330040];
prevlist.HB=[20060021 70050320 90230281 130120041 160080011 410090510 ...
    410100530 430010381 440190410 450070260 470130121 190130070 190230011 ...
    190530080 191330040];
prevlist.HSV=[30160350 70050320 90230281 130120041 370020021 410090510 ...
    410100530 430190160 440190410 470130121 190130070 190510020 190520020 ...
    190530080 190540020 190600020 191330040 190230011];
prevlist.NB2014=[10350240 30160350 50050171 50050172 50050173 70050320 ...
    90230281 160080000 180310100 230160140 230630191 360010180 370020011 ...
    410090510 410100530 430010381 440190410 450070260 470130121 490030190 ...
    190130070 190230011 190530080 191330040];
prevlist.NBG51=[30160350 70050320 90230281 130120041 370020021 410090510 ...
    410100530 440190410 470130121 190130070 190230011 190530080 191330040];
prevlist.NBV2017=[30160350 70050320 90230281 160080000 190130070 190230011 ...
    190530080 191330040 230630191 370020011 410090510 410100530 430010381 ...
    440190410 450070260 470130121];
prevlist.NWv2004=[30160350 70050320 90200430 90230281 110220431 130120041 ...
    160080000 370020011 410090510 410100530 430010381 450070260 640010150 ...
    190530080 191330040 191400140];
prevlist.NWv2017=[30160350 70050320 90200430 90230281 110220431 130120041 ...
    160080000 370020011 410090510 410100530 430010381 450070260 640010150 ...
    190530080 191330040 191400140];
prevlist.SV1637=[30160350 70050320 90230281 130120041 370020021 410090510 ...
    410100530 440190410 470130121 190130070 190230011 190530080 191330040];
prevlist.SV73=[30160350 70050320 90230281 130120041 370020021 410090510 ...
    410100530 440190410 470130121 190130070 190230011 190530080 191330040];
prevlist.SV77=[30160350 70050320 90230281 130120041 370020021 410090510 ...
    410100530 440190410 470130121 190130070 190230011 190530080 191330040];
prevlist.WV75=[30160350 50020090 50110320 50150230 50190080:10000:50340080 ...
    50240220 70050320 70090570 90210151 90230281 120100360 130010540 ...
    130100130 160080011 230630191 240120170 260370280 370020011 410090510 ...
    410100530 430010381 440040370 440190410 450070260 470130121 190130070];
prevlist.KJV   =[30160350 70050320 90200430 90230281 110220431 130120041 ...
    160080000                               190530080 191330040 ...
    370020011 410090510 410100530 430010381           450070260 ...
    640010150 660120180];
prevlist.LS1910=[30160350 70050320          90230281           130120041 ...
    160080000 180340370 190130070 190230011 190530080 191330040 230630191 ...
    370020011                     430010381 440190410 450070260 470130121 ...
    ];
prevlist.RV1602=[30160350 70050320          90230281 110220431 130120041 ...
    160080000                     190230011 190530080 191330040 ...
    370020011 410090510 410100530 430010381           450070260 ...
    640010150 660120180];
prevlist.WEB   =[30160350 70050320 90200430 90230281 110220431 130120041 ...
    160080000                               190530080 191330040 ...
    370020011 410090510 410100530 430010381           450070260 ...
    640010150 660120180];
prevlist.GNB=[20070231 30160350 40140151 70050320 90210160 90230281 ...
    130060371 130120241 160080011 190230011 190530080 191330040 ...
    240400071 370020011 410090510 410100530 430010381 450070260 640010150];
prevlist.NASB  =[30160350 70050320 90200430 90230281 110220431 130120041 ...
    160080000                               190530080 191330040 ...
    370020011 410090510 410100530 430010381           450070260];

prevlist.RV1602=[prevlist.RV1602 11+190000000+10000*[3:9 12 13 18:22 30:31 34 ...
    36 38:42 44:49 51 51.0001 52 52.0001 53 54 54.0001 55:60 60.0001 61:65 ...
    67:70 75:77 80 81 83:85 88 89 92 102 108 140 142]];
prevlist.ASV=[prevlist.ASV 11+190000000+10000*[3:9 12 13 18:22 30:31 34 ...
    36 38:42 44:49 51 51.0001 52 52.0001 53            55:60 60.0001 61:65 ...
    67:70 75:77 80 81 83:85 88 89 92 102 108 140 142]];
prevlist.SV1750=[prevlist.SV1750 11+190000000+10000*[3:9 12 13 18:22 30:31 34 ...
    36 38:42 44:49 51 51.0001 52 52.0001 53 54 54.0001 55:60 60.0001 61:65 ...
    67:70 75:77 80 81 83:85 88 89 92 102 108 140 142]];
prevlist.GNB=[prevlist.GNB 11+190000000+10000*[3:9 12 13 18:22 30:31 34 ...
    36 38:42 44:49 51 51.0001 52 52.0001 53 54 54.0001 55:60 60.0001 61:65 ...
    67:70 75:77 80 81 83:85 88 89 92 102 108 140 142]];


nextlist.BB=[40250190 20300200];
nextlist.BGT=[];
nextlist.HB=40250190;
nextlist.HSV=40250190;
nextlist.NB2014=[];
nextlist.NBG51=40250190;
nextlist.NWv2004=[40250190 660120180];
nextlist.NWv2017=[40250190 660120180];
nextlist.SV1637=40250190;
nextlist.SV73=40250190;
nextlist.SV77=40250190;
nextlist.WV75=40250190;
nextlist.KJV   =40250190;
nextlist.LS1910=40250190;
nextlist.RV1602=40250190;
nextlist.WEB   =40250190;
nextlist.GNB   =430070530;
nextlist.NASB  =[40250190 660120180];

emptylist.BB=[                       190970130 191130100 191140090 ...
    191270060 450140240:10:450140260];
emptylist.BGT=[160070671 190970130 191130100 191140090 191270060 ...
    450140240:10:450140260];
emptylist.HB=[160070671                        190970130 191130100 ...
    191140090 191270060 450140240:10:450140260];
emptylist.HSV=[                       190970130 191130100 ...
    191140090 191270060 450140240:10:450140260];
emptylist.NB2014=[160070671 410090440 410090460 420170351 440240070 440280290 ...
    450140240:10:450140260];
emptylist.NBG51=[160070671                        190970130 191130100 ...
    191140090 191270060 450140240:10:450140260];
emptylist.NBV2017=[60210360 60210370 160070671 190970130 191130100 ...
    191140090 191270060 400170210 400180110 400230140 410070160 410090440 ...
    410090460 410110260 410150280 420170360 420230170 430050040 440080370 ...
    440150340 440240070 440280290 450160240 450140240:10:450140260];
emptylist.NWv2004=[                     190230000 190970130 191130100 191140090 ...
    191270060 190000000+...
    10000*[3:9 12 13 18:22 30:31 34 36 38:42 44:49 51 51.0001 52 52.0001 ...
    53 54 54.0001 55:60 60.0001 61:65 67:70 75:77 80 81 83:85 88 89 92 102 ...
    108 142] 450140240:10:450140260];
emptylist.NWv2017=[                       190970130 191130100 410160090:10:410160200 ...
    430070530 430080010:10:430080110 190230000 190970130 191140090 191270060 190000000+...
    10000*[3:9 12 13 18:22 30:31 34 36 38:42 44:49 51 51.0001 52 52.0001...
    53 54 54.0001 55:60 60.0001 61:65 67:70 75:77 80 81 83:85 88 89 92 102 ...
    108 142] 450140240:10:450140260];
emptylist.SV1637=[390040010:10:390040060 190970130 191130100 ...
    191140090 191191760 191270060 450140240:10:450140260];
emptylist.SV73=[                       190970130 191130100 ...
    191140090 191270060 450140240:10:450140260];
emptylist.SV77=[390040010:10:390040060 190970130 191130100 ...
    191140090 191270060 450140240:10:450140260];
emptylist.WV75=[60150220:10:60150400 160070671 420170351 190970130 191130100 ...
    191140090 191270060 410110260 450140240:10:450140260];
emptylist.KJV   =[                       190000000+10000*[3:9 12 13 18:22 ...
    30:31 34 36 38:42 44:49 51 51.0001 52 52.0001 53 54 54.0001 55:60 ...
    60.0001 61:65 67:70 75:77 80 81 83:85 88 89 92 102 108 140 142] ...
    190230000 190970130 191130100 191140090 191270060 450140240:10:450140260];
emptylist.LS1910=[                       190970130 191130100 191140090 ...
    191270060 450140240:10:450140260];
emptylist.RV1602=[                       90200430 190970130 191130100 ...
    191140090 191270060 450140240:10:450140260];
emptylist.WEB   =[                       190000000+10000*[3:9 12 13 18:22 ...
    30:31 34 36 38:42 44:49 51 51.0001 52 52.0001 53 54 54.0001 55:60 ...
    60.0001 61:65 67:70 75:77 80 81 83:85 88 89 92 102 108 140 142] ...
    190230000 190970130 191130100 191140090 191270060 450160260 450160270];
emptylist.GNB=[190970130 191130100 191140090 191270060 40290391 450140240 ...
    450140250 450140260];
emptylist.NASB=[190000000+...
    10000*[3:9 12 13 18:22 30:31 34 36 38:42 44:49 51 51.0001 52 52.0001 ...
    53 54 54.0001 55:60 60.0001 61:65 67:70 75:77 80 81 83:85 88 89 92 102 ...
    108 140 142] 450140240:10:450140260 190230000 190970130 191130100 191140090 ...
    191270060];

%The indicated verse will be replaced by the text entered here.
summary.BB={210060110,['6:11 Er zijn veel dingen die alles alleen maar ',...
    'zinlozer, triester en onbegrijpelijker maken. Wat heb je er dan aan?'];...
    500030060,['3:6 Wat betreft de Joodse wet: ik hield mij aan wat de ',...
    'Farizeeërs leerden. En omdat ik zo mijn best deed voor God, ',...
    'vervolgde ik de gemeente. Volgens de Joodse wet was ik volmaakt.'];...
    540030160,['3:16 Zonder twijfel is het dienen van God iets wat haast ',...
    'niet te begrijpen is: God is gekomen als een mens, door de Geest in ',...
    'het gelijk gesteld, aan de engelen verschenen, bekend gemaakt aan ',...
    'alle volken, door mensen over de hele wereld geloofd, naar de hemel ',...
    'gegaan en geëerd met hemelse macht en majesteit.']};
summary.BGT={410160080,['16:8 De vrouwen gingen het graf uit. Ze ',...
    'vluchtten weg, want ze waren vreselijk geschrokken. Ze vertelden ',...
    'niemand iets, omdat ze zo bang waren.'];...% remove [
    430070520,['7:52 Maar de anderen zeiden tegen hem: ''Kom jij soms ',...
    'ook uit Galilea, net als Jezus? Uit Galilea kan geen profeet komen. ',...
    'Kijk dat maar na in de heilige boeken.''']};% remove [
summary.GNB={010270330,['27:33 Toen schrok Isaak hevig. Hij zei: ''Wie ',...
    'is er dan op jacht geweest en heeft me een stuk wild gebracht? Net ',...
    'voor jij kwam, heb ik gegeten van alles wat hij me voorgezet heeft ',...
    'en heb ik hem mijn zegen gegeven. Die zegen kan hem niet meer ',...
    'ontnomen worden.'''];...
    020180230,['18:23 Als je het zo aanpakt - en als God het zo wil - ',...
    'kun je het zelf volhouden en gaan al deze mensen tevreden naar huis.'''];...
    020250140,'25:14 steek ze door de ringen om de kist te kunnen vervoeren.';...
    040070120,['7:12-83 Zij brachten hun geschenken in deze volgorde: ',...
    'Nachson, uit de stam Juda, bracht zijn offergave op de eerste dag; ',...
    'Netanel, uit de stam Issakar, kwam de tweede dag; Eliab, uit de ',...
    'stam Zebulon, de derde dag; Elisur, uit de stam Ruben, de vierde ',...
    'dag; Selumiël, uit de stam Simeon, de vijfde dag; Eljasaf, uit de ',...
    'stam Gad, de zesde dag; Elisama, uit de stam Efraïm, de zevende ',...
    'dag; Gamliël, uit de stam Manasse, de achtste dag; Abidan, uit de ',...
    'stam Benjamin, de negende dag; Achiëzer, uit de stam Dan, de tiende ',...
    'dag; Pagiël, uit de stam Aser, de elfde dag; Achira, uit de stam ',...
    'Naftali, de twaalfde dag. Zij brachten allen dezelfde geschenken: ',...
    'een zilveren schotel van dertienhonderd gram en een zilveren ',...
    'offerschaal van zevenhonderd gram, gewogen volgens de normen van ',...
    'het heiligdom; voor het meeloffer waren beide gevuld met het ',...
    'fijnste meel, waaraan olie was toegevoegd; een gouden schaaltje ',...
    'van honderd gram, vol wierook; verder voor het brandoffer een jonge ',...
    'stier, een ram en een eenjarig mannetjeslam, en voor het zondeoffer ',...
    'een geitenbok; tenslotte voor de heilige offermaaltijd twee stieren, ',...
    'vijf rammen, vijf geitenbokken en vijf eenjarige mannetjeslammeren.'];...
    040150080,['15:8 Bij een stier voor een brand- of vleesoffer, of voor ',...
    'een offer om aan de verplichtingen van een gelofte te voldoen, of ',...
    'voor een offer voor de heilige maaltijd,'];...
    050110250,['11:25 Niemand zal tegen je op kunnen. Overal in het land ',...
    'dat jullie betreden, zal de Heer angst en schrik verspreiden zoals ',...
    'hij heeft beloofd.'];...
    090220040,['22:4 Zo bracht hij hen onder bij de koning van Moab. Zij ',...
    'bleven bij hem zolang David zich in bergvestingen ophield.'];...
    090260120,['26:12 Zo haalde David de lans en de waterkruik aan Sauls ',...
    'hoofdeinde weg. Toen vertrokken ze. Niemand zag het, niemand merkte ',...
    'het, niemand werd wakker. Ze sliepen allemaal door, want de Heer had ',...
    'hen in een diepe slaap gebracht.'];...
    120180340,['18:34 Waar blijven nu de goden van Hamat en Arpad, de ',...
    'goden van Sefarwaïm, Henaen Iwwa? Hebben zij Samaria uit mijn greep ',...
    'kunnen bevrijden?'];...
    120180350,['18:35 Als er onder al de goden niet één is die zijn land ',...
    'heeft gered, zou de Heer dan Jeruzalem kunnen redden?'''];...
    120220120,['22:12 Hij gaf het volgende bevel aan de priester Chilkia, ',...
    'aan Safans zoon Achikam, aan Akbor, de zoon van Michaja, aan de ',...
    'schrijver Safan en aan zijn adjudant Asaja.'];...
    160060010,['6:1 Zodra Sanballat, Tobia, de Arabier Gesem en alle ',...
    'anderen die ons tegenwerkten, hoorden dat ik de muur voltooid had ',...
    'en er geen bressen meer in zaten - overigens had ik op dat ogenblik ',...
    'nog niet de deuren in de poorten aangebracht'];...
    190590010,['59:1 Voor de voorzanger. Op de wijs van het lied ''Jaag ',...
    'mij niet de dood in''. Een lied uit de bundel van David. David heeft ',...
    'dit lied gedicht toen Saul had bevolen het huis van David te ',...
    'omsingelen en hem te doden. God, bescherm me tegen mijn vijanden, ',...
    'bevrijd me van mijn tegenstanders.'];...
    190660190,['66:19 Maar hij hééft geluisterd, hij had aandacht voor ',...
    'mijn dringend gebed.'];...
    191191110,['119:111 Uw woorden zijn voor mij als een erfdeel, ik heb ',...
    'ze gekregen voor altijd, zij geven mij innige vreugde.'];...
    200240230,['24:23 Ook de volgende uitspraken zijn van wijze mannen. ',...
    'Wie in een rechtszaak partij trekt, is onrechtvaardig.'];...
    240140160,['14:16 En het volk aan wie zij dat allemaal verkondigen, ',...
    'zal ook de dood vinden. De straten van Jeruzalem zullen bezaaid ',...
    'liggen met lijken: mannen, vrouwen, kinderen, omgekomen in de oorlog ',...
    'of door honger. En niemand die hen begraaft. Ik zal hen de gevolgen ',...
    'van hun wandaden laten dragen.'];...
    240260090,['26:9 Hoe durf je namens de Heer te zeggen: Met deze ',...
    'tempel zal het zelfde gebeuren als met Silo; deze stad zal verwoest ',...
    'worden, niemand zal er meer wonen.'' Ook het volk kwam op mij af.'];...
    260210220,['21:22 In zijn rechterhand houdt hij de pijl die Jeruzalem ',...
    'aanwijst! Dat is de plaats die hij moet omsingelen, daar heft hij ',...
    'de strijdkreet aan, daar weerklinkt het krijgsgeschreeuw. Hij zal ',...
    'er stormrammen opstellen bij de poorten, wallen en ',...
    'belegeringstorens bouwen.'];...
    260220060,['22:6 Want wat gebeurt er al niet binnen je muren! De ',...
    'leiders van Israël zijn er stuk voor stuk op uit zoveel mogelijk ',...
    'bloed te vergieten.'];...
    260400330,['40:33 De wachtlokalen, de tussenmuren en de portiek waren ',...
    'even groot als die van de overige gebouwen. Er waren overal vensters ',...
    'aangebracht, ook in de voorhal. De totale lengte van het gebouw was ',...
    'vijftig el, de breedte vijfentwintig el.'];...
    270030220,['3:22 Nu was de oven op uitdrukkelijk bevel van de koning ',...
    'buitengewoon heet opgestookt. De vlammen laaiden zo hoog op dat de ',...
    'mannen die Sadrak, Mesak en Abednego naar boven brachten, zelf ',...
    'levend verbrandden.'];...
    380040050,['4:5-14 ''Weet je niet wat de betekenis hiervan is?'' zei ',...
    'de engel. ''Nee, mijn heer,'' antwoordde ik. Hij zei: ''Deze zeven ',...
    'lampen zijn de ogen van de Heer, waarmee hij waakt over de hele ',...
    'aarde.'' ''En wat betekenen de beide olijfbomen, rechts en links ',...
    'van de kandelaar?'' vroeg ik. En ik voegde eraan toe: ''Wat is de ',...
    'betekenis van die beide zijtakken van de olijfbomen waaruit ',...
    'goudkleurige olie stroomt door twee gouden buizen?'' ''Weet je dat ',...
    'niet?'' vroeg de engel me. ''Nee, mijn heer,'' antwoordde ik. Hij ',...
    'zei: ''Dat zijn de beide mannen die God met olie gezalfd heeft om ',...
    'hem, de Heer van de hele aarde, te dienen.'' Ook zei de engel tegen ',...
    'mij: ''Dit is de boodschap die de almachtige Heer richt tot ',...
    'Zerubbabel: Niet met geweld of brute kracht zal het gelukken, ',...
    'maar met hulp van mijn geest. Voor Zerubbabel verandert elke hoge ',...
    'berg in een vlakte. Hij zal de laatste steen aandragen en het volk ',...
    'zal roepen: Schitterend! Wat schitterend!'' De Heer richtte zich tot ',...
    'mij: ''Zerubbabel heeft de fundamenten van deze tempel gelegd, hij ',...
    'zal het werk ook afmaken.'' Als dat gebeurt zullen jullie inzien dat ',...
    'de almachtige Heer mij gestuurd heeft. Want wie in het begin elk ',...
    'vertrouwen in het werk misten, zullen juichen als ze het paslood ',...
    'zien in de handen van Zerubbabel!'];...
    400040160,['4:16 uw volk dat in duisternis leefde, heeft een groot ',...
    'licht gezien, en voor hen die in het donkere land van de dood ',...
    'woonden, is een licht opgegaan.'];...
    400050310,['5:31 Er is ook gezegd: Wie van zijn vrouw gaat scheiden, ',...
    'moet haar een scheidingsakte meegeven.'];...
    400110290,['11:29 Neem mijn juk op u en laat mij uw leermeester zijn, ',...
    'want ik ben zachtmoedig en eenvoudig. Bij mij zult u rust vinden.'];...
    400200150,['20:15 Mag ik met mijn geld niet doen wat ik wil? Of ben ',...
    'je afgunstig omdat ik goed ben?'];...
    410110130,['11:13 In de verte zag hij een vijgenboom in blad staan en ',...
    'hij ging kijken of er wat vijgen aan zaten. Maar toen hij bij de ',...
    'boom kwam, zag hij niets dan bladeren, want voor vijgen was het de ',...
    'tijd nog niet.'];...
    420120280,['12:28 Als God het gras zó kleedt, het gras dat er vandaag ',...
    'nog staat en morgen al in de oven wordt gegooid, hoe zal hij jullie ',...
    'dan wel niet kleden?! Jullie geloof is zo klein!'];...
    420210020,['21:2 maar hij zag ook een arme weduwe er twee koperen ',...
    'muntjes in gooien.'];...
    420210030,['21:3 En hij zei: ''Ik zeg jullie, die arme weduwe heeft ',...
    'er meer in gedaan dan al die anderen.'];...
    420210040,['21:4 Want allemaal hebben ze er iets ingegooid van hun ',...
    'rijkdom, maar zij van haar armoede: zij heeft alles wat ze had erin ',...
    'gegooid, alles waarvan ze moest leven.'''];...
    420210380,['21:38 En heel het volk kwam ''s ochtends vroeg al naar ',...
    'hem toe in de tempel, om hem te horen.'];...
    430160050,['16:5 ''Ik heb in het begin hierover niet met jullie ',...
    'gesproken, omdat ik bij jullie was. Maar nu ga ik naar hem die mij ',...
    'gezonden heeft. En niemand van jullie vraagt: Waar gaat u heen?'];...
    430200160,['20:16 ''Maria!'' zei Jezus tegen haar. Zij draaide zich ',...
    'om en zei in het Aramees: ''Rabboeni!'' Dat betekent: ''Meester!'''];...
    440240190,['24:19 Maar er waren daar enkele Joden uit Asia... Dié ',...
    'zouden eigenlijk hier voor u moeten staan om hun aanklacht in te ',...
    'dienen, als ze iets tegen mij aan willen voeren.'];...
    470050050,['5:5 Nu, daarop heeft God zelf ons voorbereid door ons de ',...
    'Geest als voorschot te geven.'];...
    480020060,['2:6 Maar degenen die voor de belangrijkste mensen ',...
    'doorgingen hoe belangrijk ze waren, interesseert me niet; God maakt ',...
    'geen onderscheid zij hebben me geen enkele verplichting opgelegd.'];...
    480060140,['6:14 Maar Ik - er is geen sprake van dat ik mij op iets ',...
    'anders beroem dan op het kruis van onze Heer Jezus Christus, ',...
    'waardoor de wereld voor mij is gekruisigd en ik voor de wereld ',...
    'gekruisigd ben.'];...
    530010100,['1:10 Het zal gebeuren op die grote dag, wanneer hij komt ',...
    'om de hulde in ontvangst te nemen van wie hem toebehoren, de ',...
    'eerbewijzen van allen die het geloof hebben aanvaard. Daar hoort u ',...
    'ook bij, want u hebt ons getuigenis aangenomen.'];...
    660210140,['21:14 De stadsmuur rustte op twaalf fundamenten, twaalf ',...
    'stenen, waarop de namen stonden van de twaalf apostelen van het Lam.']};
summary.HB={260380130,['38:13 Maar Seba en Dedan en de kooplieden van ',...
    'Tarsis met wie zij handeldrijven zullen vragen: ''Wie bent u dat u ',...
    'hen berooft van zilver en goud, hun vee meeneemt en hun goederen ',...
    'steelt, zodat zij arm achterblijven?''"'];...
    400090150,['9:15 ''Waarom zouden de bruiloftsgasten treuren, zolang ',...
    'de bruidegom bij hen is?'' antwoordde Jezus. ''Maar eens zal hij uit ',...
    'hun midden worden weggenomen, en dan zullen zij vasten.'];...
    400120200,['12:20 Hij zal het geknakte riet niet breken, de kwijnende ',...
    'vlam zal Hij niet doven, totdat Hij het recht zal doen overwinnen.'];...
    420060370,['6:37 Spreek geen oordeel uit, dan zal er over u ook geen ',...
    'oordeel uitgesproken worden. Veroordeel niemand, dan zult u ook niet ',...
    'veroordeeld worden. Vergeef en u zult vergeven worden.'];...
    420060380,['6:38 Geef en u zult iets terugkrijgen, meer dan ',...
    'overvloedig zult u ervoor terugkrijgen. Met de maat waarmee u meet, ',...
    'zult ook u gemeten worden.''']};
summary.HSV={240080010,['8:1 In die tijd, spreekt de HEERE, zullen zij ',...
    'de beenderen van de koningen van Juda, de beenderen van hun vorsten,',...
    ' de beenderen van de priesters, de beenderen van de profeten en de',...
    ' beenderen van de inwoners van Jeruzalem uit hun graven halen,'];...
    270110010,['11:1 En ik, ik stond in het eerste jaar van Darius, de',...
    ' Medi' char(235) 'r, hem terzijde als steun en toeverlaat.']};
summary.NB2014={010410500,['41:50 Aan Jozef zijn gebaard een tweetal ',...
    'zonen, voordat het jaar van de honger kwam; die heeft Asnat hem ',...
    'gebaard, de dochter van Poti Fera, de priester van On.'];...
    260480350,['48:35 in het rond is het achttienmaal een duizendtal,- ',...
    'en de naam van de stad is vanaf vandaag: de-Ene-is-daar!']};
summary.NBG51={050270230,['27:23 Vervloekt is hij, die gemeenschap heeft ',...
    'met zijn schoonmoeder. En het gehele volk zal zeggen: Amen.']};
summary.NWv2004={020110010,['11:1 Voorts zei Jehovah tot Mozes: Nog één ',...
    'plaag zal ik over Farao en Egypte brengen. Daarna zal hij U van hier ',...
    'heenzenden. Wanneer hij U geheel en al heenzendt, zal hij U ',...
    'letterlijk van hier wegdríjven.']};
summary.NWv2017={200250160,['25:16 Als je honing vindt, eet dan alleen ',...
    'wat je nodig hebt, want als je te veel neemt, braak je het ',...
    'misschien weer uit.']};
summary.SV1637={020350240,['35:24 Alle die een hef-offer van silver ofte ',...
    'koper offerde, die brachten t ten hefoffer des HEEREN: ende alle ',...
    'by welcke Sittim-hout gevonden wert, brachten t tot allen werck ',...
    'des diensts.'];...
    030110470,['11:47 Om te onderscheyden tusschen het onreyne, ende ',...
    'tusschen het reyne: ende tusschen het gedierte datmen eten, ende ',...
    'tusschen het gedierte, datmen niet eten en sal.'];...
    060020240,['2:24 Ende sy seyden tot Iosua, Sekerlick de HEERE heeft ',...
    'dat gantsche lant in onse handen gegeven: want oock alle de ',...
    'inwoonders des lants voor onse aengesichten gesmolten zijn.'];...
    150050170,['5:17 So het dan nu den Coninck goet dunckt, laetter ',...
    'gesocht worden in den Schat-huyse des Conincks aldaer, dat te Babel ',...
    'is, of het zy, dat een bevel van den Coninck Cores gegeven zy, om ',...
    'dit Huys Godts te Ierusalem te bouwen: ende datmen des Conincks ',...
    'believen hier van tot ons sende.'];...
    191460100,['146:10 De HEERE sal in eeuwicheyt regeren: uw Godt, o ',...
    'Zion, is van geslachte tot geslachte. Halelu-Iah.'];...
    450140230,['14:23 Maer die twijfelt, indien hy eet, is veroordeelt, ',...
    'om dat hy niet uyt den geloove [en eet]: ende al wat uyt den geloove ',...
    'niet en is, dat is sonde.'];...
    580070280,['7:28 Want de Wet stelt tot Hooge-priesters menschen die ',...
    'swackheyt hebben: maer het woordt der eedt-sweeringe, die na de Wet ',...
    'is [gevolght, stelt] den Sone, die in der eeuwicheyt geheylight is.']};
summary.SV1750={050160030,['16:3 Gij zult niets gedesemds op hetzelve ',...
    'eten; zeven dagen zult gij ongezuurde broden op hetzelve eten, een ',...
    'brood der ellende, (want in der haast zijt gij uit Egypteland ',...
    'uitgetogen); opdat gij gedenkt aan den dag van uw uittrekken uit ',...
    'Egypteland, al de dagen uws levens.'];...
    090060080,['6:8 Neemt dan de ark des HEEREN, en zet ze op den wagen, ',...
    'en legt de gouden kleinoden, die gij Hem ten schuldoffer vergelden ',...
    'zult, in een koffertje aan haar zijde; en zendt ze weg, dat zij heenga.'];...
    100140190,['14:19 En de koning zeide: Is Joabs hand met u in dit ',...
    'alles? En de vrouw antwoordde en zeide: Zo waarachtig als uw ziel ',...
    'leeft, mijn heer koning, indien iemand ter rechter- of ter ',...
    'linkerhand zou kunnen afwijken van alles, wat mijn heer de koning ',...
    'gesproken heeft; want uw knecht Joab heeft het mij geboden, en die ',...
    'heeft al deze woorden in den mond uwer dienstmaagd gelegd;'];...
    200310010,['31:1 De woorden van den koning Lemuel; de last, waarmede ',...
    'zijn moeder hem onderwees.'];...
    380060010,['6:1 En ik hief mijn ogen weder op, en ik zag; en ziet, ',...
    'vier wagens gingen er uit van tussen twee bergen, en die bergen ',...
    'waren bergen van koper.'];...
    400130080,['13:8 En een ander deel viel in de goede aarde, en gaf ',...
    'vrucht, het een honderd-, het ander zestig-, en het ander dertigvoud.'];...
    400130230,['13:23 Die nu in de goede aarde bezaaid is, deze is ',...
    'degene, die het Woord hoort en verstaat, die ook vrucht draagt ',...
    'en voortbrengt, de een honderd-, de ander zestig-, en de ander ',...
    'dertigvoud.'];...
    420180400,['18:40 En Jezus, stil staande, beval, dat men denzelven tot ',...
    'Hem brengen zou; en als hij nabij Hem gekomen was, vraagde Hij hem,'];...
    430180280,['18:28 Zij dan leidden Jezus van Kajafas in het rechthuis. ',...
    'En het was ''s morgens vroeg; en zij gingen niet in het rechthuis, ',...
    'opdat zij niet verontreinigd zouden worden, maar opdat zij het ',...
    'pascha eten mochten.']};
summary.SV73={320040010,['4:1 Dat verdroot Jona met groot verdriet, ',...
    'en zijn toorn ontstak.'];...
    390040010,['4:1 WANT zie, die dag komt, brandende als een oven; dan ',...
    'zullen alle hoogmoedigen en al wie goddeloosheid doet, een stoppel ',...
    'zijn, en de toekomstige dag zal hen in vlam zetten, zegt de HEERE ',...
    'der heirscharen, Die hun noch wortel noch tak laten zal.']};
summary.SV77={020320010,['32:1 Toen het volk zag, dat Mozes vertoefde van ',...
    'de berg af te komen, zo verzamelde zich het volk tot Aäron, en zij ',...
    'zeiden tot hem: Sta op, maak ons goden, die voor ons aangezicht ',...
    'gaan, want deze Mozes, die man, die ons uit Egypteland uitgevoerd ',...
    'heeft, wij weten niet, wat hem geschied is.'];...
    170090060,['9:6 En in de burg Susan hebben de Joden gedood en ',...
    'omgebracht vijfhonderd mannen.'];...
    240150210,['15:21 Ja, Ik zal u rukken uit de hand der bozen, en Ik ',...
    'zal u verlossen uit de handpalm der tirannen.'];...
    260140050,['14:5 Opdat Ik het huis Israëls in hun hart grijpe, daar ',...
    'zij allen door hun drekgoden van Mij vervreemd zijn.']};
summary.WV75={010100320,['10:32 Dat zijn de families van de zonen van ',...
    'Noach, volgens hun geslachten; van hen stammen de volken af, die ',...
    'zich na de vloed over de aarde verspreid hebben.'];...
    010110320,['11:32 Heel de levensduur van Terach bedroeg ',...
    'tweehonderdvijf jaar. Toen stierf Terach in Haran.'];...
    010120030,['12:3 Ik zal zegenen die u zegenen, maar die u versmaadt ',...
    'zal Ik vervloeken. Door u zal zegen komen over alle geslachten ',...
    'op aarde.'''];...
    010120070,['12:7 Daar verscheen Jahwe aan Abram en zei: `Aan uw ',...
    'nageslacht zal Ik dit land in bezit geven.'' Toen richtte hij daar ',...
    'een altaar op ter ere van Jahwe, die hem verschenen was.'];...
    010160160,['16:16 Abram was zesentachtig jaar, toen Hagar hem ',...
    'Ismaël baarde.'];...
    010210200,['21:20 En God beschermde de jongen. Toen hij groot was ',...
    'geworden, leefde hij in de woestijn en werd een ervaren boogschutter.'];...
    010270360,['27:36 Toen zei Esau: `Terecht heet hij Jakob, want hij ',...
    'heeft mij nu al tweemaal bedrogen. Eerst heeft hij zich mijn ',...
    'eerstgeboorterecht toegeeigend en nu bovendien nog mijn zegen.'' ',...
    'En hij drong aan: `Hebt u dan voor mij geen zegen meer?'''];...
    010310390,['31:39 Wat door wilde dieren verscheurd was, heb ik niet ',...
    'bij u gebracht, maar ik heb het zelf vergoed. Uit mijn eigen bezit ',...
    'hebt u teruggeeist wat mij overdag of ''s nachts ontstolen werd.'];...
    010410180,['41:18 en zag zeven koeien, welige, mooie dieren, uit de ',...
    'Nijl omhoog komen. Zij gingen grazen in het oevergras.'];...
    010430340,['43:34 Men gaf hun van de gerechten die op Jozefs tafel ',...
    'stonden, maar de portie van Benjamin was vijfmaal zo groot als die ',...
    'van de anderen. Zij dronken met hem en werden vrolijk.'];...
    020070040,['7:4 Farao zal niet naar u luisteren, maar dan zal Ik ',...
    'Egypte mijn kracht laten voelen, en mijn legers, het volk van de ',...
    'Israëlieten, wegleiden uit Egypte, dat Ik zwaar zal straffen.'];...
    020100200,['10:20 Maar Jahwe maakte Farao halsstarrig: Hij liet de ',...
    'Israëlieten niet gaan.'];...
    020120360,['12:36 Jahwe stemde de Egyptenaren gunstig ten opzichte ',...
    'van het volk zodat zij deze dingen afstonden. Zo beroofden de ',...
    'Israëlieten Egypte.'];...
    020130190,['13:19 Mozes nam het gebeente van Jozef mee. Deze had de ',...
    'Israëlieten immers plechtig laten beloven dat te doen, toen hij ',...
    'zei: `Jahwe zal zeker eens genadig op u neerzien; neem dan mijn ',...
    'gebeente met u mee.'''];...
    020140090,['14:9 Met alle paarden en wagens van Farao, met zijn ',...
    'wagenmenners en zijn legermacht, zetten de Egyptenaren de ',...
    'achtervolging in. Zij haalden de Israëlieten in terwijl zij ',...
    'gelegerd waren aan zee, bij Pi-hachirot, voor Baäl-sefon.'];...
    020140230,['14:23 De Egyptenaren zetten de achtervolging in; alle ',...
    'paarden van Farao, zijn wagens en zijn wagenmenners gingen achter ',...
    'de Israëlieten aan de zee in.'];...
    020180130,['18:13 De volgende dag hield Mozes rechtszitting. ',...
    'Van ''s morgens tot ''s avonds stonden er mensen om hem heen.'];...
    020180140,['18:14 Toen zijn schoonvader zag hoeveel werk het volk hem ',...
    'bezorgde zei hij: `Is het nodig dat deze mensen je zo in beslag ',...
    'nemen? Waarom hou je alleen zitting terwijl de mensen zich van ''s ',...
    'morgens tot ''s avonds om je verdringen?'''];...
    020200220,['20:22 Toen sprak Jahwe tot Mozes: `Zeg de Israëlieten het ',...
    'volgende: Gij hebt gezien hoe Ik vanuit de hemel tot u gesproken heb.'];
    020290390,'29:39 het een ''s morgens, het ander tegen de avond.';...
    020290410,['29:41 Het tweede lam moet ge offeren tegen de avond, met ',...
    'hetzelfde meel - en plengoffer als ''s morgens. Het is een geurige ',...
    'gave die Jahwe behaagt,'];...
    020400380,['40:38 Op heel hun tocht rustte overdag de wolk van Jahwe ',...
    'boven de woning, maar ''s nachts was er een vuurgloed, die zichtbaar ',...
    'was voor alle Israëlieten.'];...
    050230230,['23:23 Als ge geen geloften aflegt, rust er geen schuld op ',...
    'u; maar als ge eenmaal iets beloofd hebt, moet ge die belofte ook ',...
    'nakomen en volbrengen,'];...
    050340090,['34:9 Jozua, zoon van Nun, was van de geest van wijsheid ',...
    'vervuld, sinds Mozes hem de handen had opgelegd, en de Israëlieten ',...
    'gehoorzaamden hem en deden wat Jahwe aan Mozes had opgedragen;'];...
    060040040,['4:4 Daarop riep Jozua de twaalf mannen die hij uit de ',...
    'Israëlieten had laten aanwijzen bijeen, een uit iedere stam,'];...
    060110140,['11:14 De hele buit van die steden en het vee hebben de ',...
    'Israëlieten voor hun eigen gebruik gehouden, maar alle mensen hebben ',...
    'zij over de kling gejaagd en vernietigd, zodat er geen sterveling ',...
    'overbleef.'];...
    090260020,['26:2 Toen begaf Saul zich met drieduizend uitgelezen ',...
    'Israëlieten op weg naar de woestijn van Zif om David daar te zoeken.'];...
    120080120,['8:12 Hazaël vroeg: `Waarom schreit u, mijn heer?'' Hij ',...
    'antwoordde: `Omdat ik zie hoeveel kwaad u de Israëlieten zult ',...
    'aandoen; hun vestingen zult u in brand steken, hun jonge mannen ',...
    'doden met het zwaard, hun zuigelingen zult u te pletter slaan en ',...
    'hun zwangere vrouwen openrijten.'''];...
    440160090,['16:9 Daar had Paulus s nachts een visioen; er stond een ',...
    'Macedoniër voor hem die hem smeekte: Steek over naar Macedonië en ',...
    'kom ons te hulp.']};
summary.WEB={450160250,['(TR places Romans 14:24-26 at the end of Romans',...
    ' instead of at the end of chapter 14, and numbers these verses 16:25-27.)']};

deletelist.WV75=[170100040:10:170100130 41011026];
deletelist.BB=[20300200 200010020 440010210];

if isfield(prevlist  ,prefix),prevlist  =  prevlist.(prefix);else,prevlist=[];end
if isfield(nextlist  ,prefix),nextlist  =  nextlist.(prefix);else,nextlist=[];end
if isfield(emptylist ,prefix),emptylist = emptylist.(prefix);else,emptylist=[];end
if isfield(summary   ,prefix),summary   =   summary.(prefix);else,summary=[];end
if isfield(deletelist,prefix),deletelist=deletelist.(prefix);else,deletelist=[];end
end
function missing_files=get_html(handles,htmlpath,boek,padded_boek,...
    hoofdstukken,chapter_total,FullName,prefix,bible)
disp_per_chapter=false;%will be set to true when a file is missing
missing_files=0;
if ~exist(htmlpath,'dir')
    %    if ~exist(fileparts(htmlpath(1:end-1)),'dir')
    %        %create the HTMLs folder
    %        [newpath_root,newpath_folder]=(fileparts(htmlpath(1:end-1)));
    %        newpath_root=strrep(newpath_root,[filesep filesep],filesep);
    %        mkdir(newpath_root,newpath_folder);
    %    end
    if strcmp(htmlpath(end),filesep)
        [newpath_root,newpath_folder]=fileparts(htmlpath(1:end-1));
    else
        [newpath_root,newpath_folder]=fileparts(htmlpath);
    end
    newpath_root=strrep(newpath_root,[filesep filesep],filesep);
    mkdir(newpath_root,newpath_folder);
end
list2={'GEN' '50';'EXO' '40';'LEV' '27';'NUM' '36';...
    'DEU' '34';'JOS' '24';'JDG' '21';'RUT' '4';...
    '1SA' '31';'2SA' '24';'1KI' '22';'2KI' '25';...
    '1CH' '29';'2CH' '36';'EZR' '10';'NEH' '13';...
    'EST' '10';'JOB' '42';'PSA' '150';'PRO' '31';...
    'ECC' '12';'SNG' '8';'ISA' '66';'JER' '52';...
    'LAM' '5';'EZK' '48';'DAN' '12';'HOS' '14';...
    'JOL' '4';'AMO' '9';'OBA' '1';'JON' '4';'MIC' '7';...
    'NAM' '3';'HAB' '3';'ZEP' '3';'HAG' '2';...
    'ZEC' '14';'MAL' '3';'MAT' '28';'MRK' '16';...
    'LUK' '24';'JHN' '21';'ACT' '28';'ROM' '16';...
    '1CO' '16';'2CO' '13';'GAL' '6';'EPH' '6';...
    'PHP' '4';'COL' '4';'1TH' '5';...
    '2TH' '3';'1TI' '6';'2TI' '4';'TIT' '3';...
    'PHM' '1';'HEB' '13';'JAS' '5';'1PE' '5';...
    '2PE' '3';'1JN' '5';'2JN' '1';'3JN' '1';...
    'JUD' '1';'REV' '22'};
list3={'genesis';'exodus';'leviticus';'numeri';'deuteronomium';'jozua';...
    'richteren';'ruth';'1samuel';'2samuel';'1koningen';'2koningen';...
    '1kronieken';'2kronieken';'ezra';'nehemia';'esther';'job';'psalmen';...
    'spreuken';'prediker';'hooglied';'jesaja';'jeremia';'klaagliederen';...
    'ezechiel';'daniel';'hosea';'joel';'amos';'obadja';'jona';'micha';...
    'nahum';'habakuk';'zefanja';'haggai';'zacharia';'maleachi';...
    'mattheus';'markus';'lukas';'johannes';'handelingen';'romeinen';...
    '1korinthe';'2korinthe';'galaten';'efeziers';'filippenzen';...
    'kolossenzen';'1thessalonicenzen';'2thessalonicenzen';'1timotheus';...
    '2timotheus';'titus';'filemon';'hebreeen';'jakobus';'1petrus';...
    '2petrus';'1johannes';'2johannes';'3johannes';'judas';'openbaring'};

bible_dot_com_element=ismember({'WEB','KJV','RV1602','LS1910','ASV',...
    'SV1750','VULG','NASB'},prefix);
if any(bible_dot_com_element)
    biblecom_code1=[206 1 147 93 12 165 823 100];
    biblecom_code2={'web','kjv','rves','lsg','asv','sv1750','vulg','nasb'};
    biblecom_code1=biblecom_code1(bible_dot_com_element);
    biblecom_code2=biblecom_code2{bible_dot_com_element};
end
if exist('bible','var')
    pos=get(handles.biblecom_untested,'Value');
    biblecom_code1=bible.com.codelist(pos);
    biblecom_code2=lower(bible.com.ShortName{pos});
    prefix='biblecom_untested';
end
if strcmp(prefix,'NB2014')
    order=[1:7 9:12 23 24 26 28:39 19 20 18 22 8 25 21 17 27 15 16 13 14 40:66];
    boek=boek(order);hoofdstukken=hoofdstukken(order);
end

switch prefix
    case {'SV1637','SV77'}
        missing_files=get_html_SV1637_77(handles);
        return
    case 'WV75'
        missing_files=get_html_WV75(handles);
        return
end

counter=0;already_downloaded=-1;
%t=tic;%output for tic introduced in R2008b
t=now;
disp_status(sprintf(handles.dict.startedDownload,FullName),handles.stat_field2)
for boeknr=1:66
    if ~disp_per_chapter
        %t2=toc(t);
        t2=(now-t)*(24*60*60);
        f=(counter-already_downloaded)/(chapter_total-already_downloaded);
        t_r=round((t2-f*t2)/f);
        if isinf(t_r) || f==0
            ETA='##:##:##';
        else
            try
                ETA=datestr(addtodate(now,t_r,'second'),'HH:MM:SS');
            catch
                %ML6.5 addtodate was probably added in ML7.0
                ETA=datestr(now+(t_r/(24*60*60)),'HH:MM:SS');
            end
        end
        disp_status(sprintf(handles.dict.ETA_book,...
            padded_boek{boeknr},100*f,ETA),handles.stat_field1)
    end
    for hoofdstuk=1:round(str2double(hoofdstukken{boeknr}))
        if get(handles.togglebutton1,'Value')
            disp_status(sprintf(handles.dict.interruptedDownload,FullName),...
                handles.stat_field2)
            disp_per_chapter=true;
            continue
        end
        filename=[htmlpath prefix '_' boek{boeknr} ...
            num2str(hoofdstuk) '.html'];
        counter=counter+1;
        if disp_per_chapter
            %output for tic introduced in R2008b
            %t2=toc(t);
            t2=(now-t)*(24*60*60);
            f=(counter-already_downloaded)/(chapter_total-already_downloaded);
            t_r=round((t2-f*t2)/f);
            if isinf(t_r) || f==0
                ETA='##:##';
            else
                try
                    ETA=datestr(addtodate(now,t_r,'second'),'HH:MM');
                catch
                    %ML6.5 addtodate was probably added in ML7.0
                    ETA=datestr(now+(t_r/(24*60*60)),'HH:MM');
                end
            end
            disp_status(sprintf(handles.dict.ETA_chapter,...
                padded_boek{boeknr},hoofdstuk,100*counter/chapter_total,...
                ETA),handles.stat_field1)
        end
        if ~exist(filename,'file')
            disp_per_chapter=true;
            %Malachi 4 was numbered as the end of chapter 3 in the
            %translation I used to determine the chapter count. This
            %translation does have Joel 4, but that triggered a download
            %error, which is how I found out.
            mal4_date_part='201802';
            switch prefix
                case 'biblecom_untested'
                    date_part='2';%just get the latest capture
                    mal4_date_part='2';%just get the latest capture
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'ASV'
                    date_part='201710';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'BB'
                    date_part='2017071';%date of capture to archive.org
                    boek_url=boek{boeknr};
                    if strcmp(boek_url,'RECHTERS'),boek_url='RICHTERS';end
                    if strcmp(boek_url,'ESTHER'),boek_url='ESTER';end
                    if strcmp(boek_url,'JOEL'),boek_url='JO__L';end
                    if strcmp(boek_url,'EZECHIEL'),boek_url='EZECHI__L';end
                    if strcmp(boek_url,'DANIEL'),boek_url='DANI__L';end
                    if strcmp(boek_url,'SEFANJA'),boek_url='ZEFANJA';end
                    if strcmp(boek_url,'HAGGAI'),boek_url='HAGGA__';end
                    if strcmp(boek_url,'MATTEUS'),boek_url='MATTE__S';end
                    if strcmp(boek_url,'MARCUS'),boek_url='MARKUS';end
                    if strcmp(boek_url,'LUCAS'),boek_url='LUKAS';end
                    if strcmp(boek_url,'1KORINTIERS'),boek_url='1KORINTI__RS';end
                    if strcmp(boek_url,'2KORINTIERS'),boek_url='2KORINTI__RS';end
                    if strcmp(boek_url,'EFEZIERS'),boek_url='EFEZI__RS';end
                    if strcmp(boek_url,'1TIMOTEUS'),boek_url='1TIMOTE__S';end
                    if strcmp(boek_url,'2TIMOTEUS'),boek_url='2TIMOTE__S';end
                    if strcmp(boek_url,'HEBREEEN'),boek_url='HEBREE__N';end
                    if isstrprop(boek_url(1),'digit')
                        boek_url=[boek_url(1) '_' boek_url(2:end)];
                    end
                    url_part=strcat('https://www.basisbijbel.nl/boek/',...
                        lower(boek_url),'/',num2str(hoofdstuk));
                case 'BGT'
                    date_part='2017080';%date of capture to archive.org
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.debijbel.nl/api/bible',...
                        '/passage?identifier=',boek_url,num2str(hoofdstuk),...
                        '&language=nl&version=nld-BGT');
                case 'GNB'
                    boek_url=lower(list2{boeknr,1});
                    date_part='2018031';%date of capture to archive.org
                    mal4_date_part='2018031';
                    url_part=strcat('http://grootnieuwsbijbel.wordpress.com/',...
                        boek_url,num2str(hoofdstuk));
                case 'HB'
                    boek_url=list2{boeknr,1};
                    date_part='2017080';%date of capture to archive.org
                    url_part=strcat('https://www.bible.com/nl/bible/75/',...
                        boek_url,'.',num2str(hoofdstuk),'.htb');
                case 'HSV'
                    date_part='2017080';%date of capture to archive.org
                    boek_url=list3{boeknr};
                    url_part=strcat('https://herzienestatenvertaling.nl/',...
                        'teksten/',boek_url,'/',num2str(hoofdstuk),'/');
                case 'KJV'
                    date_part='201709';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'LS1910'
                    date_part='201709';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'NASB'
                    date_part='201804';
                    mal4_date_part=date_part;
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'NB2014'
                    date_part='2017073';%date of capture to archive.org
                    page=1;
                    url_part=strcat('http://www.naardensebijbel.nl/page/',...
                        num2str(page),'/?search-class=DB_CustomSearch_',...
                        'Widget-db_customsearch_widget&widget_number=p',...
                        'reset-default&-0=vers&cs-booknr-1=',...
                        num2str(boeknr),'&cs-bijbelhoofdstuk-2=',...
                        num2str(hoofdstuk),'&cs-versnummer-3=&cs-bijbel',...
                        'vers_v2-4=&search=Zoeken');
                    outfilename=WBM(filename,url_part,...
                        struct('date_part',date_part));
                    data=read_html_file(outfilename,isOctave);
                    idx=strfind(data,'<div class="pagination">');
                    if ~isempty(idx)
                        idx2=strfind(data,'<!-- #content -->');
                        data2=data(idx:(idx2-1));
                        idx3=strfind(data2,'/page/')+6;
                        pagelist=zeros(size(idx3));
                        for n=1:length(idx3)
                            pagelist(n)=str2double(data2(idx3(n)));
                        end
                        pagelist=1:max(pagelist);
                    else
                        pagelist=1;
                    end
                    for page=pagelist
                        if page==1,continue,end
                        filename=[htmlpath prefix '_' boek{boeknr} ...
                            num2str(hoofdstuk) char(64+page) '.html'];
                        if ~exist([filename '.html'],'file')
                            disp_per_chapter=true;
                            url_part=strcat('http://www.naardensebijbel',...
                                '.nl/page/',num2str(page),'/?search-cl',...
                                'ass=DB_CustomSearch_Widget-db_customs',...
                                'earch_widget&widget_number=preset-def',...
                                'ault&-0=vers&cs-booknr-1=',...
                                num2str(boeknr),'&cs-bijbelhoofdstuk-2=',...
                                num2str(hoofdstuk),'&cs-versnummer-3=&',...
                                'cs-bijbelvers_v2-4=&search=Zoeken');
                            ignore_var=WBM(filename,url_part,...
                                struct('date_part',date_part));%#ok ~ ML6.5
                        end
                    end
                    continue
                case 'NBG51'
                    date_part='2017080';%date of capture to archive.org
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/nl/bible/328/',...
                        boek_url,'.',num2str(hoofdstuk),'.nbg51');
                case 'NBV2017'
                    date_part='201709';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.debijbel.nl/api/bible/',...
                        'passage?identifier=',boek_url,...
                        num2str(hoofdstuk),'&language=nl&version',...
                        '=nld-NBV');
                case 'NWv2004'
                    date_part='20170728';%date of capture to archive.org
                    boek_url=boek{boeknr};
                    url_part=strcat('http://www.jw.org/nl/publicaties/',...
                        'bijbel/bi12/boeken/',boek_url,'/',...
                        num2str(hoofdstuk),'/');
                case 'NWv2017'
                    date_part='2017060';%date of capture to archive.org
                    %backup to account for the missing capture of jona 4:
                    date_part2=date_part;
                    boek_url=boek{boeknr};
                    if strcmp(boek_url,'SEFANJA'),boek_url='ZEFANJA';end
                    if strcmp(boek_url,'PSALMEN'),boek_url='psalmen';end
                    if strcmp(boek_url,'MATTEUS'),boek_url='Mattheus';end
                    if strcmp(boek_url,'MARCUS'),boek_url='MARKUS';end
                    if strcmp(boek_url,'LUCAS'),boek_url='LUKAS';end
                    if strcmp(boek_url,'1KORINTIERS'),boek_url='1KORINTHIERS';end
                    if strcmp(boek_url,'2KORINTIERS'),boek_url='2Korinthiers';end
                    if strcmp(boek_url,'1TIMOTEUS'),boek_url='1TIMOTHEUS';end
                    if strcmp(boek_url,'2TIMOTEUS'),boek_url='2TIMOTHEUS';end
                    if strcmp(boek_url,'1TESSALONICENZEN')
                        boek_url='1THESSALONICENZEN';
                    end
                    if strcmp(boek_url,'2TESSALONICENZEN')
                        boek_url='2THESSALONICENZEN';
                    end
                    if isstrprop(boek_url(1),'digit')
                        boek_url=[boek_url(1) '-' boek_url(2:end)];
                    end
                    if strcmp(date_part,date_part2)
                        date_part=date_part2;%restore to default
                    end
                    if strcmp(boek_url,'JONA')&&hoofdstuk==4
                        date_part='201707';
                    end
                    url_part=strcat('http://www.jw.org/nl/publicaties/',...
                        'bijbel/nwt/boeken/',boek_url,'/',...
                        num2str(hoofdstuk),'/');
                case 'RV1602'
                    date_part='201709';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'SV73'
                    date_part='20150929';%date of capture to archive.org
                    url_part=strcat('http://statenvertaling.nl/tekst.php',...
                        '?bb=',num2str(boeknr),'&hf=',num2str(hoofdstuk),...
                        '&ind=3');
                case {'SV77','SV1637'}
                    %won't happen
                    continue
                case 'SV1750'
                    date_part='201710';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'VULG'
                    date_part='201710';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                case 'WV75'
                    %won't happen
                    continue
                case 'WEB'
                    date_part='201709';
                    boek_url=list2{boeknr,1};
                    url_part=strcat('https://www.bible.com/bible/',...
                        num2str(biblecom_code1),'/',boek_url,'.',...
                        num2str(hoofdstuk),'.',biblecom_code2);
                otherwise
                    msgbox('no URL information found')
                    error('no URL information found')
            end
            if boeknr==39 && hoofdstuk==4
                outfilename=WBM(filename,url_part,...
                    struct('date_part',mal4_date_part));
            else
                outfilename=WBM(filename,url_part,...
                    struct('date_part',date_part));
            end
            if isempty(outfilename)
                %rethrow(errorStack{end})
                missing_files=missing_files+1;
            end
        else
            already_downloaded=already_downloaded+1;
        end
        
    end
end
if any(bible_dot_com_element)
    url_part=sprintf('https://www.bible.com/versions/%d',biblecom_code1);
    filename=[htmlpath prefix '_-_versioninfo.html'];
    if ~exist(filename,'file')
        outfilename=WBM(filename,url_part,...
            struct('date_part',date_part));
        if isempty(outfilename)
            %rethrow(errorStack{end})
        end
    end
end
if get(handles.togglebutton1,'Value')
    %Canceled, don't disp a new status
else
    disp_status(sprintf(handles.dict.finishedDownload,FullName),handles.stat_field1)
end
end
function missing_files=get_html_SV1637_77(handles)
%download the html files from the Wayback Machine
missing_files=0;
disp_status(handles.dict.SV1637_77_started,handles.stat_field2)

pad='http://www.bijbelsdigitaal.nl/view/?mode=3&bible=sv1637&bible2=sv1977&ref=';
downloadlist={...
    'GENESIS1.html','20170801065946','GEN.1';...
    'GENESIS2.html','20170801065957','GEN.2';...
    'GENESIS3.html','20170801070001','GEN.3';...
    'GENESIS4.html','20170801181633','GEN.4';...
    'GENESIS5.html','20170801182105','GEN.5';...
    'GENESIS6.html','20170801183521','GEN.6';...
    'GENESIS7.html','20170801182140','GEN.7';...
    'GENESIS8.html','20170801183543','GEN.8';...
    'GENESIS9.html','20170801182358','GEN.9';...
    'GENESIS10.html','20170801182918','GEN.10';...
    'GENESIS11.html','20170801182922','GEN.11';...
    'GENESIS12.html','20170801182931','GEN.12';...
    'GENESIS13.html','20170801182933','GEN.13';...
    'GENESIS14.html','20170801182939','GEN.14';...
    'GENESIS15.html','20170801182943','GEN.15';...
    'GENESIS16.html','20170801182947','GEN.16';...
    'GENESIS17.html','20170801182952','GEN.17';...
    'GENESIS18.html','20170801183001','GEN.18';...
    'GENESIS19.html','20170801183007','GEN.19';...
    'GENESIS20.html','20170801183011','GEN.20';...
    'GENESIS21.html','20170801183021','GEN.21';...
    'GENESIS22.html','20170801183044','GEN.22';...
    'GENESIS23.html','20170801183054','GEN.23';...
    'GENESIS24.html','20170801183104','GEN.24';...
    'GENESIS25.html','20170801183111','GEN.25';...
    'GENESIS26.html','20170801192132','GEN.26';...
    'GENESIS27.html','20170801183617','GEN.27';...
    'GENESIS28.html','20170801183624','GEN.28';...
    'GENESIS29.html','20170801183628','GEN.29';...
    'GENESIS30.html','20170801183632','GEN.30';...
    'GENESIS31.html','20170801183643','GEN.31';...
    'GENESIS32.html','20170801183647','GEN.32';...
    'GENESIS33.html','20170801192212','GEN.33';...
    'GENESIS34.html','20170801184436','GEN.34';...
    'GENESIS35.html','20170801185526','GEN.35';...
    'GENESIS36.html','20170801190150','GEN.36';...
    'GENESIS37.html','20170801190243','GEN.37';...
    'GENESIS38.html','20170801190325','GEN.38';...
    'GENESIS39.html','20170801190413','GEN.39';...
    'GENESIS40.html','20170801190436','GEN.40';...
    'GENESIS41.html','20170801190445','GEN.41';...
    'GENESIS42.html','20170801190534','GEN.42';...
    'GENESIS43.html','20170801192703','GEN.43';...
    'GENESIS44.html','20170801192950','GEN.44';...
    'GENESIS45.html','20170801193009','GEN.45';...
    'GENESIS46.html','20170801193015','GEN.46';...
    'GENESIS47.html','20170801193020','GEN.47';...
    'GENESIS48.html','20170801193026','GEN.48';...
    'GENESIS49.html','20170801193032','GEN.49';...
    'GENESIS50.html','20170801193038','GEN.50';...
    'EXODUS1.html','20170801193044','EXOD.1';...
    'EXODUS2.html','20170801193049','EXOD.2';...
    'EXODUS3.html','20170801193056','EXOD.3';...
    'EXODUS4.html','20170801193102','EXOD.4';...
    'EXODUS5.html','20170801193108','EXOD.5';...
    'EXODUS6.html','20170801193115','EXOD.6';...
    'EXODUS7.html','20170801193157','EXOD.7';...
    'EXODUS8.html','20170801193338','EXOD.8';...
    'EXODUS9.html','20170801193343','EXOD.9';...
    'EXODUS10.html','20170801193347','EXOD.10';...
    'EXODUS11.html','20170801193354','EXOD.11';...
    'EXODUS12.html','20170801193401','EXOD.12';...
    'EXODUS13.html','20170801193406','EXOD.13';...
    'EXODUS14.html','20170801193426','EXOD.14';...
    'EXODUS15.html','20170801193430','EXOD.15';...
    'EXODUS16.html','20170801193436','EXOD.16';...
    'EXODUS17.html','20170801193455','EXOD.17';...
    'EXODUS18.html','20170801193500','EXOD.18';...
    'EXODUS19.html','20170801193521','EXOD.19';...
    'EXODUS20.html','20170801193533','EXOD.20';...
    'EXODUS21.html','20170801193538','EXOD.21';...
    'EXODUS22.html','20170801193543','EXOD.22';...
    'EXODUS23.html','20170801193548','EXOD.23';...
    'EXODUS24.html','20170801193553','EXOD.24';...
    'EXODUS25.html','20170801193558','EXOD.25';...
    'EXODUS26.html','20170801193709','EXOD.26';...
    'EXODUS27.html','20170801193713','EXOD.27';...
    'EXODUS28.html','20170801193738','EXOD.28';...
    'EXODUS29.html','20170801193743','EXOD.29';...
    'EXODUS30.html','20170801193749','EXOD.30';...
    'EXODUS31.html','20170801193754','EXOD.31';...
    'EXODUS32.html','20170801193800','EXOD.32';...
    'EXODUS33.html','20170801193805','EXOD.33';...
    'EXODUS34.html','20170801193810','EXOD.34';...
    'EXODUS35.html','20170801193815','EXOD.35';...
    'EXODUS36.html','20170801193821','EXOD.36';...
    'EXODUS37.html','20170801193826','EXOD.37';...
    'EXODUS38.html','20170801193831','EXOD.38';...
    'EXODUS39.html','20170801193921','EXOD.39';...
    'EXODUS40.html','20170801194000','EXOD.40';...
    'LEVITICUS1.html','20170801194146','LEV.1';...
    'LEVITICUS2.html','20170801194151','LEV.2';...
    'LEVITICUS3.html','20170801194156','LEV.3';...
    'LEVITICUS4.html','20170801194303','LEV.4';...
    'LEVITICUS5.html','20170801194308','LEV.5';...
    'LEVITICUS6.html','20170801194314','LEV.6';...
    'LEVITICUS7.html','20170801194318','LEV.7';...
    'LEVITICUS8.html','20170801194324','LEV.8';...
    'LEVITICUS9.html','20170801194329','LEV.9';...
    'LEVITICUS10.html','20170801194400','LEV.10';...
    'LEVITICUS11.html','20170801194405','LEV.11';...
    'LEVITICUS12.html','20170801194458','LEV.12';...
    'LEVITICUS13.html','20170801194555','LEV.13';...
    'LEVITICUS14.html','20170801194601','LEV.14';...
    'LEVITICUS15.html','20170801194607','LEV.15';...
    'LEVITICUS16.html','20170801194722','LEV.16';...
    'LEVITICUS17.html','20170801194808','LEV.17';...
    'LEVITICUS18.html','20170801195009','LEV.18';...
    'LEVITICUS19.html','20170801195051','LEV.19';...
    'LEVITICUS20.html','20170801195109','LEV.20';...
    'LEVITICUS21.html','20170801195149','LEV.21';...
    'LEVITICUS22.html','20170801195154','LEV.22';...
    'LEVITICUS23.html','20170801195201','LEV.23';...
    'LEVITICUS24.html','20170801195206','LEV.24';...
    'LEVITICUS25.html','20170801195212','LEV.25';...
    'LEVITICUS26.html','20170801195218','LEV.26';...
    'LEVITICUS27.html','20170801195224','LEV.27';...
    'NUMERI1.html','20170801195245','NUM.1';...
    'NUMERI2.html','20170801195251','NUM.2';...
    'NUMERI3.html','20170801195257','NUM.3';...
    'NUMERI4.html','20170801195320','NUM.4';...
    'NUMERI5.html','20170801195326','NUM.5';...
    'NUMERI6.html','20170801195330','NUM.6';...
    'NUMERI7.html','20170801195337','NUM.7';...
    'NUMERI8.html','20170801195341','NUM.8';...
    'NUMERI9.html','20170801195347','NUM.9';...
    'NUMERI10.html','20170801195409','NUM.10';...
    'NUMERI11.html','20170801195414','NUM.11';...
    'NUMERI12.html','20170801195418','NUM.12';...
    'NUMERI13.html','20170801195432','NUM.13';...
    'NUMERI14.html','20170801195438','NUM.14';...
    'NUMERI15.html','20170801195449','NUM.15';...
    'NUMERI16.html','20170801195454','NUM.16';...
    'NUMERI17.html','20170801195501','NUM.17';...
    'NUMERI18.html','20170801195506','NUM.18';...
    'NUMERI19.html','20170801195511','NUM.19';...
    'NUMERI20.html','20170801195516','NUM.20';...
    'NUMERI21.html','20170801195522','NUM.21';...
    'NUMERI22.html','20170801195527','NUM.22';...
    'NUMERI23.html','20170801195533','NUM.23';...
    'NUMERI24.html','20170801195538','NUM.24';...
    'NUMERI25.html','20170801195545','NUM.25';...
    'NUMERI26.html','20170801195604','NUM.26';...
    'NUMERI27.html','20170801195610','NUM.27';...
    'NUMERI28.html','20170801195626','NUM.28';...
    'NUMERI29.html','20170801195630','NUM.29';...
    'NUMERI30.html','20170801195635','NUM.30';...
    'NUMERI31.html','20170801195640','NUM.31';...
    'NUMERI32.html','20170801195645','NUM.32';...
    'NUMERI33.html','20170801195652','NUM.33';...
    'NUMERI34.html','20170801195657','NUM.34';...
    'NUMERI35.html','20170801195702','NUM.35';...
    'NUMERI36.html','20170801195707','NUM.36';...
    'DEUTERONOMIUM1.html','20170801195713','DEUT.1';...
    'DEUTERONOMIUM2.html','20170801195719','DEUT.2';...
    'DEUTERONOMIUM3.html','20170801195724','DEUT.3';...
    'DEUTERONOMIUM4.html','20170801195729','DEUT.4';...
    'DEUTERONOMIUM5.html','20170801195801','DEUT.5';...
    'DEUTERONOMIUM6.html','20170801195809','DEUT.6';...
    'DEUTERONOMIUM7.html','20170801195814','DEUT.7';...
    'DEUTERONOMIUM8.html','20170801195820','DEUT.8';...
    'DEUTERONOMIUM9.html','20170801195842','DEUT.9';...
    'DEUTERONOMIUM10.html','20170801195847','DEUT.10';...
    'DEUTERONOMIUM11.html','20170801195852','DEUT.11';...
    'DEUTERONOMIUM12.html','20170801195858','DEUT.12';...
    'DEUTERONOMIUM13.html','20170801195921','DEUT.13';...
    'DEUTERONOMIUM14.html','20170801195926','DEUT.14';...
    'DEUTERONOMIUM15.html','20170801195930','DEUT.15';...
    'DEUTERONOMIUM16.html','20170801195935','DEUT.16';...
    'DEUTERONOMIUM17.html','20170801195941','DEUT.17';...
    'DEUTERONOMIUM18.html','20170801195946','DEUT.18';...
    'DEUTERONOMIUM19.html','20170801195952','DEUT.19';...
    'DEUTERONOMIUM20.html','20170801200001','DEUT.20';...
    'DEUTERONOMIUM21.html','20170801200006','DEUT.21';...
    'DEUTERONOMIUM22.html','20170801200012','DEUT.22';...
    'DEUTERONOMIUM23.html','20170801200017','DEUT.23';...
    'DEUTERONOMIUM24.html','20170801200052','DEUT.24';...
    'DEUTERONOMIUM25.html','20170801200059','DEUT.25';...
    'DEUTERONOMIUM26.html','20170801200104','DEUT.26';...
    'DEUTERONOMIUM27.html','20170801200110','DEUT.27';...
    'DEUTERONOMIUM28.html','20170801200116','DEUT.28';...
    'DEUTERONOMIUM29.html','20170801200123','DEUT.29';...
    'DEUTERONOMIUM30.html','20170801200144','DEUT.30';...
    'DEUTERONOMIUM31.html','20170801200149','DEUT.31';...
    'DEUTERONOMIUM32.html','20170801200156','DEUT.32';...
    'DEUTERONOMIUM33.html','20170801200203','DEUT.33';...
    'DEUTERONOMIUM34.html','20170801200209','DEUT.34';...
    'JOZUA1.html','20170801200215','JOSH.1';...
    'JOZUA2.html','20170801200220','JOSH.2';...
    'JOZUA3.html','20170801200226','JOSH.3';...
    'JOZUA4.html','20170801200231','JOSH.4';...
    'JOZUA5.html','20170801200237','JOSH.5';...
    'JOZUA6.html','20170801200242','JOSH.6';...
    'JOZUA7.html','20170801200247','JOSH.7';...
    'JOZUA8.html','20170801200254','JOSH.8';...
    'JOZUA9.html','20170801200258','JOSH.9';...
    'JOZUA10.html','20170801200303','JOSH.10';...
    'JOZUA11.html','20170801200310','JOSH.11';...
    'JOZUA12.html','20170801200317','JOSH.12';...
    'JOZUA13.html','20170801200323','JOSH.13';...
    'JOZUA14.html','20170801200327','JOSH.14';...
    'JOZUA15.html','20170801200333','JOSH.15';...
    'JOZUA16.html','20170801200618','JOSH.16';...
    'JOZUA17.html','20170801200622','JOSH.17';...
    'JOZUA18.html','20170801200652','JOSH.18';...
    'JOZUA19.html','20170801200657','JOSH.19';...
    'JOZUA20.html','20170801200702','JOSH.20';...
    'JOZUA21.html','20170801200718','JOSH.21';...
    'JOZUA22.html','20170801200723','JOSH.22';...
    'JOZUA23.html','20170801200729','JOSH.23';...
    'JOZUA24.html','20170801200736','JOSH.24';...
    'RECHTERS1.html','20170801200741','JUDG.1';...
    'RECHTERS2.html','20170801200746','JUDG.2';...
    'RECHTERS3.html','20170801200751','JUDG.3';...
    'RECHTERS4.html','20170801200759','JUDG.4';...
    'RECHTERS5.html','20170801200837','JUDG.5';...
    'RECHTERS6.html','20170801200842','JUDG.6';...
    'RECHTERS7.html','20170801200847','JUDG.7';...
    'RECHTERS8.html','20170801200852','JUDG.8';...
    'RECHTERS9.html','20170801200859','JUDG.9';...
    'RECHTERS10.html','20170801201133','JUDG.10';...
    'RECHTERS11.html','20170801201143','JUDG.11';...
    'RECHTERS12.html','20170801201148','JUDG.12';...
    'RECHTERS13.html','20170801201152','JUDG.13';...
    'RECHTERS14.html','20170801201157','JUDG.14';...
    'RECHTERS15.html','20170801201202','JUDG.15';...
    'RECHTERS16.html','20170801201208','JUDG.16';...
    'RECHTERS17.html','20170801201213','JUDG.17';...
    'RECHTERS18.html','20170801201219','JUDG.18';...
    'RECHTERS19.html','20170801201239','JUDG.19';...
    'RECHTERS20.html','20170801201242','JUDG.20';...
    'RECHTERS21.html','20170801201257','JUDG.21';...
    'RUTH1.html','20170801201302','RUTH.1';...
    'RUTH2.html','20170801201307','RUTH.2';...
    'RUTH3.html','20170801201315','RUTH.3';...
    'RUTH4.html','20170801201320','RUTH.4';...
    '1SAMUEL1.html','20170801201417','1SAM.1';...
    '1SAMUEL2.html','20170801201422','1SAM.2';...
    '1SAMUEL3.html','20170801201427','1SAM.3';...
    '1SAMUEL4.html','20170801201433','1SAM.4';...
    '1SAMUEL5.html','20170801201440','1SAM.5';...
    '1SAMUEL6.html','20170801201445','1SAM.6';...
    '1SAMUEL7.html','20170801201450','1SAM.7';...
    '1SAMUEL8.html','20170801201457','1SAM.8';...
    '1SAMUEL9.html','20170801201502','1SAM.9';...
    '1SAMUEL10.html','20170801201507','1SAM.10';...
    '1SAMUEL11.html','20170801201513','1SAM.11';...
    '1SAMUEL12.html','20170801201518','1SAM.12';...
    '1SAMUEL13.html','20170801201523','1SAM.13';...
    '1SAMUEL14.html','20170801201528','1SAM.14';...
    '1SAMUEL15.html','20170801201534','1SAM.15';...
    '1SAMUEL16.html','20170801201542','1SAM.16';...
    '1SAMUEL17.html','20170801201546','1SAM.17';...
    '1SAMUEL18.html','20170801201709','1SAM.18';...
    '1SAMUEL19.html','20170801201941','1SAM.19';...
    '1SAMUEL20.html','20170801201949','1SAM.20';...
    '1SAMUEL21.html','20170801202024','1SAM.21';...
    '1SAMUEL22.html','20170801202056','1SAM.22';...
    '1SAMUEL23.html','20170801202130','1SAM.23';...
    '1SAMUEL24.html','20170801202149','1SAM.24';...
    '1SAMUEL25.html','20170801202211','1SAM.25';...
    '1SAMUEL26.html','20170801202401','1SAM.26';...
    '1SAMUEL27.html','20170801202410','1SAM.27';...
    '1SAMUEL28.html','20170802154456','1SAM.28';...
    '1SAMUEL29.html','20170802154507','1SAM.29';...
    '1SAMUEL30.html','20170802154511','1SAM.30';...
    '1SAMUEL31.html','20170802154520','1SAM.31';...
    '2SAMUEL1.html','20170802154525','2SAM.1';...
    '2SAMUEL2.html','20170802154627','2SAM.2';...
    '2SAMUEL3.html','20170802154645','2SAM.3';...
    '2SAMUEL4.html','20170802154650','2SAM.4';...
    '2SAMUEL5.html','20170802154710','2SAM.5';...
    '2SAMUEL6.html','20170802154715','2SAM.6';...
    '2SAMUEL7.html','20170802154720','2SAM.7';...
    '2SAMUEL8.html','20170802154726','2SAM.8';...
    '2SAMUEL9.html','20170802154731','2SAM.9';...
    '2SAMUEL10.html','20170802154738','2SAM.10';...
    '2SAMUEL11.html','20170802154743','2SAM.11';...
    '2SAMUEL12.html','20170802154749','2SAM.12';...
    '2SAMUEL13.html','20170802154754','2SAM.13';...
    '2SAMUEL14.html','20170802154800','2SAM.14';...
    '2SAMUEL15.html','20170802154805','2SAM.15';...
    '2SAMUEL16.html','20170802154812','2SAM.16';...
    '2SAMUEL17.html','20170802154818','2SAM.17';...
    '2SAMUEL18.html','20170802154823','2SAM.18';...
    '2SAMUEL19.html','20170802154828','2SAM.19';...
    '2SAMUEL20.html','20170802154837','2SAM.20';...
    '2SAMUEL21.html','20170802154843','2SAM.21';...
    '2SAMUEL22.html','20170802154906','2SAM.22';...
    '2SAMUEL23.html','20170802154930','2SAM.23';...
    '2SAMUEL24.html','20170802154934','2SAM.24';...
    '1KONINGEN1.html','20170802154940','1KGS.1';...
    '1KONINGEN2.html','20170802154949','1KGS.2';...
    '1KONINGEN3.html','20170802154957','1KGS.3';...
    '1KONINGEN4.html','20170802155002','1KGS.4';...
    '1KONINGEN5.html','20170802155022','1KGS.5';...
    '1KONINGEN6.html','20170802155029','1KGS.6';...
    '1KONINGEN7.html','20170802155034','1KGS.7';...
    '1KONINGEN8.html','20170802155046','1KGS.8';...
    '1KONINGEN9.html','20170802155110','1KGS.9';...
    '1KONINGEN10.html','20170802155116','1KGS.10';...
    '1KONINGEN11.html','20170802155128','1KGS.11';...
    '1KONINGEN12.html','20170802155320','1KGS.12';...
    '1KONINGEN13.html','20170802155331','1KGS.13';...
    '1KONINGEN14.html','20170802155338','1KGS.14';...
    '1KONINGEN15.html','20170802155343','1KGS.15';...
    '1KONINGEN16.html','20170802155352','1KGS.16';...
    '1KONINGEN17.html','20170802155357','1KGS.17';...
    '1KONINGEN18.html','20170802155402','1KGS.18';...
    '1KONINGEN19.html','20170802155426','1KGS.19';...
    '1KONINGEN20.html','20170802155518','1KGS.20';...
    '1KONINGEN21.html','20170802155521','1KGS.21';...
    '1KONINGEN22.html','20170802155533','1KGS.22';...
    '2KONINGEN1.html','20170802155539','2KGS.1';...
    '2KONINGEN2.html','20170802155620','2KGS.2';...
    '2KONINGEN3.html','20170802155650','2KGS.3';...
    '2KONINGEN4.html','20170802155659','2KGS.4';...
    '2KONINGEN5.html','20170802155747','2KGS.5';...
    '2KONINGEN6.html','20170802155910','2KGS.6';...
    '2KONINGEN7.html','20170802155915','2KGS.7';...
    '2KONINGEN8.html','20170802155929','2KGS.8';...
    '2KONINGEN9.html','20170802155943','2KGS.9';...
    '2KONINGEN10.html','20170802160045','2KGS.10';...
    '2KONINGEN11.html','20170802160157','2KGS.11';...
    '2KONINGEN12.html','20170802160222','2KGS.12';...
    '2KONINGEN13.html','20170802160241','2KGS.13';...
    '2KONINGEN14.html','20170802160254','2KGS.14';...
    '2KONINGEN15.html','20170802160537','2KGS.15';...
    '2KONINGEN16.html','20170802160652','2KGS.16';...
    '2KONINGEN17.html','20170802160659','2KGS.17';...
    '2KONINGEN18.html','20170802160710','2KGS.18';...
    '2KONINGEN19.html','20170802160726','2KGS.19';...
    '2KONINGEN20.html','20170802160808','2KGS.20';...
    '2KONINGEN21.html','20170802160824','2KGS.21';...
    '2KONINGEN22.html','20170802160835','2KGS.22';...
    '2KONINGEN23.html','20170802160853','2KGS.23';...
    '2KONINGEN24.html','20170802160927','2KGS.24';...
    '2KONINGEN25.html','20170802160946','2KGS.25';...
    '1KRONIEKEN1.html','20170802160958','1CHR.1';...
    '1KRONIEKEN2.html','20170802161019','1CHR.2';...
    '1KRONIEKEN3.html','20170802161035','1CHR.3';...
    '1KRONIEKEN4.html','20170802161123','1CHR.4';...
    '1KRONIEKEN5.html','20170802161128','1CHR.5';...
    '1KRONIEKEN6.html','20170802161155','1CHR.6';...
    '1KRONIEKEN7.html','20170802161219','1CHR.7';...
    '1KRONIEKEN8.html','20170802161235','1CHR.8';...
    '1KRONIEKEN9.html','20170802161239','1CHR.9';...
    '1KRONIEKEN10.html','20170802161248','1CHR.10';...
    '1KRONIEKEN11.html','20170802161253','1CHR.11';...
    '1KRONIEKEN12.html','20170802161259','1CHR.12';...
    '1KRONIEKEN13.html','20170802161316','1CHR.13';...
    '1KRONIEKEN14.html','20170802161318','1CHR.14';...
    '1KRONIEKEN15.html','20170802161323','1CHR.15';...
    '1KRONIEKEN16.html','20170802161328','1CHR.16';...
    '1KRONIEKEN17.html','20170802161333','1CHR.17';...
    '1KRONIEKEN18.html','20170802161338','1CHR.18';...
    '1KRONIEKEN19.html','20170802161343','1CHR.19';...
    '1KRONIEKEN20.html','20170802161352','1CHR.20';...
    '1KRONIEKEN21.html','20170802161357','1CHR.21';...
    '1KRONIEKEN22.html','20170802161404','1CHR.22';...
    '1KRONIEKEN23.html','20170802161408','1CHR.23';...
    '1KRONIEKEN24.html','20170802161414','1CHR.24';...
    '1KRONIEKEN25.html','20170802161421','1CHR.25';...
    '1KRONIEKEN26.html','20170802161612','1CHR.26';...
    '1KRONIEKEN27.html','20170802161635','1CHR.27';...
    '1KRONIEKEN28.html','20170802161642','1CHR.28';...
    '1KRONIEKEN29.html','20170802161647','1CHR.29';...
    '2KRONIEKEN1.html','20170802161652','2CHR.1';...
    '2KRONIEKEN2.html','20170802161657','2CHR.2';...
    '2KRONIEKEN3.html','20170802161702','2CHR.3';...
    '2KRONIEKEN4.html','20170802161707','2CHR.4';...
    '2KRONIEKEN5.html','20170802161723','2CHR.5';...
    '2KRONIEKEN6.html','20170802161726','2CHR.6';...
    '2KRONIEKEN7.html','20170802161731','2CHR.7';...
    '2KRONIEKEN8.html','20170802161736','2CHR.8';...
    '2KRONIEKEN9.html','20170802161741','2CHR.9';...
    '2KRONIEKEN10.html','20170802161746','2CHR.10';...
    '2KRONIEKEN11.html','20170802161805','2CHR.11';...
    '2KRONIEKEN12.html','20170802161807','2CHR.12';...
    '2KRONIEKEN13.html','20170802161812','2CHR.13';...
    '2KRONIEKEN14.html','20170802161817','2CHR.14';...
    '2KRONIEKEN15.html','20170802161822','2CHR.15';...
    '2KRONIEKEN16.html','20170802161837','2CHR.16';...
    '2KRONIEKEN17.html','20170802161841','2CHR.17';...
    '2KRONIEKEN18.html','20170802161918','2CHR.18';...
    '2KRONIEKEN19.html','20170802161922','2CHR.19';...
    '2KRONIEKEN20.html','20170802161928','2CHR.20';...
    '2KRONIEKEN21.html','20170802161954','2CHR.21';...
    '2KRONIEKEN22.html','20170802161959','2CHR.22';...
    '2KRONIEKEN23.html','20170802162005','2CHR.23';...
    '2KRONIEKEN24.html','20170802162011','2CHR.24';...
    '2KRONIEKEN25.html','20170802162017','2CHR.25';...
    '2KRONIEKEN26.html','20170802162023','2CHR.26';...
    '2KRONIEKEN27.html','20170802162029','2CHR.27';...
    '2KRONIEKEN28.html','20170802162035','2CHR.28';...
    '2KRONIEKEN29.html','20170802162045','2CHR.29';...
    '2KRONIEKEN30.html','20170802162109','2CHR.30';...
    '2KRONIEKEN31.html','20170802162121','2CHR.31';...
    '2KRONIEKEN32.html','20170802162126','2CHR.32';...
    '2KRONIEKEN33.html','20170802162132','2CHR.33';...
    '2KRONIEKEN34.html','20170802162156','2CHR.34';...
    '2KRONIEKEN35.html','20170802162241','2CHR.35';...
    '2KRONIEKEN36.html','20170802162243','2CHR.36';...
    'EZRA1.html','20170802162248','EZRA.1';...
    'EZRA2.html','20170802162253','EZRA.2';...
    'EZRA3.html','20170802162300','EZRA.3';...
    'EZRA4.html','20170802162304','EZRA.4';...
    'EZRA5.html','20170802162310','EZRA.5';...
    'EZRA6.html','20170802162315','EZRA.6';...
    'EZRA7.html','20170802162320','EZRA.7';...
    'EZRA8.html','20170802162326','EZRA.8';...
    'EZRA9.html','20170802162331','EZRA.9';...
    'EZRA10.html','20170802162338','EZRA.10';...
    'NEHEMIA1.html','20170802162343','NEH.1';...
    'NEHEMIA2.html','20170802162348','NEH.2';...
    'NEHEMIA3.html','20170802162353','NEH.3';...
    'NEHEMIA4.html','20170802162359','NEH.4';...
    'NEHEMIA5.html','20170802162408','NEH.5';...
    'NEHEMIA6.html','20170802162413','NEH.6';...
    'NEHEMIA7.html','20170802162431','NEH.7';...
    'NEHEMIA8.html','20170802162452','NEH.8';...
    'NEHEMIA9.html','20170802162454','NEH.9';...
    'NEHEMIA10.html','20170802162500','NEH.10';...
    'NEHEMIA11.html','20170802162517','NEH.11';...
    'NEHEMIA12.html','20170802162531','NEH.12';...
    'NEHEMIA13.html','20170802162548','NEH.13';...
    'ESTHER1.html','20170802162605','ESTH.1';...
    'ESTHER2.html','20170802162614','ESTH.2';...
    'ESTHER3.html','20170802162619','ESTH.3';...
    'ESTHER4.html','20170802162634','ESTH.4';...
    'ESTHER5.html','20170802162644','ESTH.5';...
    'ESTHER6.html','20170802162700','ESTH.6';...
    'ESTHER7.html','20170802162718','ESTH.7';...
    'ESTHER8.html','20170802162733','ESTH.8';...
    'ESTHER9.html','20170802162748','ESTH.9';...
    'ESTHER10.html','20170802162807','ESTH.10';...
    'JOB1.html','20170802162854','JOB.1';...
    'JOB2.html','20170802162902','JOB.2';...
    'JOB3.html','20170802162909','JOB.3';...
    'JOB4.html','20170802162929','JOB.4';...
    'JOB5.html','20170802162950','JOB.5';...
    'JOB6.html','20170802163002','JOB.6';...
    'JOB7.html','20170802163038','JOB.7';...
    'JOB8.html','20170802163101','JOB.8';...
    'JOB9.html','20170802163118','JOB.9';...
    'JOB10.html','20170802163129','JOB.10';...
    'JOB11.html','20170802163156','JOB.11';...
    'JOB12.html','20170802163206','JOB.12';...
    'JOB13.html','20170802163214','JOB.13';...
    'JOB14.html','20170802163231','JOB.14';...
    'JOB15.html','20170802163246','JOB.15';...
    'JOB16.html','20170802163402','JOB.16';...
    'JOB17.html','20170802163410','JOB.17';...
    'JOB18.html','20170802163428','JOB.18';...
    'JOB19.html','20170802163448','JOB.19';...
    'JOB20.html','20170802163508','JOB.20';...
    'JOB21.html','20170802163526','JOB.21';...
    'JOB22.html','20170802163550','JOB.22';...
    'JOB23.html','20170802163611','JOB.23';...
    'JOB24.html','20170802163639','JOB.24';...
    'JOB25.html','20170802163655','JOB.25';...
    'JOB26.html','20170802164014','JOB.26';...
    'JOB27.html','20170802164027','JOB.27';...
    'JOB28.html','20170802164127','JOB.28';...
    'JOB29.html','20170802164232','JOB.29';...
    'JOB30.html','20170802164338','JOB.30';...
    'JOB31.html','20170802164529','JOB.31';...
    'JOB32.html','20170802164737','JOB.32';...
    'JOB33.html','20170802164935','JOB.33';...
    'JOB34.html','20170802164958','JOB.34';...
    'JOB35.html','20170802165016','JOB.35';...
    'JOB36.html','20170802165051','JOB.36';...
    'JOB37.html','20170802165103','JOB.37';...
    'JOB38.html','20170802165111','JOB.38';...
    'JOB39.html','20170802165122','JOB.39';...
    'JOB40.html','20170802165142','JOB.40';...
    'JOB41.html','20170802165218','JOB.41';...
    'JOB42.html','20170802165256','JOB.42';...
    'PSALMEN1.html','20170802165331','PS.1';...
    'PSALMEN2.html','20170802165441','PS.2';...
    'PSALMEN3.html','20170802165444','PS.3';...
    'PSALMEN4.html','20170802165516','PS.4';...
    'PSALMEN5.html','20170802165526','PS.5';...
    'PSALMEN6.html','20170802165544','PS.6';...
    'PSALMEN7.html','20170802165601','PS.7';...
    'PSALMEN8.html','20170802165617','PS.8';...
    'PSALMEN9.html','20170802165638','PS.9';...
    'PSALMEN10.html','20170802165658','PS.10';...
    'PSALMEN11.html','20170802165816','PS.11';...
    'PSALMEN12.html','20170802165835','PS.12';...
    'PSALMEN13.html','20170802165909','PS.13';...
    'PSALMEN14.html','20170802165947','PS.14';...
    'PSALMEN15.html','20170802170008','PS.15';...
    'PSALMEN16.html','20170802170033','PS.16';...
    'PSALMEN17.html','20170802170041','PS.17';...
    'PSALMEN18.html','20170802170138','PS.18';...
    'PSALMEN19.html','20170802170155','PS.19';...
    'PSALMEN20.html','20170802170300','PS.20';...
    'PSALMEN21.html','20170802170318','PS.21';...
    'PSALMEN22.html','20170802170339','PS.22';...
    'PSALMEN23.html','20170802170455','PS.23';...
    'PSALMEN24.html','20170802170502','PS.24';...
    'PSALMEN25.html','20170802170514','PS.25';...
    'PSALMEN26.html','20170802170646','PS.26';...
    'PSALMEN27.html','20170802170659','PS.27';...
    'PSALMEN28.html','20170802170732','PS.28';...
    'PSALMEN29.html','20170802170737','PS.29';...
    'PSALMEN30.html','20170802170805','PS.30';...
    'PSALMEN31.html','20170802170835','PS.31';...
    'PSALMEN32.html','20170802171059','PS.32';...
    'PSALMEN33.html','20170802171231','PS.33';...
    'PSALMEN34.html','20170802171252','PS.34';...
    'PSALMEN35.html','20170802171312','PS.35';...
    'PSALMEN36.html','20170802171315','PS.36';...
    'PSALMEN37.html','20170802171325','PS.37';...
    'PSALMEN38.html','20170802171340','PS.38';...
    'PSALMEN39.html','20170802171427','PS.39';...
    'PSALMEN40.html','20170802171430','PS.40';...
    'PSALMEN41.html','20170802171439','PS.41';...
    'PSALMEN42.html','20170802171520','PS.42';...
    'PSALMEN43.html','20170802171531','PS.43';...
    'PSALMEN44.html','20170802171713','PS.44';...
    'PSALMEN45.html','20170802171716','PS.45';...
    'PSALMEN46.html','20170802171721','PS.46';...
    'PSALMEN47.html','20170802171739','PS.47';...
    'PSALMEN48.html','20170802171806','PS.48';...
    'PSALMEN49.html','20170802171808','PS.49';...
    'PSALMEN50.html','20170802171816','PS.50';...
    'PSALMEN51.html','20170802171848','PS.51';...
    'PSALMEN52.html','20170802172049','PS.52';...
    'PSALMEN53.html','20170802172051','PS.53';...
    'PSALMEN54.html','20170802172123','PS.54';...
    'PSALMEN55.html','20170802172139','PS.55';...
    'PSALMEN56.html','20170802172232','PS.56';...
    'PSALMEN57.html','20170802172236','PS.57';...
    'PSALMEN58.html','20170802172240','PS.58';...
    'PSALMEN59.html','20170802172245','PS.59';...
    'PSALMEN60.html','20170802172307','PS.60';...
    'PSALMEN61.html','20170802172310','PS.61';...
    'PSALMEN62.html','20170802172315','PS.62';...
    'PSALMEN63.html','20170802172320','PS.63';...
    'PSALMEN64.html','20170802172327','PS.64';...
    'PSALMEN65.html','20170802172332','PS.65';...
    'PSALMEN66.html','20170802172339','PS.66';...
    'PSALMEN67.html','20170802172344','PS.67';...
    'PSALMEN68.html','20170802172350','PS.68';...
    'PSALMEN69.html','20170802172358','PS.69';...
    'PSALMEN70.html','20170802172405','PS.70';...
    'PSALMEN71.html','20170802172411','PS.71';...
    'PSALMEN72.html','20170802172417','PS.72';...
    'PSALMEN73.html','20170802172443','PS.73';...
    'PSALMEN74.html','20170802172449','PS.74';...
    'PSALMEN75.html','20170802172455','PS.75';...
    'PSALMEN76.html','20170802172502','PS.76';...
    'PSALMEN77.html','20170802172511','PS.77';...
    'PSALMEN78.html','20170802172622','PS.78';...
    'PSALMEN79.html','20170802172750','PS.79';...
    'PSALMEN80.html','20170802172756','PS.80';...
    'PSALMEN81.html','20170802172920','PS.81';...
    'PSALMEN82.html','20170802172931','PS.82';...
    'PSALMEN83.html','20170802172956','PS.83';...
    'PSALMEN84.html','20170802173008','PS.84';...
    'PSALMEN85.html','20170802173024','PS.85';...
    'PSALMEN86.html','20170802173053','PS.86';...
    'PSALMEN87.html','20170802173146','PS.87';...
    'PSALMEN88.html','20170802173223','PS.88';...
    'PSALMEN89.html','20170802173244','PS.89';...
    'PSALMEN90.html','20170802173247','PS.90';...
    'PSALMEN91.html','20170802173257','PS.91';...
    'PSALMEN92.html','20170802193546','PS.92';...
    'PSALMEN93.html','20170802195254','PS.93';...
    'PSALMEN94.html','20170802195257','PS.94';...
    'PSALMEN95.html','20170802193201','PS.95';...
    'PSALMEN96.html','20170802195302','PS.96';...
    'PSALMEN97.html','20170802195307','PS.97';...
    'PSALMEN98.html','20170802202359','PS.98';...
    'PSALMEN99.html','20170802202415','PS.99';...
    'PSALMEN100.html','20170802195012','PS.100';...
    'PSALMEN101.html','20170802202430','PS.101';...
    'PSALMEN102.html','20170802202436','PS.102';...
    'PSALMEN103.html','20170802202447','PS.103';...
    'PSALMEN104.html','20170802202456','PS.104';...
    'PSALMEN105.html','20170802202502','PS.105';...
    'PSALMEN106.html','20170802202507','PS.106';...
    'PSALMEN107.html','20170802202512','PS.107';...
    'PSALMEN108.html','20170802202519','PS.108';...
    'PSALMEN109.html','20170802202523','PS.109';...
    'PSALMEN110.html','20170802202528','PS.110';...
    'PSALMEN111.html','20170802202531','PS.111';...
    'PSALMEN112.html','20170802203455','PS.112';...
    'PSALMEN113.html','20170802203709','PS.113';...
    'PSALMEN114.html','20170802203902','PS.114';...
    'PSALMEN115.html','20170802203906','PS.115';...
    'PSALMEN116.html','20170802203911','PS.116';...
    'PSALMEN117.html','20170802203918','PS.117';...
    'PSALMEN118.html','20170802204259','PS.118';...
    'PSALMEN119.html','20170802204617','PS.119';...
    'PSALMEN120.html','20170802204627','PS.120';...
    'PSALMEN121.html','20170802204632','PS.121';...
    'PSALMEN122.html','20170802204636','PS.122';...
    'PSALMEN123.html','20170802204640','PS.123';...
    'PSALMEN124.html','20170802204644','PS.124';...
    'PSALMEN125.html','20170802204648','PS.125';...
    'PSALMEN126.html','20170802204651','PS.126';...
    'PSALMEN127.html','20170802204656','PS.127';...
    'PSALMEN128.html','20170802204700','PS.128';...
    'PSALMEN129.html','20170802204709','PS.129';...
    'PSALMEN130.html','20170802204715','PS.130';...
    'PSALMEN131.html','20170802204721','PS.131';...
    'PSALMEN132.html','20170802204726','PS.132';...
    'PSALMEN133.html','20170802204730','PS.133';...
    'PSALMEN134.html','20170802204734','PS.134';...
    'PSALMEN135.html','20170802204737','PS.135';...
    'PSALMEN136.html','20170802204742','PS.136';...
    'PSALMEN137.html','20170802204746','PS.137';...
    'PSALMEN138.html','20170802204749','PS.138';...
    'PSALMEN139.html','20170802204753','PS.139';...
    'PSALMEN140.html','20170802204757','PS.140';...
    'PSALMEN141.html','20170802204801','PS.141';...
    'PSALMEN142.html','20170802204806','PS.142';...
    'PSALMEN143.html','20170802204809','PS.143';...
    'PSALMEN144.html','20170802204814','PS.144';...
    'PSALMEN145.html','20170802204820','PS.145';...
    'PSALMEN146.html','20170802204824','PS.146';...
    'PSALMEN147.html','20170802204835','PS.147';...
    'PSALMEN148.html','20170802204839','PS.148';...
    'PSALMEN149.html','20170802204845','PS.149';...
    'PSALMEN150.html','20170802204850','PS.150';...
    'SPREUKEN1.html','20170802204856','PROV.1';...
    'SPREUKEN2.html','20170802204900','PROV.2';...
    'SPREUKEN3.html','20170802204904','PROV.3';...
    'SPREUKEN4.html','20170802204920','PROV.4';...
    'SPREUKEN5.html','20170802204925','PROV.5';...
    'SPREUKEN6.html','20170802204929','PROV.6';...
    'SPREUKEN7.html','20170802204933','PROV.7';...
    'SPREUKEN8.html','20170802204937','PROV.8';...
    'SPREUKEN9.html','20170802204945','PROV.9';...
    'SPREUKEN10.html','20170802204950','PROV.10';...
    'SPREUKEN11.html','20170802205055','PROV.11';...
    'SPREUKEN12.html','20170802205120','PROV.12';...
    'SPREUKEN13.html','20170802205127','PROV.13';...
    'SPREUKEN14.html','20170802205131','PROV.14';...
    'SPREUKEN15.html','20170802205135','PROV.15';...
    'SPREUKEN16.html','20170802205217','PROV.16';...
    'SPREUKEN17.html','20170802205302','PROV.17';...
    'SPREUKEN18.html','20170802205306','PROV.18';...
    'SPREUKEN19.html','20170802205310','PROV.19';...
    'SPREUKEN20.html','20170802205314','PROV.20';...
    'SPREUKEN21.html','20170802205411','PROV.21';...
    'SPREUKEN22.html','20170802205432','PROV.22';...
    'SPREUKEN23.html','20170802205436','PROV.23';...
    'SPREUKEN24.html','20170802205439','PROV.24';...
    'SPREUKEN25.html','20170802205444','PROV.25';...
    'SPREUKEN26.html','20170802205448','PROV.26';...
    'SPREUKEN27.html','20170802205452','PROV.27';...
    'SPREUKEN28.html','20170802205456','PROV.28';...
    'SPREUKEN29.html','20170802205500','PROV.29';...
    'SPREUKEN30.html','20170802205514','PROV.30';...
    'SPREUKEN31.html','20170802205519','PROV.31';...
    'PREDIKER1.html','20170802205523','ECCL.1';...
    'PREDIKER2.html','20170802205602','ECCL.2';...
    'PREDIKER3.html','20170802205649','ECCL.3';...
    'PREDIKER4.html','20170802205655','ECCL.4';...
    'PREDIKER5.html','20170802205701','ECCL.5';...
    'PREDIKER6.html','20170802205705','ECCL.6';...
    'PREDIKER7.html','20170802205709','ECCL.7';...
    'PREDIKER8.html','20170802205724','ECCL.8';...
    'PREDIKER9.html','20170802205727','ECCL.9';...
    'PREDIKER10.html','20170802205733','ECCL.10';...
    'PREDIKER11.html','20170802205737','ECCL.11';...
    'PREDIKER12.html','20170802205745','ECCL.12';...
    'HOOGLIED1.html','20170802205749','SONG.1';...
    'HOOGLIED2.html','20170802205755','SONG.2';...
    'HOOGLIED3.html','20170802205800','SONG.3';...
    'HOOGLIED4.html','20170802205808','SONG.4';...
    'HOOGLIED5.html','20170802205811','SONG.5';...
    'HOOGLIED6.html','20170802205815','SONG.6';...
    'HOOGLIED7.html','20170802205819','SONG.7';...
    'HOOGLIED8.html','20170802205834','SONG.8';...
    'JESAJA1.html','20170802205837','ISA.1';...
    'JESAJA2.html','20170802205853','ISA.2';...
    'JESAJA3.html','20170802205857','ISA.3';...
    'JESAJA4.html','20170802205905','ISA.4';...
    'JESAJA5.html','20170802205908','ISA.5';...
    'JESAJA6.html','20170802205913','ISA.6';...
    'JESAJA7.html','20170802205917','ISA.7';...
    'JESAJA8.html','20170802205921','ISA.8';...
    'JESAJA9.html','20170802205924','ISA.9';...
    'JESAJA10.html','20170802205928','ISA.10';...
    'JESAJA11.html','20170802205932','ISA.11';...
    'JESAJA12.html','20170802205937','ISA.12';...
    'JESAJA13.html','20170802205941','ISA.13';...
    'JESAJA14.html','20170802205945','ISA.14';...
    'JESAJA15.html','20170802205949','ISA.15';...
    'JESAJA16.html','20170802210004','ISA.16';...
    'JESAJA17.html','20170802210105','ISA.17';...
    'JESAJA18.html','20170802210149','ISA.18';...
    'JESAJA19.html','20170802210153','ISA.19';...
    'JESAJA20.html','20170802210157','ISA.20';...
    'JESAJA21.html','20170802210202','ISA.21';...
    'JESAJA22.html','20170802210207','ISA.22';...
    'JESAJA23.html','20170802210212','ISA.23';...
    'JESAJA24.html','20170802210216','ISA.24';...
    'JESAJA25.html','20170802210222','ISA.25';...
    'JESAJA26.html','20170802210226','ISA.26';...
    'JESAJA27.html','20170802210230','ISA.27';...
    'JESAJA28.html','20170802210234','ISA.28';...
    'JESAJA29.html','20170802210239','ISA.29';...
    'JESAJA30.html','20170802210244','ISA.30';...
    'JESAJA31.html','20170802210248','ISA.31';...
    'JESAJA32.html','20170802210252','ISA.32';...
    'JESAJA33.html','20170802210256','ISA.33';...
    'JESAJA34.html','20170802210301','ISA.34';...
    'JESAJA35.html','20170802210305','ISA.35';...
    'JESAJA36.html','20170802210309','ISA.36';...
    'JESAJA37.html','20170802210313','ISA.37';...
    'JESAJA38.html','20170802210317','ISA.38';...
    'JESAJA39.html','20170802210321','ISA.39';...
    'JESAJA40.html','20170802210353','ISA.40';...
    'JESAJA41.html','20170802210439','ISA.41';...
    'JESAJA42.html','20170802210535','ISA.42';...
    'JESAJA43.html','20170802210625','ISA.43';...
    'JESAJA44.html','20170802210629','ISA.44';...
    'JESAJA45.html','20170802210634','ISA.45';...
    'JESAJA46.html','20170802210708','ISA.46';...
    'JESAJA47.html','20170802210741','ISA.47';...
    'JESAJA48.html','20170802210745','ISA.48';...
    'JESAJA49.html','20170802210749','ISA.49';...
    'JESAJA50.html','20170802212000','ISA.50';...
    'JESAJA51.html','20170802211318','ISA.51';...
    'JESAJA52.html','20170802211322','ISA.52';...
    'JESAJA53.html','20170802211326','ISA.53';...
    'JESAJA54.html','20170802211331','ISA.54';...
    'JESAJA55.html','20170802211335','ISA.55';...
    'JESAJA56.html','20170802211340','ISA.56';...
    'JESAJA57.html','20170802211347','ISA.57';...
    'JESAJA58.html','20170802211431','ISA.58';...
    'JESAJA59.html','20170802211733','ISA.59';...
    'JESAJA60.html','20170802211845','ISA.60';...
    'JESAJA61.html','20170802211938','ISA.61';...
    'JESAJA62.html','20170802212138','ISA.62';...
    'JESAJA63.html','20170802212143','ISA.63';...
    'JESAJA64.html','20170802212147','ISA.64';...
    'JESAJA65.html','20170802212151','ISA.65';...
    'JESAJA66.html','20170802212154','ISA.66';...
    'JEREMIA1.html','20170802212158','JER.1';...
    'JEREMIA2.html','20170802212205','JER.2';...
    'JEREMIA3.html','20170802212209','JER.3';...
    'JEREMIA4.html','20170802212215','JER.4';...
    'JEREMIA5.html','20170802212219','JER.5';...
    'JEREMIA6.html','20170802212223','JER.6';...
    'JEREMIA7.html','20170802212227','JER.7';...
    'JEREMIA8.html','20170802212234','JER.8';...
    'JEREMIA9.html','20170802212239','JER.9';...
    'JEREMIA10.html','20170802212242','JER.10';...
    'JEREMIA11.html','20170802212246','JER.11';...
    'JEREMIA12.html','20170802212252','JER.12';...
    'JEREMIA13.html','20170802212256','JER.13';...
    'JEREMIA14.html','20170802212301','JER.14';...
    'JEREMIA15.html','20170802212305','JER.15';...
    'JEREMIA16.html','20170802212309','JER.16';...
    'JEREMIA17.html','20170802212314','JER.17';...
    'JEREMIA18.html','20170802212319','JER.18';...
    'JEREMIA19.html','20170802212324','JER.19';...
    'JEREMIA20.html','20170802212329','JER.20';...
    'JEREMIA21.html','20170802212428','JER.21';...
    'JEREMIA22.html','20170802212510','JER.22';...
    'JEREMIA23.html','20170802212514','JER.23';...
    'JEREMIA24.html','20170802212518','JER.24';...
    'JEREMIA25.html','20170802212524','JER.25';...
    'JEREMIA26.html','20170802212551','JER.26';...
    'JEREMIA27.html','20170802212635','JER.27';...
    'JEREMIA28.html','20170802212640','JER.28';...
    'JEREMIA29.html','20170802212645','JER.29';...
    'JEREMIA30.html','20170802212649','JER.30';...
    'JEREMIA31.html','20170802233642','JER.31';...
    'JEREMIA32.html','20170802213132','JER.32';...
    'JEREMIA33.html','20170802213206','JER.33';...
    'JEREMIA34.html','20170802213210','JER.34';...
    'JEREMIA35.html','20170802213214','JER.35';...
    'JEREMIA36.html','20170802213239','JER.36';...
    'JEREMIA37.html','20170802213322','JER.37';...
    'JEREMIA38.html','20170802213329','JER.38';...
    'JEREMIA39.html','20170802213333','JER.39';...
    'JEREMIA40.html','20170802213424','JER.40';...
    'JEREMIA41.html','20170802213514','JER.41';...
    'JEREMIA42.html','20170802213519','JER.42';...
    'JEREMIA43.html','20170802213524','JER.43';...
    'JEREMIA44.html','20170802213529','JER.44';...
    'JEREMIA45.html','20170802213621','JER.45';...
    'JEREMIA46.html','20170802213647','JER.46';...
    'JEREMIA47.html','20170802213655','JER.47';...
    'JEREMIA48.html','20170802213659','JER.48';...
    'JEREMIA49.html','20170802213703','JER.49';...
    'JEREMIA50.html','20170802213708','JER.50';...
    'JEREMIA51.html','20170802213754','JER.51';...
    'JEREMIA52.html','20170802213829','JER.52';...
    'KLAAGLIEDEREN1.html','20170802213833','LAM.1';...
    'KLAAGLIEDEREN2.html','20170802213837','LAM.2';...
    'KLAAGLIEDEREN3.html','20170802213841','LAM.3';...
    'KLAAGLIEDEREN4.html','20170802213855','LAM.4';...
    'KLAAGLIEDEREN5.html','20170802213902','LAM.5';...
    'EZECHIEL1.html','20170802213905','EZEK.1';...
    'EZECHIEL2.html','20170802213909','EZEK.2';...
    'EZECHIEL3.html','20170802213913','EZEK.3';...
    'EZECHIEL4.html','20170802213917','EZEK.4';...
    'EZECHIEL5.html','20170802214006','EZEK.5';...
    'EZECHIEL6.html','20170802214037','EZEK.6';...
    'EZECHIEL7.html','20170802214046','EZEK.7';...
    'EZECHIEL8.html','20170802214051','EZEK.8';...
    'EZECHIEL9.html','20170802214055','EZEK.9';...
    'EZECHIEL10.html','20170802214058','EZEK.10';...
    'EZECHIEL11.html','20170802214113','EZEK.11';...
    'EZECHIEL12.html','20170802214117','EZEK.12';...
    'EZECHIEL13.html','20170802214121','EZEK.13';...
    'EZECHIEL14.html','20170802214154','EZEK.14';...
    'EZECHIEL15.html','20170802214222','EZEK.15';...
    'EZECHIEL16.html','20170802214226','EZEK.16';...
    'EZECHIEL17.html','20170802214231','EZEK.17';...
    'EZECHIEL18.html','20170802214236','EZEK.18';...
    'EZECHIEL19.html','20170802214322','EZEK.19';...
    'EZECHIEL20.html','20170802214343','EZEK.20';...
    'EZECHIEL21.html','20170802214359','EZEK.21';...
    'EZECHIEL22.html','20170802214403','EZEK.22';...
    'EZECHIEL23.html','20170802214409','EZEK.23';...
    'EZECHIEL24.html','20170802214459','EZEK.24';...
    'EZECHIEL25.html','20170802214524','EZEK.25';...
    'EZECHIEL26.html','20170802214529','EZEK.26';...
    'EZECHIEL27.html','20170802214534','EZEK.27';...
    'EZECHIEL28.html','20170802214540','EZEK.28';...
    'EZECHIEL29.html','20170802214544','EZEK.29';...
    'EZECHIEL30.html','20170802214548','EZEK.30';...
    'EZECHIEL31.html','20170802214552','EZEK.31';...
    'EZECHIEL32.html','20170802214556','EZEK.32';...
    'EZECHIEL33.html','20170802214600','EZEK.33';...
    'EZECHIEL34.html','20170802214645','EZEK.34';...
    'EZECHIEL35.html','20170802214706','EZEK.35';...
    'EZECHIEL36.html','20170802214710','EZEK.36';...
    'EZECHIEL37.html','20170802214714','EZEK.37';...
    'EZECHIEL38.html','20170802214729','EZEK.38';...
    'EZECHIEL39.html','20170802214733','EZEK.39';...
    'EZECHIEL40.html','20170802214740','EZEK.40';...
    'EZECHIEL41.html','20170802214745','EZEK.41';...
    'EZECHIEL42.html','20170802214749','EZEK.42';...
    'EZECHIEL43.html','20170802214754','EZEK.43';...
    'EZECHIEL44.html','20170802214758','EZEK.44';...
    'EZECHIEL45.html','20170802214804','EZEK.45';...
    'EZECHIEL46.html','20170802214807','EZEK.46';...
    'EZECHIEL47.html','20170802214811','EZEK.47';...
    'EZECHIEL48.html','20170802214815','EZEK.48';...
    'DANIEL1.html','20170802214819','DAN.1';...
    'DANIEL2.html','20170802214835','DAN.2';...
    'DANIEL3.html','20170802214845','DAN.3';...
    'DANIEL4.html','20170802214849','DAN.4';...
    'DANIEL5.html','20170802214855','DAN.5';...
    'DANIEL6.html','20170802214908','DAN.6';...
    'DANIEL7.html','20170802214912','DAN.7';...
    'DANIEL8.html','20170802214920','DAN.8';...
    'DANIEL9.html','20170802214927','DAN.9';...
    'DANIEL10.html','20170802214931','DAN.10';...
    'DANIEL11.html','20170802214935','DAN.11';...
    'DANIEL12.html','20170802214941','DAN.12';...
    'HOSEA1.html','20170802214944','HOS.1';...
    'HOSEA2.html','20170802214948','HOS.2';...
    'HOSEA3.html','20170802214956','HOS.3';...
    'HOSEA4.html','20170802215002','HOS.4';...
    'HOSEA5.html','20170802215007','HOS.5';...
    'HOSEA6.html','20170802215012','HOS.6';...
    'HOSEA7.html','20170802215015','HOS.7';...
    'HOSEA8.html','20170802215020','HOS.8';...
    'HOSEA9.html','20170802215025','HOS.9';...
    'HOSEA10.html','20170802215143','HOS.10';...
    'HOSEA11.html','20170802215202','HOS.11';...
    'HOSEA12.html','20170802215249','HOS.12';...
    'HOSEA13.html','20170802215316','HOS.13';...
    'HOSEA14.html','20170802215321','HOS.14';...
    'JOEL1.html','20170802215324','JOEL.1';...
    'JOEL2.html','20170802215330','JOEL.2';...
    'JOEL3.html','20170802215338','JOEL.3';...
    'AMOS1.html','20170802215343','AMOS.1';...
    'AMOS2.html','20170802215347','AMOS.2';...
    'AMOS3.html','20170802215357','AMOS.3';...
    'AMOS4.html','20170802215403','AMOS.4';...
    'AMOS5.html','20170802215407','AMOS.5';...
    'AMOS6.html','20170802215419','AMOS.6';...
    'AMOS7.html','20170802215423','AMOS.7';...
    'AMOS8.html','20170802215428','AMOS.8';...
    'AMOS9.html','20170802215432','AMOS.9';...
    'OBADJA1.html','20170802215436','OBAD.1';...
    'JONA1.html','20170802215450','JONAH.1';...
    'JONA2.html','20170802215455','JONAH.2';...
    'JONA3.html','20170802215458','JONAH.3';...
    'JONA4.html','20170802220708','JONAH.4';...
    'MICHA1.html','20170802220734','MIC.1';...
    'MICHA2.html','20170802220802','MIC.2';...
    'MICHA3.html','20170802220838','MIC.3';...
    'MICHA4.html','20170802220915','MIC.4';...
    'MICHA5.html','20170802220921','MIC.5';...
    'MICHA6.html','20170802220930','MIC.6';...
    'MICHA7.html','20170802220935','MIC.7';...
    'NAHUM1.html','20170802220940','NAH.1';...
    'NAHUM2.html','20170802220945','NAH.2';...
    'NAHUM3.html','20170802220949','NAH.3';...
    'HABAKUK1.html','20170802221024','HAB.1';...
    'HABAKUK2.html','20170802221140','HAB.2';...
    'HABAKUK3.html','20170802221144','HAB.3';...
    'SEFANJA1.html','20170802221147','ZEPH.1';...
    'SEFANJA2.html','20170802221252','ZEPH.2';...
    'SEFANJA3.html','20170802221318','ZEPH.3';...
    'HAGGAI1.html','20170802221323','HAG.1';...
    'HAGGAI2.html','20170802221331','HAG.2';...
    'ZACHARIA1.html','20170802221335','ZECH.1';...
    'ZACHARIA2.html','20170802221339','ZECH.2';...
    'ZACHARIA3.html','20170802221343','ZECH.3';...
    'ZACHARIA4.html','20170802221348','ZECH.4';...
    'ZACHARIA5.html','20170802221352','ZECH.5';...
    'ZACHARIA6.html','20170802221424','ZECH.6';...
    'ZACHARIA7.html','20170802221604','ZECH.7';...
    'ZACHARIA8.html','20170802221642','ZECH.8';...
    'ZACHARIA9.html','20170802221646','ZECH.9';...
    'ZACHARIA10.html','20170802221650','ZECH.10';...
    'ZACHARIA11.html','20170802221719','ZECH.11';...
    'ZACHARIA12.html','20170802221751','ZECH.12';...
    'ZACHARIA13.html','20170802221756','ZECH.13';...
    'ZACHARIA14.html','20170802221830','ZECH.14';...
    'MALEACHI1.html','20170802221857','MAL.1';...
    'MALEACHI2.html','20170802221901','MAL.2';...
    'MALEACHI3.html','20170802221905','MAL.3';...
    'MATTEUS1.html','20170802221909','MATT.1';...
    'MATTEUS2.html','20170802221912','MATT.2';...
    'MATTEUS3.html','20170802221920','MATT.3';...
    'MATTEUS4.html','20170802221925','MATT.4';...
    'MATTEUS5.html','20170802221929','MATT.5';...
    'MATTEUS6.html','20170802222006','MATT.6';...
    'MATTEUS7.html','20170802222034','MATT.7';...
    'MATTEUS8.html','20170802222042','MATT.8';...
    'MATTEUS9.html','20170802222048','MATT.9';...
    'MATTEUS10.html','20170802222056','MATT.10';...
    'MATTEUS11.html','20170802222101','MATT.11';...
    'MATTEUS12.html','20170802222108','MATT.12';...
    'MATTEUS13.html','20170802222117','MATT.13';...
    'MATTEUS14.html','20170802222127','MATT.14';...
    'MATTEUS15.html','20170802222135','MATT.15';...
    'MATTEUS16.html','20170802222148','MATT.16';...
    'MATTEUS17.html','20170802222224','MATT.17';...
    'MATTEUS18.html','20170802222252','MATT.18';...
    'MATTEUS19.html','20170802222258','MATT.19';...
    'MATTEUS20.html','20170802222304','MATT.20';...
    'MATTEUS21.html','20170802222320','MATT.21';...
    'MATTEUS22.html','20170802222326','MATT.22';...
    'MATTEUS23.html','20170802222336','MATT.23';...
    'MATTEUS24.html','20170802222340','MATT.24';...
    'MATTEUS25.html','20170802222348','MATT.25';...
    'MATTEUS26.html','20170802222419','MATT.26';...
    'MATTEUS27.html','20170802222451','MATT.27';...
    'MATTEUS28.html','20170802222459','MATT.28';...
    'MARCUS1.html','20170802222508','MARK.1';...
    'MARCUS2.html','20170802222517','MARK.2';...
    'MARCUS3.html','20170802222552','MARK.3';...
    'MARCUS4.html','20170802222642','MARK.4';...
    'MARCUS5.html','20170802222706','MARK.5';...
    'MARCUS6.html','20170802222711','MARK.6';...
    'MARCUS7.html','20170802222723','MARK.7';...
    'MARCUS8.html','20170802222732','MARK.8';...
    'MARCUS9.html','20170802222736','MARK.9';...
    'MARCUS10.html','20170802222741','MARK.10';...
    'MARCUS11.html','20170802222745','MARK.11';...
    'MARCUS12.html','20170802222751','MARK.12';...
    'MARCUS13.html','20170802222757','MARK.13';...
    'MARCUS14.html','20170802222803','MARK.14';...
    'MARCUS15.html','20170802222812','MARK.15';...
    'MARCUS16.html','20170802222820','MARK.16';...
    'LUCAS1.html','20170802222825','LUKE.1';...
    'LUCAS2.html','20170802222835','LUKE.2';...
    'LUCAS3.html','20170802222846','LUKE.3';...
    'LUCAS4.html','20170802222856','LUKE.4';...
    'LUCAS5.html','20170802222900','LUKE.5';...
    'LUCAS6.html','20170802222938','LUKE.6';...
    'LUCAS7.html','20170802223007','LUKE.7';...
    'LUCAS8.html','20170802223016','LUKE.8';...
    'LUCAS9.html','20170802223032','LUKE.9';...
    'LUCAS10.html','20170802223046','LUKE.10';...
    'LUCAS11.html','20170802223209','LUKE.11';...
    'LUCAS12.html','20170802223220','LUKE.12';...
    'LUCAS13.html','20170802223231','LUKE.13';...
    'LUCAS14.html','20170802223235','LUKE.14';...
    'LUCAS15.html','20170802223239','LUKE.15';...
    'LUCAS16.html','20170802223245','LUKE.16';...
    'LUCAS17.html','20170802223249','LUKE.17';...
    'LUCAS18.html','20170802223254','LUKE.18';...
    'LUCAS19.html','20170802223259','LUKE.19';...
    'LUCAS20.html','20170802223303','LUKE.20';...
    'LUCAS21.html','20170802223316','LUKE.21';...
    'LUCAS22.html','20170802223322','LUKE.22';...
    'LUCAS23.html','20170802223344','LUKE.23';...
    'LUCAS24.html','20170802223351','LUKE.24';...
    'JOHANNES1.html','20170802223400','JOHN.1';...
    'JOHANNES2.html','20170802223458','JOHN.2';...
    'JOHANNES3.html','20170802223520','JOHN.3';...
    'JOHANNES4.html','20170802223539','JOHN.4';...
    'JOHANNES5.html','20170802223612','JOHN.5';...
    'JOHANNES6.html','20170802223631','JOHN.6';...
    'JOHANNES7.html','20170802223744','JOHN.7';...
    'JOHANNES8.html','20170802223842','JOHN.8';...
    'JOHANNES9.html','20170802223926','JOHN.9';...
    'JOHANNES10.html','20170802223934','JOHN.10';...
    'JOHANNES11.html','20170802223941','JOHN.11';...
    'JOHANNES12.html','20170802223951','JOHN.12';...
    'JOHANNES13.html','20170802224008','JOHN.13';...
    'JOHANNES14.html','20170802224023','JOHN.14';...
    'JOHANNES15.html','20170802224030','JOHN.15';...
    'JOHANNES16.html','20170802224112','JOHN.16';...
    'JOHANNES17.html','20170802224149','JOHN.17';...
    'JOHANNES18.html','20170802225631','JOHN.18';...
    'JOHANNES19.html','20170802224447','JOHN.19';...
    'JOHANNES20.html','20170802224740','JOHN.20';...
    'JOHANNES21.html','20170802224841','JOHN.21';...
    'HANDELINGEN1.html','20170802224957','ACTS.1';...
    'HANDELINGEN2.html','20170802225002','ACTS.2';...
    'HANDELINGEN3.html','20170802225008','ACTS.3';...
    'HANDELINGEN4.html','20170802225014','ACTS.4';...
    'HANDELINGEN5.html','20170802225018','ACTS.5';...
    'HANDELINGEN6.html','20170802225039','ACTS.6';...
    'HANDELINGEN7.html','20170802225050','ACTS.7';...
    'HANDELINGEN8.html','20170802225058','ACTS.8';...
    'HANDELINGEN9.html','20170802225112','ACTS.9';...
    'HANDELINGEN10.html','20170802225119','ACTS.10';...
    'HANDELINGEN11.html','20170802225123','ACTS.11';...
    'HANDELINGEN12.html','20170802225130','ACTS.12';...
    'HANDELINGEN13.html','20170802225134','ACTS.13';...
    'HANDELINGEN14.html','20170802225139','ACTS.14';...
    'HANDELINGEN15.html','20170802225143','ACTS.15';...
    'HANDELINGEN16.html','20170802225148','ACTS.16';...
    'HANDELINGEN17.html','20170802225153','ACTS.17';...
    'HANDELINGEN18.html','20170802225158','ACTS.18';...
    'HANDELINGEN19.html','20170802225205','ACTS.19';...
    'HANDELINGEN20.html','20170802225211','ACTS.20';...
    'HANDELINGEN21.html','20170802225215','ACTS.21';...
    'HANDELINGEN22.html','20170802225221','ACTS.22';...
    'HANDELINGEN23.html','20170802225228','ACTS.23';...
    'HANDELINGEN24.html','20170802225233','ACTS.24';...
    'HANDELINGEN25.html','20170802225238','ACTS.25';...
    'HANDELINGEN26.html','20170802225255','ACTS.26';...
    'HANDELINGEN27.html','20170802225300','ACTS.27';...
    'HANDELINGEN28.html','20170802225307','ACTS.28';...
    'ROMEINEN1.html','20170802225312','ROM.1';...
    'ROMEINEN2.html','20170802225316','ROM.2';...
    'ROMEINEN3.html','20170802225320','ROM.3';...
    'ROMEINEN4.html','20170802225325','ROM.4';...
    'ROMEINEN5.html','20170802225336','ROM.5';...
    'ROMEINEN6.html','20170802225341','ROM.6';...
    'ROMEINEN7.html','20170802225345','ROM.7';...
    'ROMEINEN8.html','20170802225349','ROM.8';...
    'ROMEINEN9.html','20170802225354','ROM.9';...
    'ROMEINEN10.html','20170802225358','ROM.10';...
    'ROMEINEN11.html','20170802225402','ROM.11';...
    'ROMEINEN12.html','20170802225414','ROM.12';...
    'ROMEINEN13.html','20170802225420','ROM.13';...
    'ROMEINEN14.html','20170802225425','ROM.14';...
    'ROMEINEN15.html','20170802225429','ROM.15';...
    'ROMEINEN16.html','20170802225434','ROM.16';...
    '1KORINTIERS1.html','20170802225438','1COR.1';...
    '1KORINTIERS2.html','20170802225447','1COR.2';...
    '1KORINTIERS3.html','20170802225454','1COR.3';...
    '1KORINTIERS4.html','20170802225500','1COR.4';...
    '1KORINTIERS5.html','20170802225505','1COR.5';...
    '1KORINTIERS6.html','20170802225510','1COR.6';...
    '1KORINTIERS7.html','20170802225558','1COR.7';...
    '1KORINTIERS8.html','20170802225709','1COR.8';...
    '1KORINTIERS9.html','20170802225713','1COR.9';...
    '1KORINTIERS10.html','20170802225743','1COR.10';...
    '1KORINTIERS11.html','20170802225855','1COR.11';...
    '1KORINTIERS12.html','20170802225942','1COR.12';...
    '1KORINTIERS13.html','20170802230007','1COR.13';...
    '1KORINTIERS14.html','20170802230015','1COR.14';...
    '1KORINTIERS15.html','20170802230030','1COR.15';...
    '1KORINTIERS16.html','20170802230043','1COR.16';...
    '2KORINTIERS1.html','20170802230051','2COR.1';...
    '2KORINTIERS2.html','20170802230058','2COR.2';...
    '2KORINTIERS3.html','20170802230107','2COR.3';...
    '2KORINTIERS4.html','20170802230113','2COR.4';...
    '2KORINTIERS5.html','20170802230118','2COR.5';...
    '2KORINTIERS6.html','20170802230125','2COR.6';...
    '2KORINTIERS7.html','20170802230129','2COR.7';...
    '2KORINTIERS8.html','20170802230136','2COR.8';...
    '2KORINTIERS9.html','20170802230142','2COR.9';...
    '2KORINTIERS10.html','20170802230226','2COR.10';...
    '2KORINTIERS11.html','20170802230258','2COR.11';...
    '2KORINTIERS12.html','20170802230308','2COR.12';...
    '2KORINTIERS13.html','20170802230313','2COR.13';...
    'GALATEN1.html','20170802230321','GAL.1';...
    'GALATEN2.html','20170802230325','GAL.2';...
    'GALATEN3.html','20170802230329','GAL.3';...
    'GALATEN4.html','20170802230334','GAL.4';...
    'GALATEN5.html','20170802230409','GAL.5';...
    'GALATEN6.html','20170802230431','GAL.6';...
    'EFEZIERS1.html','20170802230439','EPH.1';...
    'EFEZIERS2.html','20170802230521','EPH.2';...
    'EFEZIERS3.html','20170802230541','EPH.3';...
    'EFEZIERS4.html','20170802230558','EPH.4';...
    'EFEZIERS5.html','20170802230644','EPH.5';...
    'EFEZIERS6.html','20170802230739','EPH.6';...
    'FILIPPENZEN1.html','20170802230746','PHIL.1';...
    'FILIPPENZEN2.html','20170802230753','PHIL.2';...
    'FILIPPENZEN3.html','20170802230800','PHIL.3';...
    'FILIPPENZEN4.html','20170802230807','PHIL.4';...
    'KOLOSSENZEN1.html','20170802230813','COL.1';...
    'KOLOSSENZEN2.html','20170802230823','COL.2';...
    'KOLOSSENZEN3.html','20170802230837','COL.3';...
    'KOLOSSENZEN4.html','20170802230845','COL.4';...
    '1TESSALONICENZEN1.html','20170802230850','1THESS.1';...
    '1TESSALONICENZEN2.html','20170802230855','1THESS.2';...
    '1TESSALONICENZEN3.html','20170802230950','1THESS.3';...
    '1TESSALONICENZEN4.html','20170802231038','1THESS.4';...
    '1TESSALONICENZEN5.html','20170802231053','1THESS.5';...
    '2TESSALONICENZEN1.html','20170802231100','2THESS.1';...
    '2TESSALONICENZEN2.html','20170802231116','2THESS.2';...
    '2TESSALONICENZEN3.html','20170802231124','2THESS.3';...
    '1TIMOTEUS1.html','20170802231129','1TIM.1';...
    '1TIMOTEUS2.html','20170802231137','1TIM.2';...
    '1TIMOTEUS3.html','20170802231156','1TIM.3';...
    '1TIMOTEUS4.html','20170802231203','1TIM.4';...
    '1TIMOTEUS5.html','20170802231213','1TIM.5';...
    '1TIMOTEUS6.html','20170802231249','1TIM.6';...
    '2TIMOTEUS1.html','20170802231311','2TIM.1';...
    '2TIMOTEUS2.html','20170802231319','2TIM.2';...
    '2TIMOTEUS3.html','20170802232736','2TIM.3';...
    '2TIMOTEUS4.html','20170802231457','2TIM.4';...
    'TITUS1.html','20170802231521','TITUS.1';...
    'TITUS2.html','20170802231537','TITUS.2';...
    'TITUS3.html','20170802231635','TITUS.3';...
    'FILEMON1.html','20170802231704','PHLM.1';...
    'HEBREEEN1.html','20170802231717','HEB.1';...
    'HEBREEEN2.html','20170802231722','HEB.2';...
    'HEBREEEN3.html','20170802231726','HEB.3';...
    'HEBREEEN4.html','20170802231735','HEB.4';...
    'HEBREEEN5.html','20170802231744','HEB.5';...
    'HEBREEEN6.html','20170802231841','HEB.6';...
    'HEBREEEN7.html','20170802231851','HEB.7';...
    'HEBREEEN8.html','20170802231902','HEB.8';...
    'HEBREEEN9.html','20170802231953','HEB.9';...
    'HEBREEEN10.html','20170802232018','HEB.10';...
    'HEBREEEN11.html','20170802232025','HEB.11';...
    'HEBREEEN12.html','20170802232034','HEB.12';...
    'HEBREEEN13.html','20170802232042','HEB.13';...
    'JAKOBUS1.html','20170802232055','JAS.1';...
    'JAKOBUS2.html','20170802232106','JAS.2';...
    'JAKOBUS3.html','20170802232111','JAS.3';...
    'JAKOBUS4.html','20170802232159','JAS.4';...
    'JAKOBUS5.html','20170802232237','JAS.5';...
    '1PETRUS1.html','20170802232247','1PET.1';...
    '1PETRUS2.html','20170802232259','1PET.2';...
    '1PETRUS3.html','20170802232304','1PET.3';...
    '1PETRUS4.html','20170802232313','1PET.4';...
    '1PETRUS5.html','20170802232410','1PET.5';...
    '2PETRUS1.html','20170802232416','2PET.1';...
    '2PETRUS2.html','20170802232425','2PET.2';...
    '2PETRUS3.html','20170802232434','2PET.3';...
    '1JOHANNES1.html','20170802232450','1JOHN.1';...
    '1JOHANNES2.html','20170802232500','1JOHN.2';...
    '1JOHANNES3.html','20170802232507','1JOHN.3';...
    '1JOHANNES4.html','20170802232515','1JOHN.4';...
    '1JOHANNES5.html','20170802232545','1JOHN.5';...
    '2JOHANNES1.html','20170802232603','2JOHN.1';...
    '3JOHANNES1.html','20170802232614','3JOHN.1';...
    'JUDAS1.html','20170802232622','JUDE.1';...
    'OPENBARING1.html','20170802232631','REV.1';...
    'OPENBARING2.html','20170802232638','REV.2';...
    'OPENBARING3.html','20170802232651','REV.3';...
    'OPENBARING4.html','20170802232657','REV.4';...
    'OPENBARING5.html','20170802233557','REV.5';...
    'OPENBARING6.html','20170802232921','REV.6';...
    'OPENBARING7.html','20170802232934','REV.7';...
    'OPENBARING8.html','20170802232950','REV.8';...
    'OPENBARING9.html','20170802232954','REV.9';...
    'OPENBARING10.html','20170802233003','REV.10';...
    'OPENBARING11.html','20170802233019','REV.11';...
    'OPENBARING12.html','20170802233043','REV.12';...
    'OPENBARING13.html','20170802233052','REV.13';...
    'OPENBARING14.html','20170802233058','REV.14';...
    'OPENBARING15.html','20170802233117','REV.15';...
    'OPENBARING16.html','20170802233127','REV.16';...
    'OPENBARING17.html','20170802233137','REV.17';...
    'OPENBARING18.html','20170802233152','REV.18';...
    'OPENBARING19.html','20170802233201','REV.19';...
    'OPENBARING20.html','20170802233205','REV.20';...
    'OPENBARING21.html','20170802233254','REV.21';...
    'OPENBARING22.html','20170802233402','REV.22'};

%websave was introduced in R2014b (v8.4) and isn't built into Octave 4.2.1.
%Once this function is built into Octave, this logic can be expanded to
%consider the exact Octave release that uses websave.
PlatformVersion=version;PlatformVersion=str2double(PlatformVersion(1:3));
isOld= PlatformVersion<8.4;

htmlpath=[handles.place filesep 'HTMLs' filesep 'SV1637_77'];
if ~exist(htmlpath,'dir')
    if strcmp(htmlpath(end),filesep)
        [newpath_root,newpath_folder]=fileparts(htmlpath(1:end-1));
    else
        [newpath_root,newpath_folder]=fileparts(htmlpath);
    end
    newpath_root=strrep(newpath_root,[filesep filesep],filesep);
    mkdir(newpath_root,newpath_folder);
end
total_count=size(downloadlist,1);
skip_count=0;
%t=tic;
t=now;
for n=1:length(downloadlist)
    filename=[htmlpath filesep 'SV1637_77_' downloadlist{n,1}];
    if ~exist(filename,'file')
        if get(handles.togglebutton1,'Value')
            disp_status(handles.dict.SV1637_77_interrupted,...
                handles.stat_field2)
            %return
            continue
        end
        %t2=toc(t);
        t2=(now-t)*(24*60*60);
        frac_done=n/total_count;
        f=(n+skip_count)/total_count;t_r=round((t2-f*t2)/f);
        if isinf(t_r) || f==0
            ETA='##:##:##';
        else
            try
                ETA=datestr(addtodate(now,t_r,'second'),'HH:MM:SS');
            catch
                %ML6.5 addtodate was probably added in ML7.0
                ETA=datestr(now+(t_r/(24*60*60)),'HH:MM:SS');
            end
        end
        disp_status(sprintf(handles.dict.SV1637_77_ETA,...
            100*frac_done,ETA),handles.stat_field1)
        max_tries=5;
        outfilename=[];
        while isempty(outfilename)&&max_tries>0
            try
                if ~isOld
                    max_tries=max_tries-1;
                    outfilename=websave(...
                        filename,...
                        sprintf('http://web.archive.org/web/%s/%s%s',...
                        downloadlist{n,2},pad,downloadlist{n,3}),...
                        weboptions('Timeout',10));
                else
                    outfilename=urlwrite(...
                        sprintf('http://web.archive.org/web/%s/%s%s',...
                        downloadlist{n,2},pad,downloadlist{n,3}),...
                        filename);%#ok old version support
                    
                end
            catch
            end
        end
        if isempty(outfilename)
            missing_files=missing_files+1;
        end
    else
        skip_count=skip_count+1;
    end
end
if get(handles.togglebutton1,'Value')
    %Canceled, don't disp a new status
else
    disp_status(handles.dict.SV1637_77_download_complete,handles.stat_field1)
end
end
function missing_files=get_html_WV75(handles)
%download the html files from the Wayback Machine
missing_files=0;
prefix='WV75';FullName='Willibrord';
htmlpath=['HTMLs' filesep prefix filesep];

htmlpath=[handles.place filesep htmlpath];

disp_status(sprintf(handles.dict.startedConversion,FullName),handles.stat_field2)

disp_per_chapter=false;%will be set true if a file is missing
date_part='2017071';%date of capture to archive.org

%load the books and chapter count
list={'FILEMON' '1';'2JOHANNES' '1';'3JOHANNES' '1';...
    'JUDAS' '1';'GENESIS' '50';'EXODUS' '40';'LEVITICUS' '27';...
    'NUMERI' '36';'DEUTERONOMIUM' '34';'JOZUA' '24';'RECHTERS' '21';...
    'RUTH' '4';'1SAMUEL' '31';'2SAMUEL' '24';'1KONINGEN' '22';...
    '2KONINGEN' '25';'1KRONIEKEN' '29';'2KRONIEKEN' '36';'EZRA' '10';...
    'NEHEMIA' '13';'ESTHER' '10';'JOB' '42';'PSALMEN' '150';...
    'SPREUKEN' '31';'PREDIKER' '12';'HOOGLIED' '8';'JESAJA' '66';...
    'JEREMIA' '52';'KLAAGLIEDEREN' '5';'EZECHIEL' '48';'DANIEL' '12';...
    'HOSEA' '14';'JOEL' '4';'AMOS' '9';'OBADJA' '1';'JONA' '4';...
    'MICHA' '7';'SEFANJA' '3';'HAGGAI' '2';'ZACHARIA' '14';...
    'MALEACHI' '3';'NAHUM' '3';'HABAKUK' '3';'MATTEUS' '28';...
    'MARCUS' '16';'LUCAS' '24';'JOHANNES' '21';'HANDELINGEN' '28';...
    'ROMEINEN' '16';'1KORINTIERS' '16';'2KORINTIERS' '13';'GALATEN' '6';...
    'EFEZIERS' '6';'FILIPPENZEN' '4';'KOLOSSENZEN' '4';...
    '1TESSALONICENZEN' '5';'2TESSALONICENZEN' '3';'1TIMOTEUS' '6';...
    '2TIMOTEUS' '4';'TITUS' '3';'HEBREEEN' '13';'JAKOBUS' '5';...
    '1PETRUS' '5';'2PETRUS' '3';'1JOHANNES' '5';'OPENBARING' '22'};
boek=list(:,1);hoofdstukken=list(:,2);
chapter_total=1189;%valid for Joel 4 bibles
padded_boek=pad_cell(boek);
%t=tic;
t=now;
if ~exist(htmlpath,'dir')
    if strcmp(htmlpath(end),filesep)
        [newpath_root,newpath_folder]=fileparts(htmlpath(1:end-1));
    else
        [newpath_root,newpath_folder]=fileparts(htmlpath);
    end
    newpath_root=strrep(newpath_root,[filesep filesep],filesep);
    mkdir(newpath_root,newpath_folder);
end
counter=0;already_downloaded=-1;
url.counter=7817-1;%7817 is Filemon
for boeknr=1:66
    if ~disp_per_chapter
        %output for tic introduced in R2008b
        %t2=toc(t);
        t2=(now-t)*(24*60*60);
        f=(counter-already_downloaded)/(chapter_total-already_downloaded);
        t_r=round((t2-f*t2)/f);
        if isinf(t_r) || f==0
            ETA='##:##:##';
        else
            try
                ETA=datestr(addtodate(now,t_r,'second'),'HH:MM:SS');
            catch
                %ML6.5 addtodate was probably added in ML7.0
                ETA=datestr(now+(t_r/(24*60*60)),'HH:MM:SS');
            end
        end
        disp_status(...
            sprintf(handles.dict.ETA_book,...
            padded_boek{boeknr},100*f,ETA),handles.stat_field1)
    end
    if url.counter==7817,url.counter=7823-1;end%skip to 2 Johannes
    if url.counter==7825,url.counter=7829-1;end%skip to Genesis
    if url.counter==8264,url.counter=8271-1;end%skip apocryphal Esther
    if url.counter==8696,url.counter=8699-1;end%skip apocryphal Dani?l
    if url.counter==8759,url.counter=8897-1;end%skip apocryphal
    for hoofdstuk=1:round(str2double(hoofdstukken{boeknr}))
        if get(handles.togglebutton1,'Value')
            disp_status(sprintf(handles.dict.interruptedConversion,FullName),...
                handles.stat_field2)
            %return
            disp_per_chapter=true;
            continue
        end
        url.counter=url.counter+1;
        counter=counter+1;
        filename=[htmlpath prefix '_' boek{boeknr} num2str(hoofdstuk) '.html'];
        if disp_per_chapter
            %output for tic introduced in R2008b
            %t2=toc(t);
            t2=(now-t)*(24*60*60);
            f=(counter-already_downloaded)/(chapter_total-already_downloaded);
            t_r=round((t2-f*t2)/f);
            if isinf(t_r) || f==0
                ETA='##:##';
            else
                try
                    ETA=datestr(addtodate(now,t_r,'second'),'HH:MM');
                catch
                    %ML6.5 addtodate was probably added in ML7.0
                    ETA=datestr(now+(t_r/(24*60*60)),'HH:MM');
                end
            end
            disp_status(...
                sprintf(handles.dict.ETA_chapter,...
                padded_boek{boeknr},hoofdstuk,100*counter/chapter_total,ETA),...
                handles.stat_field1)
        end
        if ~exist(filename,'file')
            disp_per_chapter=true;
            url_part=sprintf('%s%d',['http://www.rkdocumenten.nl/rkdocs/',...
                'index.php?mi=600&doc=5061&id='],url.counter);
            
            outfilename=WBM(filename,url_part,...
                struct('date_part',date_part));
            if isempty(outfilename)
                %rethrow(errorStack{end})
                missing_files=missing_files+1;
            end
        else
            already_downloaded=already_downloaded+1;
        end
    end
end
if get(handles.togglebutton1,'Value')
    %Canceled, don't disp a new status
else
    disp_status(sprintf(handles.dict.finishedDownload,FullName),...
        handles.stat_field1)
end
end
function str=my_strtrim(str)
try
    str=strtrim(str);
catch
    %ML6.5
    if numel(str)==0,return,end
    L=isspace(str);
    if L(end)
        %last is whitespace, trim end
        idx=find(~L);
        if isempty(idx)
            %only whitespace
            str='';return
        end
        str((idx(end)+1):end)='';
    end
    if isempty(str),return,end
    if L(1)
        %first is whitespace, trim start
        idx=find(~L);
        str(1:(idx(1)-1))='';
    end
end
removed_double_spaces=inf;
while removed_double_spaces~=0
    length1=length(str);
    str=strrep(str,'  ',' ');
    length2=length(str);
    removed_double_spaces=length1-length2;
end
end
function padded_cell=pad_cell(input_cell,side)
if ~exist('side','var'),side='left';end
try
    padded_cell=pad(input_cell,side);
catch
    %built-in doesn't exist
    if ~strcmp(side,'left')
        error('not yet implemented')
    end
    cell_length=cellfun('length',input_cell);
    padded_cell=input_cell;
    longest_cell=max(cell_length);
    for n=1:length(input_cell)
        padded_cell{n}=[repmat(' ',1,longest_cell-cell_length(n)) padded_cell{n}];
    end
end
end
function data=read_html_file(filename,isOctave)
v=version;v=str2double(v(1:3));
if ~isOctave && v>=7.2 %support for encoding added in R2006a
    fid=fopen(filename,'rt','n','UTF-8');
    data=textscan(fid,'%s','Delimiter','\n');
    fclose(fid);
    data=data{1};
else
    data = cell(0);
    fid = fopen (filename, 'r');
    i=0;
    while i==0 || ischar(data{i})
        i=i+1;
        data{i} = fgetl (fid);
    end
    fclose (fid);
    data = data(1:end-1);  % No EOL
end
data(:,2)={' '};data=data';data=data(:)';data=cell2mat(data);
%data is now a single long string
end
function str=strip_tag_keep_contents(str,remove_tag,close_tag,open_tag,replace_with)
%opening tag is replaced with a space
%NB: only use when you are certain there are only paired tags!!
%The close tag is assumed to have a closing '>'.
%If the open tag is omitted, remove tag is assumed to be the complete tag.
if ~exist('open_tag','var'),open_tag=remove_tag;end
if ~exist('replace_with','var'),replace_with=' ';end%should be empty or scalar
idx.t=strfind(str,remove_tag);
while ~isempty(idx.t)
    %num_to_remove=length(idx.t);
    idx.t=idx.t(1);%keep only the first occurrence of the tag to be removed
    idx.c=strfind(str,close_tag);
    idx.o=strfind(str,open_tag);
    
    idx.c=idx.c(idx.c>idx.t);%only close tags after the remove tag
    idx.o=idx.o(idx.o>idx.t);%only close tags after the remove tag
    
    %Generate a list that can be converted to a statelist (the cumsum is >0
    %for more tags opened than closed, ==0 for an equal number of open and
    %close tags).
    idx.list=zeros(size(str));
    idx.list(idx.t)=1;
    idx.list(idx.o)=1;
    idx.list(idx.c)=-1;
    
    %idx.list2=repmat(' ',length(str));
    %idx.list2(idx.list==1)='+';
    %idx.list2(idx.list==-1)='-';
    
    idx.list=cumsum(idx.list);
    idx.c=find(idx.list==0);
    idx.c=idx.c(idx.c>idx.t);
    idx.c=idx.c(1);%pairing close tag
    
    idx_del=idx.c+(1:length(close_tag))-1;%remove closing tag
    %Remove opening tag
    if strcmp(remove_tag(end),'>')
        idx_del_total=[(idx.t)+(1:(length(remove_tag)-1)) idx_del];
    else
        %Find the first '>' after idx.t to find the entire tag
        idx.c2=strfind(str,'>');
        idx.c2=idx.c2(idx.c2>idx.t);
        idx_del_total=[(idx.t+1):idx.c2(1) idx_del];
    end
    str(idx_del_total)=[];
    if isempty(replace_with)
        str(idx.t)=[];
    else
        str(idx.t)=replace_with;
    end
    
    idx.t=strfind(str,remove_tag);%repeat search for next loop
end
end
function stripped_str=strip_tag_remove_all(original_str)
pat = '<[^>]*>';
stripped_str=regexprep(original_str, pat, '');
end
function str=strip_tag_with_contents(str,remove_tag,close_tag,open_tag)
%opening tag is replaced with a space
%NB: only use when you are certain there are only paired tags!!
%The close tag is assumed to have a closing '>'.
%If the close tag or the open tag are omitted, they are generated from the
%remove tag by the following scheme:
%remove_tag='<### $$';
%close_tag='</###>'
%open_tag='<###'
if ~exist('open_tag','var')
    open_tag=remove_tag;
    idx_space=strfind(open_tag,' ');
    if ~isempty(idx_space)
        open_tag(idx_space(1):end)='';
    end
end
if ~exist('close_tag','var')
    close_tag=remove_tag;
    idx_space=strfind(close_tag,' ');
    if ~isempty(idx_space)
        close_tag(idx_space(1):end)='';
    end
    close_tag=['</' close_tag(2:end)];
    if close_tag(end)~='>'
        close_tag(end+1)='>';
    end
end
idx.t=strfind(str,remove_tag);
while ~isempty(idx.t)
    %num_to_remove=length(idx.t);
    idx.t=idx.t(1);%keep only the first occurrence of the tag to be removed
    idx.c=strfind(str,close_tag);
    idx.o=strfind(str,open_tag);
    
    idx.c=idx.c(idx.c>idx.t);%only close tags after the remove tag
    idx.o=idx.o(idx.o>idx.t);%only close tags after the remove tag
    
    %Generate a list that can be converted to a statelist (the cumsum is >0
    %for more tags opened than closed, ==0 for an equal number of open and
    %close tags).
    idx.list=zeros(size(str));
    idx.list(idx.t)=1;
    idx.list(idx.o)=1;
    idx.list(idx.c)=-1;
    idx.list=cumsum(idx.list);
    idx.c=find(idx.list==0);
    idx.c=idx.c(idx.c>idx.t);
    idx.c=idx.c(1);%pairing close tag
    
    str((idx.t+1):(idx.c+length(close_tag)-1))=[];
    str(idx.t)=' ';
    
    idx.t=strfind(str,remove_tag);%repeat search for next loop
end
end
function write_string(fid,str)
encoded_str = unicode2nativeUTF8(str);
ignore_var=fwrite(fid, encoded_str, 'uint8');%#ok ~ ML6.5
end
function output=unicode2nativeUTF8(input_char)
%Convert a string to UTF8, if possible with the built in function

if isa(input_char,'double')
    w=warning('off','all');
    if isequal(double(char(input_char)),input_char)
        %Catch any errors in casting to char (Octave 4.2.1 throws a range
        %error for values outside a certain range).
        input_char=char(input_char);
    end
    warning(w);
end

if exist('unicode2native','builtin') && isa(input_char,'char')
    output=unicode2native(input_char,'UTF-8');
    return
end
%No builtin function, so build a list of all non-ASCII items. This list can
%then be used in strrep.

char_list=unique(input_char);

output=uint32(zeros(7,length(char_list)));
for n=length(char_list):-1:1
    if char_list(n)<2^8
        %This char is equal between ASCII and UTF8. Remove from the list
        %that is going to strrep.
        output(:,n)=[];
    else
        output(1,n)=char_list(n);
        encoded=unicode2nativeUTF8_internal(char_list(n));
        %This is a speed-memory trade off: this method will assume an
        %encoding length of 6 bytes, which removes the need for
        %computationally heavy checks and extensions, but it dramatically
        %increase the memory use, usually by about a factor 3.
        encoded=uint32(encoded);
        %Over-extend to 7 bytes and then remove the 7th byte, meaning the
        %length is guaranteed to be 6.
        encoded(7)=0;encoded(7)=[];
        output(2:7,n)=encoded;
    end
end

if ~isempty(output)
    %No need to waste memory with a double array, especially we plan to
    %extend it to multiple mostly empty columns.
    convertedlist=uint32(input_char');
    %There may be a null char in the list, so if we remove all zeros later
    %on, we'd remove that. Replace with inf and restore to null later.
    %Note: this get really close to the precision: uint32(inf)-2^32 should
    %equal 0, but sometimes will return -1, so stick to int data types.
    convertedlist(convertedlist==0)=uint32(inf);
    convertedlist(1,6)=0;%extend to fit all bytelengths
    for n=1:size(output,2)
        %Create a logical index array
        pos= input_char==output(1,n) ;
        %Replace the original codepoint with the encoded bytes.
        convertedlist(pos,:)=repmat(output(2:7,n)',sum(pos),1);
    end
    %Reshape the array into a vector again.
    convertedlist=reshape(convertedlist',1,numel(convertedlist));
    %Remove padding zeros.
    convertedlist(convertedlist==0)=[];
    %Restore the null chars.
    convertedlist(convertedlist==uint32(inf))=0;
    %Convert to uint8 to comply with the real encoding.
    output=uint8(convertedlist);
else
    output=uint8(input_char);
end
end
function bytes=unicode2nativeUTF8_internal(input_char)
%Convert the single character to UTF8 bytes.
%
%See https://en.wikipedia.org/wiki/UTF-8#Description
%
%The value of the input is converted to binary and padded with 0 bits at
%the front of the string to fill all 'x' positions in the scheme.
%
%scheme for  1- 7 bit chars (1 byte):
% 0xxxxxxx
%scheme for  8-11 bit chars (2 bytes):
% 110xxxxx 10xxxxxx
%scheme for 12-16 bit chars (3 bytes):
% 1110xxxx 10xxxxxx 10xxxxxx
%scheme for 17-21 bit chars (4 bytes):
% 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
%scheme for 22-26 bit chars (5 bytes):
% 111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
%scheme for 27-31 bit chars (6 bytes):
% 1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx

bytes=cell(1,2);
binarized=dec2bin(double(input_char));
if length(binarized)<8
    bytes={binarized};
elseif length(binarized)<12
    pading=repmat('0',1,(5+6)-length(binarized));
    binarized=[pading binarized];
    bytes{1}=['110' pading binarized(1:5)];
    bytes{2}=['10' binarized(6:11)];
elseif length(binarized)<17
    pading=repmat('0',1,(4+6+6)-length(binarized));
    binarized=[pading binarized];
    bytes{1}=['1110' binarized(1:4)];
    bytes{2}=['10' binarized(5:10)];
    bytes{3}=['10' binarized(11:16)];
elseif length(binarized)<21
    pading=repmat('0',1,(3+6+6+6)-length(binarized));
    binarized=[pading binarized];
    bytes{1}=['11110' binarized(1:3)];
    bytes{2}=['10' binarized(4:9)];
    bytes{3}=['10' binarized(10:15)];
    bytes{4}=['10' binarized(16:21)];
elseif length(binarized)<26
    pading=repmat('0',1,(2+6+6+6+6)-length(binarized));
    binarized=[pading binarized];
    bytes{1}=['111110' binarized(1:2)];
    bytes{2}=['10' binarized(3:8)];
    bytes{3}=['10' binarized(9:14)];
    bytes{4}=['10' binarized(15:20)];
    bytes{5}=['10' binarized(21:26)];
elseif length(binarized)<31
    pading=repmat('0',1,(2+6+6+6+6+6)-length(binarized));
    binarized=[pading binarized];
    bytes{1}=['111110' binarized(1)];
    bytes{2}=['10' binarized(2:7)];
    bytes{3}=['10' binarized(8:13)];
    bytes{4}=['10' binarized(14:19)];
    bytes{5}=['10' binarized(20:25)];
    bytes{6}=['10' binarized(26:31)];
end

for n=1:length(bytes)
    bytes{n}=bin2dec(bytes{n});
end
bytes=cell2mat(bytes);
end
function ME=parse_file_WV75(data,fid_db,boek,boeknr,hoofdstuk)
ME=[];
idx=strfind(data,'<div class="bladeren hide-on-print">');
data=data(idx(1):(idx(2)-1));
n=0;list=cell(50,4);
pattern='<div class="one column kantlijn">';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    try
        idx2a=strfind(verse,'<b>');
        idx2b=strfind(verse,'</b>');
        verse_num=verse((idx2a(1)+3):(idx2b(1)-1));
        verse_num=str2double(verse_num);
        
        verse=verse((idx2b(1)+4):end);
        
        verse=strrep(verse,'Sina<',['Sina' char(239)]);
        verse=strip_tag_remove_all(verse);
        verse=strrep(verse,char([195 171]),char(235));
        verse=strrep(verse,char([195 164]),char(228));
        verse=strrep(verse,char([195 175]),char(239));
        verse=strrep(verse,'&nbsp;',' ');
        verse=strrep(verse,'&iuml;',char(239));
        verse=strrep(verse,'&auml;',char(228));
        verse=strrep(verse,'&euml;',char(235));
        verse=strrep(verse,'&quot;',char(228));
        verse=strrep(verse,'&rdquo;','"');
        verse=strrep(verse,'&rsquo;','''');
        verse=strrep(verse,'&lsquo;','''');
        verse=strrep(verse,char([226 8364 382]),char(228));
        verse=strrep(verse,char([226 8364 353]),char(233));
        verse=strrep(verse,char([226 8364 8482]),char(39));
        verse=strrep(verse,char([226 8364 732]),char(39));
        verse=strrep(verse,'&#39;','''');
        verse=strrep(verse,char(8222),char(228));
        verse=strrep(verse,char(34),char(228));
        verse=strrep(verse,'%',char(235));
        verse=strrep(verse,char([226 8364 339]),char(34));
        verse=strrep(verse,char([226 8364 63]),char(34));
        verse=strrep(verse,char([226 8364 157]),char(34));
        verse=strrep(verse,char(26),'');
        verse=strrep(verse,char(30),'');
        verse=strrep(verse,char(31),'');
        
        verse=remove_weird_pattern(verse);
        
        verse_txt=my_strtrim(verse);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    n=n+1;
    list{n,1}=boeknr;
    list{n,2}=hoofdstuk;
    list{n,3}=verse_num;
    list{n,4}=sprintf('%d:%d %s',hoofdstuk,verse_num,verse_txt);
end
%sort in case of chapters like Lev 13
[ignore_var,order]=sort(cell2mat(list(1:n,3)));%#ok ~ ML6.5
list=list(order,:);
for n=1:n
    str=sprintf('{%02d%03d%03d.0} {%s}\n',list{n,1},list{n,2},list{n,3},list{n,4});
    write_string(fid_db,str)
end
end
function vers2=remove_weird_pattern(vers1)
%There is a strange pattern for which it is most likely best to remove it
%in double and not with strrep
%pattern=char([226 28 22 94 44 112 45 112 45 112 45 248 4 248 4 28 226 79]);
if ~any(double(vers1)==226)
    vers2=vers1;
    return
end
vers2=double(vers1);
idx=find(vers2==226);
% if length(idx)~=2 || idx(2)-idx(1)~=31
%     disp(vers1)
% end
vers2(idx(1):idx(2))=[];
vers2=char(vers2);
vers2(idx(1))=' ';%replace last position of pattern with space
end
function ME=parse_file_SV1637_77(data,fid_db,ignore_var,boek,boeknr)%#ok ~ ML6.5
ME=[];
data=strip_tag_with_contents(data,'<div class="notice">');
data=strip_tag_with_contents(data,'<h3');

pattern='<sup id="';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    try
        idx2=strfind(verse,'"');%'<sup id="1John.1.2"';
        verse_num=verse((idx2(1)+1):(idx2(2)-1));
        idx2=strfind(verse_num,'.');
        hoofdstuk=str2double(verse_num((idx2(1)+1):(idx2(2)-1)));
        verse_num=str2double(verse_num((idx2(2)+1):end));
        verse_txt=strip_tag_with_contents(verse,'<sup');
        verse_txt=strip_tag_remove_all(verse_txt);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    verse_txt=my_strtrim(verse_txt);
    
    str=sprintf('{%02d%03d%03d.0} {%d:%d %s}\n',boeknr,hoofdstuk,...
        verse_num,hoofdstuk,verse_num,verse_txt);
    write_string(fid_db,str)
end
end
function ME=parse_file_SV73(data,fid_db,ignore_var,boek,boeknr,hoofdstuk)%#ok ~ ML6.5
ME=[];
pattern='<a name="starth"></a>';
idx=strfind(data,pattern);
data=data(idx(1):end);
pattern='<div class="full">';
idx=strfind(data,pattern);
data=data(1:(idx(end)-1));

%now only the text itself remains

data=strip_tag_with_contents(data,'<sup>');
data=strip_tag_with_contents(data,'<small class="tekst">');
data=strip_tag_with_contents(data,'<td class=''tekstparagr');
data=strip_tag_with_contents(data,'<td class=''tekstbreedklein');
data=strip_tag_with_contents(data,'<h2');
data=strip_tag_with_contents(data,'<h3');
data=strip_tag_with_contents(data,'<h4');

data=strrep(data,'&nbsp;',' ');
data=strrep(data,'&rsquo;','''');


pattern='<a name=''vers';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    try
        %'<a name=''vers1''></a>1 '
        idx2a=strfind(verse,'>');
        idx2b=strfind(verse,' ');
        verse_num=verse((idx2a(2)+1):(idx2b(2)-1));
        verse_num=str2double(verse_num);
        verse_txt=verse((idx2b(2)+1):end);
        verse_txt=strip_tag_remove_all(verse_txt);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    verse_txt=my_strtrim(verse_txt);
    
    str=sprintf('{%02d%03d%03d.0} {%d:%d %s}\n',boeknr,hoofdstuk,...
        verse_num,hoofdstuk,verse_num,verse_txt);
    write_string(fid_db,str)
end
end
function ME=parse_file_NWv(data,fid_db,ignore_var,boek,boeknr,hoofdstuk,prefix)%#ok ~ ML6.5
ME=[];
pattern='<span class="verse"';
idx=strfind(data,pattern);
data=data(idx(1):end);
pattern='<div class="groupFootnote">';
idx=strfind(data,pattern);
data=data(1:(idx(end)-1));

%now only the text itself remains

%replace no break space with normal space
data=strrep(data,char(160),char(32));

%some notes are included inside this tag
data=strip_tag_with_contents(data,'<sup class="superscription">');
data=strip_tag_keep_contents(data,...
    '<span class="alt">','</span>','<span','');

pattern='<span class="verse"';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    %find the verse number
    idx2=strfind(verse,'</a>');idx2=idx2(1);
    idx3=strfind(verse,'>');idx3=idx3(idx3<idx2);
    idx3=idx3(end);
    verse_num=str2double(verse((idx3+1):(idx2-1)));
    %John 7:53 is included in this file for the NWv2004, hence this strange
    %code. In NWv2017 7:53-8:11 is left out.
    if strcmp(prefix,'NWv2004')
        if boeknr==43&&hoofdstuk==8&&verse_n==1
            continue
        end
        if boeknr==43&&hoofdstuk==8&&verse_n==2
            verse_num=1;
        end
    end
    if verse_n==1,verse_num=1;end%the first verse has the chapter as text
    verse=verse(idx2:end);
    %find the text itself
    try
        verse=strip_tag_with_contents(verse,'<a class','</a>','<a ');
        verse=strrep(verse,'+</a>','</a>');
        verse=strrep(verse,'*</a>','</a>');
        verse=strrep(verse,'<',' <');
        verse_txt=strip_tag_remove_all(verse);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    
    verse_txt=strrep(verse_txt,char(817),'');%the underscoring diacritic
    verse_txt=strrep(verse_txt,'&nbsp;',' ');
    verse_txt=my_strtrim(verse_txt);
    
    if strcmp(prefix,'NWv2017')
        %see previous comment about John 7:53-8:11
        if boeknr==43&&hoofdstuk==8&&verse_n==1
            verse_num=12;
            verse_txt=verse_txt(4:end);%remove '12 '
        end
    end
    
    str=sprintf('{%02d%03d%03d.0} {%d:%d %s}\n',boeknr,hoofdstuk,...
        verse_num,hoofdstuk,verse_num,verse_txt);
    write_string(fid_db,str)
end
end
function ME=parse_file_NB2014(data,fid_db,ignore_var,boek,boeknr,hoofdstuk)%#ok ~ ML6.5
ME=[];
pattern='<table class="searchresultstable">';
idx=strfind(data,pattern);
data=data(idx(1):end);
pattern='</table><script';
idx=strfind(data,pattern);
if isempty(idx)
    pattern='</table> <script';
    idx=strfind(data,pattern);
end
if isempty(idx)
    pattern='</table>';
    idx=strfind(data,pattern);
end
data=data(1:(idx(end)-1));
%now only the text itself remains

%replace no break space with normal space
data=strrep(data,char(160),char(32));
data=strrep(data,'&nbsp;',char(32));

data=strip_tag_with_contents(data,'<span class="f note"');
data=strip_tag_with_contents(data,'<span class="m"');
data=strip_tag_with_contents(data,'<span class="cl"');
data=strip_tag_with_contents(data,'<span style="font-size:14px">');
data=strip_tag_with_contents(data,'<span class="boeknaam">');
data=strip_tag_with_contents(data,'<a ');
data=strip_tag_with_contents(data,'<sup class="note"');
data=strip_tag_keep_contents(data,'<span class="qac"','</span>','<span','');
data=strip_tag_keep_contents(data,'<span style="qac"','</span>','<span','');


data=strrep(data,'&#8216;','''');
data=strrep(data,'&#8217;','''');
data=strrep(data,'&#8211;',char(45));
data=strrep(data,'&#8230;','...');
data=strrep(data,'&amp;','&');
data=strrep(data,'&#10017;',' ');%remove star of david

pattern='<tr class="vers lead"><td class=''nummer''><strong class="nummer">';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    %find the verse number
    idx3=length(pattern);
    idx2=strfind(verse,'<');idx2=idx2(idx2>idx3);idx2=idx2(1);
    verse_num=str2double(verse((idx3+1):(idx2-1)));
    verse=verse(idx2:end);
    %find the text itself
    try
        verse=strrep(verse,'<',' <');
        verse_txt=strip_tag_remove_all(verse);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    
    verse_txt=my_strtrim(verse_txt);
    %The corrections below may be needed because of the tags
    %that were replaced by spaces earlier.
    verse_txt=strrep(verse_txt,' ,',',');
    verse_txt=strrep(verse_txt,' .','.');
    verse_txt=strrep(verse_txt,' ;',';');
    
    str=sprintf('{%02d%03d%03d.0} {%d:%d %s}\n',boeknr,hoofdstuk,...
        verse_num,hoofdstuk,verse_num,verse_txt);
    write_string(fid_db,str)
end
end
function ME=parse_file_HSV(data,fid_db,ignore_var,boek,boeknr,hoofdstuk)%#ok ~ ML6.5
ME=[];

data=strip_tag_with_contents(data,'<span class="section">');
data=strip_tag_with_contents(data,'<a class="crossref');
data=strip_tag_with_contents(data,'<span class="crossref');
data=strip_tag_with_contents(data,'<span class="footnote');
data=strip_tag_with_contents(data,'<span class="note');
data=strip_tag_with_contents(data,'<footer');
data=strip_tag_with_contents(data,'<script');

%data=strrep(data,'&#8216;','''');
%data=strrep(data,'&#8217;','''');
%data=strrep(data,'&#8211;','-');
%data=strrep(data,'&#8221;','"');
%data=strrep(data,'&#8222;','"');
data=strrep(data,'&#xD;',' ');
data=strrep(data,char(160),char(32));

% list=[224 225 228 232 235 237 239 242 243 246 249 250 252];
% for n=list
%     data=strrep(data,['&#' num2str(n) ';'],char(n));
% end

pattern='<a class="vers" href="javascript:getParallel(';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    try
        %'<a class="vers" href="javascript:getParallel('GEN', 1, 3)';
        idx2a=strfind(verse,' ');
        idx2b=strfind(verse,')');
        verse_num=verse((idx2a(3)+1):(idx2b(1)-1));
        idx2=strfind(verse_num,', ');
        hoofdstuk=str2double(verse_num(1:(idx2(1)-1)));
        verse_num=str2double(verse_num((idx2(1)+2):end));
        
        pattern2='<td class="content">';
        idx2=strfind(verse,pattern2);
        verse_txt=verse(idx2(1):end);
        
        verse_txt=strip_tag_remove_all(verse_txt);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    verse_txt=my_strtrim(verse_txt);
    
    str=sprintf('{%02d%03d%03d.0} {%d:%d %s}\n',boeknr,hoofdstuk,...
        verse_num,hoofdstuk,verse_num,verse_txt);
    write_string(fid_db,str)
end
end
function ME=parse_file_debijbelnl(data,fid_db,ignore_var,boek,boeknr,hoofdstuk)%#ok ~ ML6.5
ME=[];

txt=char(data.result.response.search.result.passages{1}.text);

txt=strip_tag_with_contents(txt,'<h1');
txt=strip_tag_with_contents(txt,'<h2');
txt=strip_tag_with_contents(txt,'<h3');
txt=strip_tag_with_contents(txt,'<h4');

%replace the unicode indices
idx=strfind(txt,'\u');
while ~isempty(idx)
    unicodepoint=txt(idx(1)+(2:5));
    codepoint=hex2dec(unicodepoint);
    if codepoint>(2^7+127)
        switch codepoint
            case 8216
                codepoint=double('''');
            case 8217
                codepoint=double('''');
            case 8220
                codepoint=double('"');
            case 8221
                codepoint=double('"');
            case 8211
                codepoint=double('-');
            otherwise
                codepoint=unicode2nativeUTF8(codepoint);
        end
    end
    txt=strrep(txt,['\u' unicodepoint],...
        char(codepoint));
    idx=strfind(txt,'\u');
end

txt=strip_tag_keep_contents(txt,'<span class="em"','</span>','<span',[]);
txt=strip_tag_keep_contents(txt,'<span class="nd"','</span>','<span',[]);
txt=strip_tag_keep_contents(txt,'<span class="highlight tooltipkeyword"','</span>','<span',[]);
txt=strrep(txt,'<',' <');

pattern='<sup id="';
idx=[strfind(txt,pattern) length(txt)+1];
for verse_n=1:(length(idx)-1)
    verse=txt(idx(verse_n):(idx(verse_n+1)-1));
    try
        idx2=strfind(verse,'"');
        verse_num=verse((length(pattern)+1):(idx2(2)-1));
        idx2=strfind(verse_num,'.');
        hoofdstuk=str2double(verse_num((idx2(1)+1):(idx2(2)-1)));
        true_verse_num=verse_num((idx2(2)+1):end);
        if isnan(str2double(true_verse_num))
            temp=sscanf(true_verse_num,'%d-%d');
            true_verse_num=num2str(temp(1));
        else
            temp=[str2double(true_verse_num) str2double(true_verse_num)];
        end
        verse_num=str2double(true_verse_num);
        verse_txt=strip_tag_with_contents(verse,'<sup');
        verse_txt=strip_tag_with_contents(verse_txt,'<span class="tooltipfoot');
        verse_txt=strip_tag_remove_all(verse_txt);
        verse_txt=strrep(verse_txt,'&eacute;',char(233));
        verse_txt=strrep(verse_txt,'&oacute;',char(243));
        verse_txt=strrep(verse_txt,'&iacute;',char(237));
        verse_txt=strrep(verse_txt,'&uacute;',char(250));
        verse_txt=strrep(verse_txt,'&aacute;',char(225));
        verse_txt=strrep(verse_txt,'&agrave;',char(224));
        verse_txt=strrep(verse_txt,'&egrave;',char(232));
        verse_txt=strrep(verse_txt,'&iuml;',char(239));
        verse_txt=strrep(verse_txt,'&auml;',char(228));
        verse_txt=strrep(verse_txt,'&euml;',char(235));
        verse_txt=strrep(verse_txt,'&uuml;',char(252));
        verse_txt=strrep(verse_txt,'&ouml;',char(246));
        verse_txt=strrep(verse_txt,'&quot;','''');
        verse_txt=strrep(verse_txt,'&nbsp;',' ');
        verse_txt=strrep(verse_txt,'&frac12;','.5');%1/2 sign
        
        if any(verse_txt==0)
            %this only happens if there are non-encoded chars
            verse_txt(verse_txt==0)='';
        end
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        temp=[verse_n verse_n];
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    
    verse_txt=strrep(verse_txt,' .','.');
    verse_txt=strrep(verse_txt,char(5+5),' ');
    verse_txt=strrep(verse_txt,char(13),' ');
    verse_txt=my_strtrim(verse_txt);
    
    if temp(2)>temp(1)
        str=sprintf('{%02d%03d%03d.0} {%d:%d-%d %s}\n',...
            boeknr,hoofdstuk,verse_num,hoofdstuk,verse_num,temp(2),verse_txt);
        write_string(fid_db,str)
        for verse_num=(temp(1)+1):temp(2)
            str=sprintf('{%02d%03d%03d.0} {%%prev%%}\n',...
                boeknr,hoofdstuk,verse_num);
            write_string(fid_db,str)
        end
    else%normal single verse
        str=sprintf('{%02d%03d%03d.0} {%d:%d %s}\n',...
            boeknr,hoofdstuk,verse_num,hoofdstuk,verse_num,verse_txt);
        write_string(fid_db,str)
    end
end
end
function ME=parse_file_biblecom(data,fid_db,isOctave,boeknr,hoofdstuk)
ME=[];

%cut prior text
pattern='<div class="book bk';
idx=strfind(data,pattern);
data=data(idx(1):end);
%cut later text
pattern='</div><div class="version-copyright"';
idx=strfind(data,pattern);
if ~isempty(idx)
    data=data(1:(idx(end)-1));
end
pattern='<div class="copyright"';
idx=strfind(data,pattern);
if ~isempty(idx)
    data=data(1:(idx(end)-1));
end
pattern='<div class="medium-10';
idx=strfind(data,pattern);
if ~isempty(idx)
    data=data(1:(idx(end)-1));
end
pattern='<!-- / Secondary version content -->';
idx=strfind(data,pattern);
if ~isempty(idx)
    data=data(1:(idx(end)-1));
end
%now only the text itself remains

data=strip_tag_with_contents(data,'<span class="heading">');
data=strip_tag_with_contents(data,'<span class="note f"');
data=strip_tag_with_contents(data,'<span class="ft"');
data=strip_tag_with_contents(data,'<div class="label">');

data=strrep(data,'&#8216;','''');
data=strrep(data,'&#8217;','''');
data=strrep(data,'&#700;','''');
data=strrep(data,'&#8211;',' - ');
data=strrep(data,'&#8212;',' - ');
data=strrep(data,'&#8213;',' - ');
data=strrep(data,'&#8220;','"');
data=strrep(data,'&#8221;','"');
data=strrep(data,'&#8222;','"');
data=strrep(data,'&#8198;','');
data=strrep(data,'&#8230;','...');
data=strrep(data,'&#338;','OE');%for French in words like coeur
data=strrep(data,'&#339;','oe');%for French in words like coeur

%Octave will throw a warning for all values outside of the 0-255 range.
%This doesn't seem to have an effect outside of throwing a warning.
w=warning('off','all');
expression='&\#([0-9]*);';
replace_expr='${char(str2double($1))}';
if ~isOctave
    %Using functions in replace_expr doesn't work in Octave 4.2.1
    data=regexprep(data, expression, replace_expr);
else
    %tokens=regexp(data,expression,'tokens');
    tokens=my_regexp(data,expression,'tokens');
    
    list=unique(str2double([tokens{:}]));
    for n=list
        data=strrep(data,['&#' num2str(n) ';'],char(n));
    end
end
warning(w);

verses=cell(2,1);counter=0;
pattern='<span class="verse v';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    
    idx2a=strfind(verse,'>');
    idx2b=strfind(verse,'<');
    verse_numtxt=verse((idx2a(2)+1):(idx2b(3)-1));
    verse=strip_tag_with_contents(verse,'<span class="label">');
    
    %'<span class="verse v3" data-usfm="GEN.1.3+GEN.1.4">';
    %'<span class="verse v3" data-usfm="GEN.1.3">';
    idx2=strfind(verse,'"');
    verse_num=verse((idx2(3)+1):(idx2(4)-1));
    %verse_num='GEN.1.3+GEN.1.4'; OR
    %verse_num='GEN.1.3';
    idx2=strfind(verse_num,'.');
    verse_num=verse_num((idx2(2)+1):end);
    idx2=strfind(verse_num,'+');
    if ~isempty(idx2)
        verse_num=str2double(verse_num(1:(idx2(1)-1)));
    else
        verse_num=str2double(verse_num);
    end
    
    verse_txt=strip_tag_remove_all(verse);
    
    verse_txt=my_strtrim(verse_txt);
    
    if counter==0
        counter=counter+1;
        verses{1,1}=verse_num;
        verses{1,2}=verse_numtxt;
        verses{1,3}=verse_txt;
    else
        if verses{counter,1}==verse_num
            verses{counter,3}=[verses{counter,3} ' ' verse_txt];
        else
            if any(verses{counter,2}=='-')
                %add in the %prev% flags
                temp=sscanf(verses{counter,2},'%d-%d');
                for k=(temp(1)+1):temp(2)
                    counter=counter+1;
                    verses{counter,1}=k;
                    verses{counter,2}='';
                    verses{counter,3}='%prev%';
                end
            end
            counter=counter+1;
            verses{counter,1}=verse_num;
            verses{counter,2}=verse_numtxt;
            verses{counter,3}=verse_txt;
        end
    end
end

if any(verses{counter,2}=='-')
    %add in the %prev% flags
    temp=sscanf(verses{counter,2},'%d-%d');
    for k=(temp(1)+1):temp(2)
        counter=counter+1;
        verses{counter,1}=k;
        verses{counter,2}='';
        verses{counter,3}='%prev%';
    end
end

for n=1:counter
    verse_num=verses{n,1};
    verse_numtxt=verses{n,2};
    verse_txt=verses{n,3};
    temp=sprintf('%d:%s %s',hoofdstuk,verse_numtxt,verse_txt);
    if strcmp(verses{n,3},'%prev%')
        temp='%prev%';
    end
    temp=my_strtrim(temp);
    str=sprintf('{%02d%03d%03d.0} {%s}\n',boeknr,hoofdstuk,verse_num,temp);
    write_string(fid_db,str)
end
end
function ME=parse_file_BB(data,fid_db,boek,boeknr,hoofdstuk)
ME=[];
pattern='<a id="verse_';
idx=strfind(data,pattern);
data=data(idx(1):end);
pattern='</div><div class="tiny book summary group bottom"';
idx=strfind(data,pattern);
data=data(1:(idx(end)-1));
%only text remains now
%remove the inline footnote
pattern=' (lees verder)';
if strcmp(data((end-length(pattern)+1):end),pattern)
    %Don't use strrep, because if it doesn't occur at the end, it
    %should stay in the text.
    data((end-length(pattern)+1):end)='';
end
n=0;list=cell(50,4);
pattern='<a id="verse_';
idx=[strfind(data,pattern) length(data)+1];
for verse_n=1:(length(idx)-1)
    verse=data(idx(verse_n):(idx(verse_n+1)-1));
    
    try
        verse=strip_tag_with_contents(verse,'<span id="content_note_');
        verse=strip_tag_with_contents(verse,'<span class="content-variant"');
        verse=strip_tag_with_contents(verse,'<h4 ');
        verse_num=verse(length(pattern)+(1:3));%this covers verse numbers 1-999
        verse_num=verse_num(isstrprop(verse_num,'digit'));
        verse_num=str2double(verse_num);
        idx2=strfind(verse,'>');
        
        verse_txt=verse((idx2(2)+1):end);
        verse_txt=strrep(verse_txt,'<br/>',' ');
        verse_txt=strip_tag_remove_all(verse_txt);
    catch
        ME=lasterror;%#ok ML6.5
        verse_num=verse_n;
        verse_txt=sprintf('error during reading of html file at %s %d:%d',...
            boek{boeknr},hoofdstuk,verse_n);
    end
    
    verse_txt=my_strtrim(verse_txt);
    if n==0 || verse_num~=list{n,3}
        n=n+1;
        list{n,1}=boeknr;
        list{n,2}=hoofdstuk;
        list{n,3}=verse_num;
        if strcmp(verse_txt,'+')
            verse_txt='%next%';
        end
        list{n,4}=sprintf('%d:%d %s',hoofdstuk,verse_num,verse_txt);
    else
        list{n,4}=strcat(list{n,4},' ',verse_txt);
    end
end
for n=1:n
    str=sprintf('{%02d%03d%03d.0} {%s}\n',list{n,1},list{n,2},list{n,3},list{n,4});
    write_string(fid_db,str)
end
end
function ME=parse_file_GNB(data,fid_db,boeknr,hoofdstuk)
ME=[];
try
    pattern='</h1> <p>';
    loc1=strfind(data,pattern)+length(pattern);
    if isempty(loc1)
        pattern='</h1><p>';
        loc1=strfind(data,pattern)+length(pattern);
    end
    loc2=strfind(data,'<p>&copy;')-1;
    data=data(loc1:loc2);
catch
    ME=lastwarn;
end
%only text remains now

%replace escaped characters
data=strrep(data,'&#8216;','''');
data=strrep(data,'&#8217;','''');
data=strrep(data,'&#700;','''');
data=strrep(data,'&#8211;','-');
data=strrep(data,'&#8212;','-');
data=strrep(data,'&#8213;','-');
data=strrep(data,'&#8220;','"');
data=strrep(data,'&#8221;','"');
data=strrep(data,'&#8222;','"');
data=strrep(data,'&#8198;','');
data=strrep(data,'&#8230;','...');

%tokens=regexp(data,'&#(\d*);','tokens');
tokens=my_regexp(data,'&#(\d*);','tokens');
tokens=unique(tokens);
for t_idx=1:numel(tokens)
    data=strrep(data,...
        ['&#' tokens{t_idx} ';'],...
        char(str2double(tokens{t_idx})));
end

%split into verses (merged verses are still in 1 cell)
regex='<br.?/>';%'<br/>' or '<br />'
verses=my_regexp(data, regex, 'split');

for k=1:numel(verses)
    verse_txt=verses{k};
    verse_txt=strip_tag_remove_all(verse_txt);
    verse_txt=my_strtrim(verse_txt);
    
    %parse verse numbers
    idx=strfind(verse_txt,' ');
    header=verse_txt(1:(idx(1)-1));
    t=my_regexp(header,'(\d*)','tokens');
    verse_num=str2double(t{2});
    
    str=sprintf('{%02d%03d%03d.0} {%s}\n',...
        boeknr,hoofdstuk,verse_num,verse_txt);
    write_string(fid_db,str)
    
    if numel(t)==3%multiple verses
        for n=(str2double(t{2})+1):str2double(t{3})
            str=sprintf('{%02d%03d%03d.0} {%s}\n',...
                boeknr,hoofdstuk,n,'%prev%');
            write_string(fid_db,str)
        end
    end
end
end
function varargout=my_regexp(data,expression,varargin)
isOctave = exist('OCTAVE_VERSION', 'builtin') ~= 0;
v=version;v=str2double(v(1:3));
varargout=cell(size(varargin));
for param=1:(nargin-2)
    switch varargin{param}
        case 'tokens'
            if v>=7 && ~isOctave
                %the switch to generate tokens was introduced in R14
                tokens=regexp(data,expression,'tokens');
                tokens=([tokens{:}]);%remove one layer of cell
            else
                [s1,s2]=regexp(data,expression);
                s1=s1+2;s2=s2-1;
                tokens=cell(numel(s1),1);
                for n=1:numel(s1)
                    tokens{n}{1}=data(s1(n):s2(n));
                end
            end
            varargout{param}=tokens;
        case 'split'
            if v>=7.5 && ~isOctave
                %the split option was introduced in R2007b
                split= regexp(data, expression, 'split');
            else
                [s1,s2]=regexp(data, expression);
                split=cell(1,numel(s1)+1);
                start_index=[s1 numel(data)+1];
                stop_index=[0 s2];
                for n=1:numel(start_index)
                    split{n}=data((stop_index(n)+1):(start_index(n)-1));
                end
            end
            varargout{param}=split;
        otherwise
            error('extra regexp output type not implemented')
    end
end
end